# Protocol

## IZegoDigitalMobile

数字人 SDK 核心协议，定义了数字人的生命周期控制、视图绑定及原始数据交互接口。

*Declared in `IZegoDigitalMobile.h`*

### 方法
<ParamField
  name="start:delegate:"
  prototype="- (void)start:(NSString *)digitalHumanConfig delegate:(nullable id<ZegoDigitalMobileDelegate>)delegate;"
  desc="启动数字人任务。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="IZegoDigitalMobile"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| digitalHumanConfig | NSString * | 数字人配置，通常为 Base64 编码的 JSON 字符串。 |
| delegate | id\<[ZegoDigitalMobileDelegate](#izegodigitalmobilezegodigitalmobiledelegate)\> | 事件回调代理，可选。 |

**详情**

根据指定配置启动数字人服务。
</ParamField>

<ParamField
  name="start:config:delegate:"
  prototype="- (void)start:(ZegoDigitalHumanAuth *)auth config:(ZegoDigitalHumanConfig *)config delegate:(id<ZegoDigitalMobileDelegate>)delegate;"
  desc="启动数字人任务。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="IZegoDigitalMobile"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| auth | [ZegoDigitalMobileAuth](./class#zegodigitalhumanauth) | 数字人后台鉴权信息。 |
| config | [ZegoDigitalHumanConfig](./class#zegodigitalhumanconfig) | 数字人启动配置，包含数字人 ID、房间 ID、流 ID 等信息。 |
| delegate | id\<[ZegoDigitalMobileDelegate](#izegodigitalmobilezegodigitalmobiledelegate)\> | 事件回调代理，可选。 |

**详情**

根据指定配置启动数字人服务。
</ParamField>

<ParamField
  name="attach:"
  prototype="- (void)attach:(UIView *)previewView;"
  desc="绑定渲染视图。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="IZegoDigitalMobile"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| previewView | UIView * | 用于展示数字人的视图对象。 |

**详情**

将数字人的视频输出绑定到指定的 UI 视图上。
</ParamField>

<ParamField
  name="getPreviewView"
  prototype="- (ZegoDigitalView*)getPreviewView;"
  desc="获取绑定的视图。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="IZegoDigitalMobile"
  parent_type="class">
**返回值**

当前绑定的 [ZegoDigitalView](./class#zegodigitalview) 实例。

**详情**

获取数字人 SDK 当前引用的渲染视图。
</ParamField>

<ParamField
  name="onRemoteVideoFrameRawData:dataLength:param:streamID:"
  prototype="- (void)onRemoteVideoFrameRawData:(unsigned char *_Nonnull *_Nonnull)data dataLength:(unsigned int *)dataLength param:(ZDMVideoFrameParam *)param streamID:(NSString *)streamID;"
  desc="喂入视频帧原始数据。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="IZegoDigitalMobile"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| data | unsigned char ** | 视频帧数据平面指针数组。 |
| dataLength | unsigned int * | 各平面的数据长度。 |
| param | [ZDMVideoFrameParam](./class#zdmvideoframeparam) * | 视频帧描述参数。 |
| streamID | NSString * | 视频流 ID。 |

**详情**

用于对接 RTC SDK 的原始视频帧回调，将接收到的远端视频数据传递给数字人 SDK。
</ParamField>

<ParamField
  name="onPlayerSyncRecvSEI:data:"
  prototype="- (void)onPlayerSyncRecvSEI:(NSString *)streamID data:(NSData *)data;"
  desc="喂入播放器 SEI 信息。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="IZegoDigitalMobile"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| streamID | NSString * | 视频流 ID。 |
| data | NSData * | 接收到的 SEI 数据。 |

**详情**

用于同步业务层或 RTC 层接收到的 SEI 元数据到数字人 SDK。
</ParamField>

<ParamField
  name="stop"
  prototype="- (void)stop;"
  desc="停止数字人。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="IZegoDigitalMobile"
  parent_type="class">
**详情**

停止当前运行的数字人任务并释放相关资源。
</ParamField>

## ZegoDigitalMobileDelegate

数字人 SDK 全局状态回调协议。

*Declared in `IZegoDigitalMobile.h`*

### 方法
<ParamField
  name="onDigitalMobileStartSuccess"
  prototype="- (void)onDigitalMobileStartSuccess;"
  desc="启动成功通知。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="ZegoDigitalMobileDelegate"
  parent_type="class">
**详情**

当数字人 SDK 成功启动并准备好首帧渲染前触发。
</ParamField>

<ParamField
  name="onError:errorMsg:"
  prototype="- (void)onError:(int)errorCode errorMsg:(NSString *)errorMsg;"
  desc="错误通知。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="ZegoDigitalMobileDelegate"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| errorCode | int | 错误码。 |
| errorMsg | NSString * | 错误描述信息。 |

**详情**

当 SDK 运行发生异常时触发。错误码请参考 [ZegoDigitalMobileError](./enum#zegodigitalmobileerror)。
</ParamField>

<ParamField
  name="onSurfaceFirstFrameDraw"
  prototype="- (void)onSurfaceFirstFrameDraw;"
  desc="首帧上屏通知。"
  parent_file="Declared in \`IZegoDigitalMobile.h\`"
  parent_name="ZegoDigitalMobileDelegate"
  parent_type="class">
**详情**

当数字人视频首帧开始在视图上渲染时触发。可在此回调中移除 Loading 占位图。
</ParamField>

## ZegoDigitalHumanResourceDelegate

资源预加载状态回调协议。

*Declared in `ZegoDigitalHumanResource.h`*

### 方法
<ParamField
  name="onPreloadSuccess:"
  prototype="- (void)onPreloadSuccess:(NSString *)digitalHumanId;"
  desc="预加载成功。"
  parent_file="Declared in \`ZegoDigitalHumanResource.h\`"
  parent_name="ZegoDigitalHumanResourceDelegate"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| digitalHumanId | NSString * | 数字人 ID。 |
</ParamField>

<ParamField
  name="onPreloadFailed:errorCode:errorMessage:"
  prototype="- (void)onPreloadFailed:(NSString *)digitalHumanId errorCode:(NSInteger)errorCode errorMessage:(NSString *)errorMessage;"
  desc="预加载失败。"
  parent_file="Declared in \`ZegoDigitalHumanResource.h\`"
  parent_name="ZegoDigitalHumanResourceDelegate"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| digitalHumanId | NSString * | 数字人 ID。 |
| errorCode | NSInteger | 错误码。 |
| errorMessage | NSString * | 错误信息。 |
</ParamField>

<ParamField
  name="onPreloadProgress:progress:"
  prototype="- (void)onPreloadProgress:(NSString *)digitalHumanId progress:(float)progress;"
  desc="预加载进度。"
  parent_file="Declared in \`ZegoDigitalHumanResource.h\`"
  parent_name="ZegoDigitalHumanResourceDelegate"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| digitalHumanId | NSString * | 数字人 ID。 |
| progress | float | 加载进度（0-100）。 |
</ParamField>

## IsLoadedDelegate

资源状态查询回调协议。

*Declared in `ZegoDigitalHumanResource.h`*

### 方法
<ParamField
  name="onIsLoadedSucceed:isLoaded:"
  prototype="- (void)onIsLoadedSucceed:(NSString *)digitalHumanID isLoaded:(BOOL)isLoaded;"
  desc="查询成功。"
  parent_file="Declared in \`ZegoDigitalHumanResource.h\`"
  parent_name="IsLoadedDelegate"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| digitalHumanID | NSString * | 被查询的数字人 ID。 |
| isLoaded | BOOL | 是否已加载。 |
</ParamField>

<ParamField
  name="onIsLoadedError:code:msg:"
  prototype="- (void)onIsLoadedError:(NSString *)digitalHumanID code:(int)code msg:(NSString*)msg;"
  desc="查询失败。"
  parent_file="Declared in \`ZegoDigitalHumanResource.h\`"
  parent_name="IsLoadedDelegate"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| digitalHumanID | NSString * | 被查询的数字人 ID。 |
| code | int | 错误码。 |
| msg | NSString * | 错误原因描述。 |
</ParamField>
