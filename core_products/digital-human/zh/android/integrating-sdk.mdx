---
articleID: 195
date: "2024-05-06"
---
# 集成 SDK

---

## 准备环境

在开始集成数字人 SDK 前，请确保开发环境满足以下要求：

* Android Studio 2020.3.1 或以上版本。
- Android SDK 25、Android SDK Build-Tools 25.0.2、Android SDK Platform-Tools 25.x.x 或以上版本。
- Android 6.0（API 23）及以上版本的设备或模拟器，支持音视频能力且已连接互联网。

## 集成 SDK

数字人功能由 ZEGO Express SDK 提供基础音视频能力，数字人 SDK 提供渲染和交互能力。推荐按以下步骤进行集成。

### 1 导入 SDK

#### 集成 ZEGO Express SDK

由于当前数字人功能需要使用针对 AI Agent 优化的 ZEGO Express SDK，支持以下两种集成方式：

<Tabs>
<Tab title="方式 1：Maven 集成（推荐）">

在应用模块 `app/build.gradle` 中添加以下依赖：

```groovy
dependencies {
    // 针对 数字人 优化的 ZEGO Express SDK
    implementation 'im.zego:express-private:3.22.0.46726'
}
```

</Tab>
<Tab title="方式 2：手动集成">

1. 请从[下载页面](./introduction/download.mdx)获取针对 AI Agent 优化的 ZEGO Express SDK。
2. 参考 [集成Express SDK](https://doc-zh.zego.im/article/3575#2) 文档将 SDK 集成到您的项目中。
2. 将 SDK 的 `ZegoExpressEngine.jar` 文件拷贝到应用模块的 `libs` 目录下。
3. 将 `armeabi-v7a`、`arm64-v8a` 等目录下的 `.so` 文件拷贝到对应的 `jniLibs` 目录下（通常为 `app/src/main/jniLibs`）。

</Tab>
</Tabs>

#### 集成数字人 SDK

数字人 SDK 已发布在 Maven 仓库，可通过以下方式集成。

**1. 添加 Maven 仓库**

根据 Android Gradle Plugin 版本选择配置方式：

<Tabs>
<Tab title="AGP 7.1.0 及以上">

在项目根目录打开 `settings.gradle`，在 `dependencyResolutionManagement` > `repositories` 中添加：

```groovy
dependencyResolutionManagement {
  repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
  repositories {
      google()
      mavenCentral()
      maven { url 'https://maven.zego.im' }   // ZEGO SDK 仓库
  }
}
```

</Tab>
<Tab title="AGP 低于 7.1.0">

在项目根目录打开 `build.gradle`，在 `allprojects` > `repositories` 中添加：

```groovy
allprojects {
    repositories {
        google()
        mavenCentral()
        maven { url 'https://maven.zego.im' }   // ZEGO SDK 仓库
    }
}
```

</Tab>
</Tabs>

**2. 添加依赖**

在应用模块 `app/build.gradle` 中加入数字人 SDK 依赖：

```groovy
dependencies {
    // 数字人 SDK
    implementation "im.zego:digitalmobile:1.5.0.119"
}
```

### 2 初始化 SDK

集成 SDK 后，按以下步骤配置权限并初始化 ZEGO Express SDK。

<Steps>
<Step title="添加权限声明">
进入 "app/src/main" 目录，打开 "AndroidManifest.xml" 文件，添加权限。

```xml AndroidManifest.xml
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
```
</Step>
<Step title="运行时申请录音权限">

```java
private final ActivityResultLauncher<String> requestPermissionLauncher = registerForActivityResult(
    new ActivityResultContracts.RequestPermission(), new ActivityResultCallback<Boolean>() {
        @Override
        public void onActivityResult(Boolean isGranted) {
            if (isGranted) {
                // 同意权限
            }
        }
    });
//发起请求
requestPermissionLauncher.launch(Manifest.permission.RECORD_AUDIO);
```
</Step>
<Step title="创建并初始化 ZegoExpressEngine">

```java {3}
ZegoEngineProfile zegoEngineProfile = new ZegoEngineProfile();
zegoEngineProfile.appID = ; // 从即构控制台获取的 appId
zegoEngineProfile.scenario = ZegoScenario.HIGH_QUALITY_CHATROOM;
zegoEngineProfile.application = getApplication();
ZegoExpressEngine.createEngine(zegoEngineProfile, null);
```
</Step>
</Steps>

## 防止混淆代码

在 `proguard-rules.pro` 中添加保持规则，避免混淆 ZEGO 相关类名：

```txt
-keep class **.zego.**{*;}
```
