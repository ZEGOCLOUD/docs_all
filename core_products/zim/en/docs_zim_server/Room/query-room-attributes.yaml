openapi: 3.0.0
info:
  title: open-api-desc
  version: 1.0.0
  contact:
    name: ZEGO Support
    email: support@zegocloud.com

servers:
  $ref: '../shared-components.yaml#/servers'

tags:
  - room

paths:
  /:
    post:
      tags: [room]
      summary: Query room attributes
      description: |
        Query all room attributes for the specified room ID.

        <Note title="QPS Limit"> 20 times/s</Note>
      operationId: query-room-attributes
      parameters:
        - name: Action
          in: query
          description: |
            > API prototype parameter
            >
            > https://zim-api.zego.im/?Action=QueryRoomAttribute
          required: true
          schema:
            type: string
            enum: [QueryRoomAttribute]
          style: form
          explode: true
        - $ref: '../shared-components.yaml#/components/parameters/AppId'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureNonce'
        - $ref: '../shared-components.yaml#/components/parameters/Timestamp'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureVersion'
        - $ref: '../shared-components.yaml#/components/parameters/Signature'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryRoomAttributeRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryRoomAttributeResponse'
              example:
                Code: 0
                Message: success
                RequestId: "req-123456789"
                AttributeSeq: 10
                Attributes:
                  - Key: "1"
                    Value: "attr1"
                    Seq: 9
                    AutoDelete: 0
                  - Key: "2"
                    Value: "attr1"
                    Seq: 10
                    AutoDelete: 0

components:
  schemas:
    QueryRoomAttributeRequest:
      type: object
      required: [FromUserId, RoomId]
      properties:
        FromUserId:
          type: string
          description: Operator, must be in registered status. This user will not automatically join the room. Only supports numbers, English characters, and '!', '#', '$', '%', '&', '(', ')', '+', '-', ':', ';', '<', '=', '.', '>', '?', '@', '[', ']', '^', '_', ' ', ',', '{'
          maxLength: 32
          example: "fromUserId"   
        RoomId:
          type: string
          description: Room ID. Only supports numbers, English characters, and '!', '#', '$', '%', '&', '(', ')', '+', '-', ':', ';', '<', '=', '.', '>', '?', '@', '[', ']', '^', '_', ' ', ',', '{'
          maxLength: 32
          example: "room123"
    QueryRoomAttributeResponse:
      type: object
      properties:
        Code:
          type: number
          description: |
            Return status code (0 indicates success).

            The following only lists the return codes related to the API business logic. For the complete return codes, please refer to [Return codes](/zim-server/return-codes).
            <table>
            <thead><tr><th>Return code</th><th>Description</th><th>Solution</th></tr></thead>
            <tbody>
            <tr><td>660000002</td><td>Parameter error.</td><td>Please check the parameters.</td></tr>
            <tr><td>660300005</td><td>Frequency limit.</td><td>Please try again later.</td></tr>
            </tbody>
            </table>
          example: 0
        Message:
          type: string
          description: Return status information.
          example: "success"
        RequestId:
          type: string
          description: Unique request identifier.
          example: "req-123456789"
        AttributeSeq:
          type: number
          description: |
            Records the total number of changes to all attributes (create, modify, delete) in the room, used to calibrate attributes and calculate the order of attribute changes. The AttributeSeq value increases by 1 each time an attribute changes.
            > Note: When multiple attributes change at once, the AttributeSeq value will increase multiple times. For example, if 3 attributes are modified at once, the AttributeSeq value will increase by 3.
          example: 10
        Attributes:
          type: array
          description: List of room attributes.
          items:
            $ref: '#/components/schemas/RoomAttribute'
    RoomAttribute:
      type: object
      properties:
        Key:
          type: string
          description: Room attribute key value.
          example: "1"
        Value:
          type: string
          description: Room attribute value.
          example: "attr1"
        Seq:
          type: int32
          description: Sequence number of the room attribute Key, used to calibrate attributes and calculate the order of attribute changes. When each attribute is successfully created or modified, the Seq value equals the current AttributeSeq.
          example: 1
        AutoDelete:
          type: number
          description: Whether to automatically delete.
          example: 0