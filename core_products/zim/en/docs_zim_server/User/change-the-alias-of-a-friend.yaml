openapi: 3.0.0
info:
  title: open-api-desc
  version: 1.0.0
  contact:
    name: ZEGO Support
    email: support@zegocloud.com
servers:
  $ref: '../shared-components.yaml#/servers'
tags:
  - user
paths:
  /:
    post:
      tags: [user]
      summary: Change the alias of a friend
      description: |
        Through this API, you can batch modify the remarks of up to 20 friends for one user. If you need to increase the limit (up to 50), please contact ZEGOCLOUD Technical Support.

        After successfully modifying friend remarks, users receive relevant modification notifications through the following ZIM SDK callback interface:

        | iOS-25% | Android-25% | macOS-25% | Windows-25% |
        |-----|---------|--------|---------|
        | [friendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~objective-c_ios~protocol~ZIMEventHandler#zim-friend-info-updated-friend-info-list) | [onFriendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~java_android~class~ZIMEventHandler#on-friend-info-updated) | [friendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~objective-c_macos~protocol~ZIMEventHandler#zim-friend-info-updated-friend-info-list) | [onFriendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~cpp_windows~class~ZIMEventHandler#on-friend-info-updated) |

        | Web-25% | Mini Program-25% | Flutter-25% | React Native-25% |
        |-----|---------|---------|---------|
        | [friendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_web~interface~ZIMEventHandler#friend-info-updated) | [friendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_wxxcx~interface~ZIMEventHandler#friend-info-updated) | [onFriendInfoUpdated](https://pub.dev/documentation/zego_zim/latest/zego_zim/ZIMEventHandler/onFriendInfoUpdated.html) | [friendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_uni-app~interface~ZIMEventHandler#friend-info-updated) |

        | uni-app \| uni-app x-25% | HarmonyOS-25% |
        |---------|---------|
        | [friendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_uni-app~interface~ZIMEventHandler#friend-info-updated) |[friendInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_harmony~interface~ZIMEventHandler#friend-info-updated)  |
        
        <Note title="Note">
        The users corresponding to the parameters `FromUserId` and `UserId` have logged in to the ZIM service by calling the `login` method on the client, or have completed registration by calling the [server-side API](/zim-server/user/batch-register-users).
        </Note>
        <Note title="Note">QPS Limit: 20 times/s</Note>
      operationId: change-the-alias-of-a-friend
      parameters:
        - name: Action
          in: query
          description: |
            > API prototype parameter
            >
            > https://zim-api.zego.im/?Action=UpdateFriendsAlias
          required: true
          schema:
            type: string
            enum: [UpdateFriendsAlias]
          style: form
          explode: true
        - $ref: '../shared-components.yaml#/components/parameters/AppId'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureNonce'
        - $ref: '../shared-components.yaml#/components/parameters/Timestamp'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureVersion'
        - $ref: '../shared-components.yaml#/components/parameters/Signature'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateFriendsAliasRequest'
            example:
              FromUserId: "zego_user"
              UserIds:
                - UserId: "user1"
                  FriendAlias: "FriendAlias1"
                - UserId: "user2"
                  FriendAlias: "FriendAlias2"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateFriendsAliasResponse'
              example:
                Code: 0
                Message: success
                RequestId: "343649807833778782"
                ErrorList:
                  - UserId: "aaa"
                    SubCode: 660000012
                  - UserId: "bbb"
                    SubCode: 660000013
components:
  schemas:
    UpdateFriendsAliasRequest:
      type: object
      required: [FromUserId, UserIds]
      properties:
        FromUserId:
          type: string
          description: 更新此用户对指定好友的备注。
          maxLength: 32
          example: "zego_user"
        UserIds:
          type: array
          description: 备注待更新的用户列表。单次最多修改 20 个用户。
          maxItems: 20
          items:
            type: object
            required: [UserId]
            properties:
              UserId:
                type: string
                description: User ID.长度上限为 32 bytes。
                maxLength: 32
                example: "user1"
              FriendAlias:
                type: string
                description: 新的好友备注，with a maximum length of 256 字符。
                maxLength: 256
                example: "FriendAlias1"
    UpdateFriendsAliasResponse:
      type: object
      properties:
        Code:
          type: integer
          description: |
            Return code.
            
            以下仅列出了接口业务逻辑相关的 Code 和 SubCode ，完整返回码请参考 [全局返回码](/zim-server/return-codes)。
            > **Note**
            >
            > 当您发起请求同时更新多个好友备注：
            > <ul><li>如果成功更新 1 个或更多好友备注，Code 都会返回 0。此时请参考 ErrorList 中的具体信息，确认操作结果。</li>
            > <li>如果全部好友备注更新失败，Code 会返回相关返回码，具体请参考 <a href="/zim-server/return-codes" target="_blank">全局返回码</a>。</li></ul>

            <table>
            <tbody><tr>
            <th>Code / SubCode</th>
            <th>描述</th>
            <th>Suggested Solution</th>
            </tr>
            <tr>
            <td>660000001</td>
            <td>业务类通用错误。</td>
            <td>请重试，或联系 ZEGOCLOUD Technical Support。</td>
            </tr>
            <tr>
            <td>660000002</td>
            <td>Input parameter error。</td>
            <td>Please check the input parameters。</td>
            </tr>
            <tr>
            <td>660300005</td>
            <td>调用接口的频率超出了 AppID 级别限制。</td>
            <td>请稍后再试。</td>
            </tr>
            <tr>
            <td>660800019</td>
            <td>单次批量操作超过上限。</td>
            <td>减少单次批量操作数量。</td>
            </tr>
            <tr>
            <td>660800021</td>
            <td>“FriendAlias” 超过长度上限。</td>
            <td>请缩减相关字段的内容长度。</td>
            </tr>
            <tr>
            <td>660800034</td>
            <td>此用户不是“FromUserId” 的好友。</td>
            <td>请先添加此用户为好友。</td>
            </tr>
            </tbody></table>
          example: 0
        Message:
          type: string
          description: 操作结果描述。
          example: "success"
        RequestId:
          type: string
          description: Request ID.
          example: "343649807833778782"
        ErrorList:
          type: array
          description: |
            检查失败列表。
            <ul>
            <li>Code 为 0：</li>
            <li>ErrorList 为空，全部好友备注修改成功。</li>
            <li>ErrorList 不为空，表示部分好友备注修改失败，请参考 SubCode 处理。</li>
            </ul>
            <ul>
            <li>Code 不为 0：</li>
            <li>ErrorList 为空，表示参数错误、接口频率限制、系统错误。</li>
            <li>ErrorList 不为空，表示全部好友备注都修改失败。</li>
            </ul>
          items:
            type: object
            properties:
              UserId:
                type: string
                description: 好友备注修改失败的User ID.
                example: "aaa"
              SubCode:
                type: number
                description: |
                  具体失败返回码，完整返回码请参考 Code 说明或者 [全局返回码](/zim-server/return-codes)。
                example: 660000012
