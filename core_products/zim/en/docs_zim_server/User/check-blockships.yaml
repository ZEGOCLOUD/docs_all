openapi: 3.0.0
info:
  title: open-api-desc
  version: 1.0.0
  contact:
    name: ZEGO Support
    email: support@zegocloud.com
servers:
  $ref: '../shared-components.yaml#/servers'
tags:
  - user
paths:
  /:
    post:
      tags: [user]
      summary: Check blockships
      description: |
        By calling this API, you can batch check the blocklist relationship between one user and up to 20 other users (whether these users have been blocked). If you need to increase the limit, please contact ZEGOCLOUD Technical Support.
        <Note title="Note">

        The users corresponding to the parameters `FromUserId` and `UserId` have logged in to the ZIM service by calling the `login` method on the client, or have completed registration by calling the [server-side API](/zim-server/user/batch-register-users).
        </Note>
        <Note title="Note">The parameters FromUserId and UserId only support numbers, English characters, and `'!', '#', '$', '%', '&', '(', ')', '+', '-', ':', ';', '<', '=', '.', '>', '?', '@', '[', ']', '^', '_', '{', '}', '|', '~'`</Note>
        <Note title="QPS Limit">20 times/s</Note>
      operationId: check-blockships
      parameters:
        - name: Action
          in: query
          description: |
            > API prototype parameter
            >
            > https://zim-api.zego.im/?Action=CheckUsersIsInBlacklist
          required: true
          schema:
            type: string
            enum: [CheckUsersIsInBlacklist]
          style: form
          explode: true
        - $ref: '../shared-components.yaml#/components/parameters/AppId'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureNonce'
        - $ref: '../shared-components.yaml#/components/parameters/Timestamp'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureVersion'
        - $ref: '../shared-components.yaml#/components/parameters/Signature'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckUsersIsInBlacklistRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckUsersIsInBlacklistResponse'
              example:
                Code: 0
                Message: success
                RequestId: "343649807833778782"
                Succ:
                  - UserId: "user1"
                    Result: 1
                  - UserId: "user2"
                    Result: 1
                ErrList:
                  - UserId: "user3"
                    SubCode: 660000002
                  - UserId: "user4"
                    SubCode: 660000002
components:
  schemas:
    CheckUsersIsInBlacklistRequest:
      type: object
      required: [FromUserId, UserIds]
      properties:
        FromUserId:
          type: string
          description: Query blocklist relationships for this user.
          maxLength: 32
          example: "zego_user"
        UserIds:
          type: array
          description: List of target users to check blocklist relationships. Default maximum is 20.
          maxItems: 20
          items:
            type: string
            maxLength: 32
            example: "user1"
          example: ["user1", "user2", "user3", "user4"]
    CheckUsersIsInBlacklistResponse:
      type: object
      properties:
        Code:
          type: integer
          description: |
            Return code.

            The following only lists the Code and SubCode related to the API business logic. For complete return codes, please refer to [Global Return Codes](/zim-server/return-codes).
            > **Note**
            >
            > When you initiate a request to check the blocklist relationship between FromUserId and multiple users at the same time:
            > <ul><li>If the blocklist relationship between FromUserId and 1 or more users is successfully checked, Code will return 0. In this case, please refer to the specific information in ErrList to confirm the operation result.</li>
            > <li>If the blocklist relationship between FromUserId and all target users fails to be checked, Code will return the relevant return code. For details, please refer to <a href="/zim-server/return-codes" target="_blank">Global Return Codes</a>.</li></ul>
            <table>
            <tbody><tr>
            <th>Code / SubCode</th>
            <th>Description</th>
            <th>Suggested Solution</th>
            </tr>
            <tr>
            <td>660000002</td>
            <td>Input parameter error。</td>
            <td>Please check the input parameters。</td>
            </tr>
            <tr>
            <td>660300005</td>
            <td>The API call frequency exceeds the AppID-level limit.</td>
            <td>Please try again later.</td>
            </tr>
            <tr>
            <td>660500002</td>
            <td>FromUserId is not registered.</td>
            <td>Please confirm whether the user is registered:<br/>If confirmed registered, please contact ZEGOCLOUD Technical Support for troubleshooting.<br/>If confirmed not registered, please register this user.</td>
            </tr>
            <tr>
            <td>660700015</td>
            <td>The target user of the API is not registered.</td>
            <td>Please confirm whether the user is registered:<br/>If confirmed registered, please contact ZEGOCLOUD Technical Support for troubleshooting.<br/>If confirmed not registered, please register this user.</td>
            </tr>
            <tr>
            <td>660800001</td>
            <td>FromUserId is not registered.</td>
            <td>Please confirm whether the user is registered:<br/>If confirmed registered, please contact ZEGOCLOUD Technical Support for troubleshooting.<br/>If confirmed not registered, please register this user.</td>
            </tr>
            <tr>
            <td>660800039</td>
            <td>The incoming user list exceeds the limit.</td>
            <td>Please shorten the incoming user list.</td>
            </tr>
            </tbody></table>
          example: 0
        Message:
          type: string
          description: Description of the request result.
          example: "success"
        RequestId:
          type: string
          description: Request ID.
          example: "343649807833778782"
        Succ:
          type: array
          description: Check success list.
          items:
            type: object
            properties:
              UserId:
                type: string
                description: Successfully checked the blocklist relationship between FromUserId and this user ID.
                example: "user1"
              Result:
                type: number
                description: |
                  Check result:
                  - 0: Not blocked by FromUserId.
                  - 1: Blocked by FromUserId.
                enum: [0, 1]
                example: 1
        ErrList:
          type: array
          description: |
            Check failure list.
            <ul>
            <li>Code is 0:</li>
            <li>ErrList is empty, indicating that the blocklist relationship between FromUserId and all target users is successfully checked.</li>
            <li>ErrList is not empty, indicating that the blocklist relationship check between FromUserId and some target users failed. Please refer to SubCode for processing.</li>
            <li>Code is not 0:</li>
            <li>ErrList is empty, indicating parameter error, API frequency limit, or system error.</li>
            <li>ErrList is not empty, indicating that the blocklist relationship check between FromUserId and all target users failed.</li>
            </ul>
          items:
            type: object
            properties:
              UserId:
                type: string
                description: Failed to check the blocklist relationship between FromUserId and this user ID.
                example: "user3"
              SubCode:
                type: number
                description: |
                  Specific failure return code. For complete return codes, please refer to the Code description or [Global Return Codes](/zim-server/return-codes).
                example: 660000002
