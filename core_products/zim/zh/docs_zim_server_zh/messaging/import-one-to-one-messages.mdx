---
id: import-one-to-one-messages
title: "导入单聊消息"
description: "如果您正使用其他即时通讯服务并希望接入 ZIM，可调用此接口，向 ZIM 导入用户的历史单聊消息（按时间顺序）。"
api: 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
info_path: core_products/zim/zh/docs_zim_server_zh/messaging/open-api-desc
---

<h1 className={"openapi__heading"}>导入单聊消息</h1>

<MethodEndpoint method={"post"} path={"/"}></MethodEndpoint>


如果您正使用其他即时通讯服务并希望接入 ZIM，可调用此接口，向 ZIM 导入用户的历史单聊消息（按时间顺序）。

一个单聊会话存在两个用户（用户 A、B）。用户 A 可能删除了部分消息，导致用户 A 在此会话可以看到的消息列表与用户 B 的不同，因此，对于同一个单聊会话，需要为用户 A、B 分别调用此接口。

<Note title="说明">
参数 FromUserId、ToUserId 仅支持数字、英文字符和 \{'!'，'#'，'$'，'%'，'&'，'('，')'，'+'，'-'，':'，';'，'\<'，'='，'.'，'\>'，'?'，'@'，'['，']'，'^'，'_'，' '，'\{'，'\}'，'|'，'~'\}。

为了给开发者带来更好的体验，ZEGO 推荐开发者使用最新版本的 SDK。

如果发送方请求发送 MessageType 为 1 的文本消息，则发送方对应的客户端（SDK 版本需为 2.7.0 或以上）也会收到该消息。

对于发送和接收 MessageType 为 200 的自定义消息，发送方和接收放对应的客户端的 SDK 版本需为 2.8.0 或以上。

如果接收端的 SDK 版本介乎 [2.0.0, 2.8.0) 区间，可以收到自定义消息时，但会显示此消息类型为未知，且无法获取信息内容。如需获取此条消息，请将 SDK 升级为 2.8.0 或以上版本。

如果接收端的 SDK 版本为 1.x.x 版本，则无法收到自定义消息，也不会收到未知消息。
</Note>

<Note title="说明">调用频率限制：20 次/秒。</Note>

## 验证效果
成功导入消息后，可调用 ZIM 服务端接口 [查询单聊会话消息列表](/zim-server/conversation/query-the-message-list-of-one-on-one-chats)，确认用户的单聊会话消息是否导入完整。

## Request
<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Query Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"name":"Action","in":"query","description":"> 接口原型参数\n>\n> https://zim-api.zego.im/?Action=ImportPeerMsg\n","required":true,"schema":{"type":"string","enum":["ImportPeerMsg"]},"style":"form","explode":true}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"AppId","in":"query","description":"💡公共参数。应用 Id，由 ZEGO 分配的用户唯一凭证。可从 <a target=\"_blank\" href=\"https://console.zego.im/\">ZEGO 控制台</a> 获取。","required":true,"schema":{"type":"integer","format":"uint32"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureNonce","in":"query","description":"💡公共参数。16 位 16 进制随机字符串（8 字节随机数的 hex 编码）。生成算法可参考 <a href=\"/zim-server/accessing-server-apis#signature-example\">签名示例</a>。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Timestamp","in":"query","description":"💡公共参数。当前 Unix 时间戳，单位为秒。生成算法可参考 <a href=\"/zim-server/accessing-server-apis#signature-example\">签名示例</a>，最多允许 10 分钟的误差。","required":true,"schema":{"type":"integer","format":"int64"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureVersion","in":"query","description":"💡公共参数。签名版本号。","required":true,"schema":{"type":"string","default":"2.0","enum":["2.0"]}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Signature","in":"query","description":"💡公共参数。签名，用于验证请求的合法性。请参考[签名机制](/zim-server/accessing-server-apis#signature-mechanism)生成。","required":true,"schema":{"type":"string"}}}></ParamsItem></ul></div></details>
<MimeTabs className={"openapi-tabs__mime request"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3><strong className={"openapi-schema__required"}>required</strong></summary><ul className={"request-schema-first-body-node-container"}><SchemaItem collapsible={false} name={"FromUserId"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 32 characters`"} schema={{"type":"string","description":"消息发送方的用户 ID。","maxLength":32,"example":"u1"}}></SchemaItem><SchemaItem collapsible={false} name={"ToUserId"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 32 characters`"} schema={{"type":"string","description":"消息接收方的用户 ID。","maxLength":32,"example":"u2"}}></SchemaItem><SchemaItem collapsible={false} name={"MessageType"} required={true} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"消息类型，单聊会话的适用类型请参考 [MessageBody 说明](/zim-server/messaging/messagebody-introduction)。\n> 注意\n>\n> 不支持信令消息。\n","example":200}}></SchemaItem><SchemaItem collapsible={false} name={"Priority"} required={true} schemaName={"number"} qualifierMessage={"**Possible values:** [`1`, `2`, `3`]"} schema={{"type":"number","description":"消息优先级（详情请参考 [基本概念介绍 - 消息优先级](https://doc-zh.zego.im/zim-android/introduction/basic-concepts#消息优先级)），取值如下：\n- 1：低。\n- 2：中。\n- 3：高。\n","enum":[1,2,3],"example":1}}></SchemaItem><SchemaItem collapsible={false} name={"MessageBody"} required={true} schemaName={"object"} qualifierMessage={undefined} schema={{"type":"object","description":"消息内容，具体参数格式请参考 [MessageBody 说明](/zim-server/messaging/messagebody-introduction)。\n> 注意\n>\n> 不支持 `OfflinePush` 和 `HasReceipt` 字段。\n","example":{"Message":"hello world","ExtendedData":"s"}}}></SchemaItem><SchemaItem collapsible={false} name={"SubMsgType"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"具体的自定义类型。值由您定义，取值范围为 [0,200]。当 MessageType 为自定义消息时，必填。","example":110}}></SchemaItem><SchemaItem collapsible={false} name={"SearchedContent"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"自定义消息的检索字段。当 MessageType 为自定义消息时，才可填写此字段，长度上限默认为 64 字节。此字段作用于客户端，除非填写了此字段，否则无法通过客户端搜索到关联的自定义消息。","example":"ex"}}></SchemaItem><SchemaItem collapsible={false} name={"SendMessageTime"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"消息发送时间戳（Unix，毫秒级别）。请按照发送时间从前到后的顺序进行导入。\n- 传 0 或不传：取\"当前时间\"。\n- 其他值：最早可取\"当前时间 - 套餐包规定的历史消息保存天数（详情请参考 [计费说明 - 版本差异](/zim-android/introduction/pricing#版本差异)） * 86400000\"，最晚不得晚于\"当前时间\"。\n\n不能早于套餐包规定的历史消息保存天数（详情请参考 [计费说明 - 版本差异](/zim-android/introduction/pricing#版本差异)），也不能晚于当前时间。\n","example":123}}></SchemaItem><SchemaItem collapsible={false} name={"ImportedUserId"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"必须是 FromUserId 或 ToUserId中的一个，代表导入的是谁的单聊会话消息列表。","example":"u1"}}></SchemaItem></ul></details></TabItem></MimeTabs>
<div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>OK</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><ul className={"response-schema-first-body-node-container"}><SchemaItem collapsible={false} name={"Code"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"返回码。\n\n以下仅列出了接口业务逻辑相关的返回码，完整返回码请参考 [全局返回码](/zim-server/return-codes)。\n<table>\n<tbody><tr>\n<th>返回码</th>\n<th>说明</th>\n<th>处理建议</th>\n</tr>\n<tr>\n<td>660400001</td>\n<td>输入的消息大小超出限制。</td>\n<td>请检查输入的消息大小。</td>\n</tr>\n</tbody>\n</table>\n","example":0}}></SchemaItem><SchemaItem collapsible={false} name={"Message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"请求结果的说明信息。","example":"success"}}></SchemaItem><SchemaItem collapsible={false} name={"RequestId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"请求 ID。","example":"343649807833778782"}}></SchemaItem><SchemaItem collapsible={false} name={"MsgId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"消息 ID。","example":"6654861479614"}}></SchemaItem><SchemaItem collapsible={false} name={"MsgSeq"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"消息 seq。","example":1}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"Code\": 0,\n  \"Message\": \"success\",\n  \"RequestId\": \"343649807833778782\",\n  \"MsgId\": \"6654861479614\",\n  \"MsgSeq\": 1\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      