---
id: import-one-to-one-messages
title: "ImportPeerMsg"
description: "如果您正使用其他即时通讯服务并希望接入 ZIM，可调用此接口，向 ZIM 导入用户的历史单聊消息（按时间顺序）。"
api: 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
info_path: core_products/zim/zh/docs_zim_server_zh/messaging/open-api-desc
---

<h1 className={"openapi__heading"}>ImportPeerMsg</h1>

<MethodEndpoint method={"post"} path={"/"}></MethodEndpoint>


如果您正使用其他即时通讯服务并希望接入 ZIM，可调用此接口，向 ZIM 导入用户的历史单聊消息（按时间顺序）。

一个单聊会话存在两个用户（用户 A、B）。用户 A 可能删除了部分消息，导致用户 A 在此会话可以看到的消息列表与用户 B 的不同，因此，对于同一个单聊会话，需要为用户 A、B 分别调用此接口。

<Note title="说明">
参数 FromUserId、ToUserId 仅支持数字、英文字符和 \{'!'，'#'，'$'，'%'，'&'，'('，')'，'+'，'-'，':'，';'，'\<'，'='，'.'，'\>'，'?'，'@'，'['，']'，'^'，'_'，' '，'\{'，'\}'，'|'，'~'\}。

为了给开发者带来更好的体验，ZEGO 推荐开发者使用最新版本的 SDK。

如果发送方请求发送 MessageType 为 1 的文本消息，则发送方对应的客户端（SDK 版本需为 2.7.0 或以上）也会收到该消息。

对于发送和接收 MessageType 为 200 的自定义消息，发送方和接收放对应的客户端的 SDK 版本需为 2.8.0 或以上。

如果接收端的 SDK 版本介乎 [2.0.0, 2.8.0) 区间，可以收到自定义消息时，但会显示此消息类型为未知，且无法获取信息内容。如需获取此条消息，请将 SDK 升级为 2.8.0 或以上版本。

如果接收端的 SDK 版本为 1.x.x 版本，则无法收到自定义消息，也不会收到未知消息。
</Note>

<Note title="说明">调用频率限制：20 次/秒。</Note>

## 验证效果
成功导入消息后，可调用 ZIM 服务端接口 [查询单聊会话消息列表](/zim-server/conversation/query-the-message-list-of-one-on-one-chats)，确认用户的单聊会话消息是否导入完整。

## Request
<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Query Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"name":"Action","in":"query","description":"> 接口原型参数\n>\n> https://zim-api.zego.im/?Action=ImportPeerMsg\n","required":true,"schema":{"type":"string","enum":["ImportPeerMsg"]},"style":"form","explode":true}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"AppId","in":"query","description":"💡公共参数。应用 Id，由 ZEGO 分配的用户唯一凭证。可从 <a target=\"_blank\" href=\"https://console.zego.im/\">ZEGO 控制台</a> 获取。","required":true,"schema":{"type":"integer","format":"uint32"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureNonce","in":"query","description":"💡公共参数。16 位 16 进制随机字符串（8 字节随机数的 hex 编码）。生成算法可参考 <a href=\"/zim-server/accessing-server-apis#signature-example\">签名示例</a>。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Timestamp","in":"query","description":"💡公共参数。当前 Unix 时间戳，单位为秒。生成算法可参考 <a href=\"/zim-server/accessing-server-apis#signature-example\">签名示例</a>，最多允许 10 分钟的误差。","required":true,"schema":{"type":"integer","format":"int64"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureVersion","in":"query","description":"💡公共参数。签名版本号。","required":true,"schema":{"type":"string","default":"2.0","enum":["2.0"]}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Signature","in":"query","description":"💡公共参数。签名，用于验证请求的合法性。请参考[签名机制](/zim-server/accessing-server-apis#signature-mechanism)生成。","required":true,"schema":{"type":"string"}}}></ParamsItem></ul></div></details>
<MimeTabs className={"openapi-tabs__mime request"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3><strong className={"openapi-schema__required"}>required</strong></summary><ul className={"request-schema-first-body-node-container"}><SchemaItem collapsible={false} name={"FromUserId"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 32 characters`"} schema={{"type":"string","description":"消息发送方的用户 ID。","maxLength":32,"example":"u1"}}></SchemaItem><SchemaItem collapsible={false} name={"ToUserId"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** `<= 32 characters`"} schema={{"type":"string","description":"消息接收方的用户 ID。","maxLength":32,"example":"u2"}}></SchemaItem><SchemaItem collapsible={false} name={"MessageType"} required={true} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"消息类型，单聊会话的适用类型请参考 [MessageBody 说明](/zim-server/messaging/messagebody-introduction)。\n> 注意\n>\n> 不支持信令消息。\n","example":200}}></SchemaItem><SchemaItem collapsible={false} name={"Priority"} required={true} schemaName={"number"} qualifierMessage={"**Possible values:** [`1`, `2`, `3`]"} schema={{"type":"number","description":"消息优先级（详情请参考 [基本概念介绍 - 消息优先级](https://doc-zh.zego.im/zim-android/introduction/basic-concepts#消息优先级)），取值如下：\n- 1：低。\n- 2：中。\n- 3：高。\n","enum":[1,2,3],"example":1}}></SchemaItem><SchemaItem collapsible={false} name={"MessageBody"} required={true} schemaName={"object"} qualifierMessage={undefined} schema={{"type":"object","description":"消息内容，具体参数格式请参考 [MessageBody 说明](/zim-server/messaging/messagebody-introduction)。\n> 注意\n>\n> 不支持 `OfflinePush` 和 `HasReceipt` 字段。\n","example":{"Message":"hello world","ExtendedData":"s"}}}></SchemaItem><SchemaItem collapsible={false} name={"SubMsgType"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"具体的自定义类型。值由您定义，取值范围为 [0,200]。当 MessageType 为自定义消息时，必填。","example":110}}></SchemaItem><SchemaItem collapsible={false} name={"SearchedContent"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"自定义消息的检索字段。当 MessageType 为自定义消息时，才可填写此字段，长度上限默认为 64 字节。此字段作用于客户端，除非填写了此字段，否则无法通过客户端搜索到关联的自定义消息。","example":"ex"}}></SchemaItem><SchemaItem collapsible={false} name={"SendMessageTime"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"消息发送时间戳（Unix，毫秒级别）。请按照发送时间从前到后的顺序进行导入。\n- 传 0 或不传：取\"当前时间\"。\n- 其他值：最早可取\"当前时间 - 套餐包规定的历史消息保存天数（详情请参考 [计费说明 - 版本差异](/zim-android/introduction/pricing#版本差异)） * 86400000\"，最晚不得晚于\"当前时间\"。\n\n不能早于套餐包规定的历史消息保存天数（详情请参考 [计费说明 - 版本差异](/zim-android/introduction/pricing#版本差异)），也不能晚于当前时间。\n","example":123}}></SchemaItem><SchemaItem collapsible={false} name={"ImportedUserId"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"必须是 FromUserId 或 ToUserId中的一个，代表导入的是谁的单聊会话消息列表。","example":"u1"}}></SchemaItem></ul></details></TabItem></MimeTabs>
<div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>OK</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><ul className={"response-schema-first-body-node-container"}><SchemaItem collapsible={false} name={"Code"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"返回码。\n\n以下仅列出了接口业务逻辑相关的返回码，完整返回码请参考 [全局返回码](/zim-server/return-codes)。\n<table>\n<tbody><tr>\n<th>返回码</th>\n<th>说明</th>\n<th>处理建议</th>\n</tr>\n<tr>\n<td>660400001</td>\n<td>输入的消息大小超出限制。</td>\n<td>请检查输入的消息大小。</td>\n</tr>\n</tbody>\n</table>\n","example":0}}></SchemaItem><SchemaItem collapsible={false} name={"Message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"请求结果的说明信息。","example":"success"}}></SchemaItem><SchemaItem collapsible={false} name={"RequestId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"请求 ID。","example":"343649807833778782"}}></SchemaItem><SchemaItem collapsible={false} name={"MsgId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"消息 ID。","example":"6654861479614"}}></SchemaItem><SchemaItem collapsible={false} name={"MsgSeq"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"number","description":"消息 seq。","example":1}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"Code\": 0,\n  \"Message\": \"success\",\n  \"RequestId\": \"343649807833778782\",\n  \"MsgId\": \"6654861479614\",\n  \"MsgSeq\": 1\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      