openapi: 3.0.0
info:
  title: open-api-desc
  version: 1.0.0
  contact:
    name: ZEGO Support
    email: support@zegocloud.com

servers:
  $ref: '../shared-components.yaml#/servers'

tags:
  - group

paths:
  /:
    get:
      tags: [group]
      summary: 设置群成员角色
      description: |
        调用此接口，可以为群成员设置在群内的角色。

        ZIM SDK 默认支持将用户设置为群主、管理员、普通成员。在群组中，群主拥有所有<b>客户端</b>权限，可以实现所有群组功能。管理员拥有大部分<b>客户端</b>权限。普通成员拥有的<b>客户端</b>权限最少，具体如下表所示：

        <table>
        <tbody><tr>
        <th>客户端权限</th>
        <th>群主（对应枚举值为 1）</th>
        <th>管理员（对应枚举值为 2）</th>
        <th>普通成员（对应枚举值为 3）</th>
        </tr>
        <tr>
        <th>修改群头像、群名称、群公告</th>
        <td rowspan="2">支持</td>
        <td rowspan="2">支持</td>
        <td rowspan="2">支持</td>
        </tr>
        <tr>
        <th>修改群属性</th>
        </tr>
        <tr>
        <th>修改群成员昵称</th>
        <td rowspan="9">支持，可对所有群角色用户使用此功能</td>
        <td rowspan="5">支持，可对所有普通成员使用此功能</td>
        <td rowspan="2">支持，仅可对自己使用此功能</td>
        </tr>
        <tr>
        <th>撤回群成员消息</th>
        </tr>
        <tr>
        <th>踢人</th>
        <td rowspan="7">不支持。</td>
        </tr>
        <tr>
        <th>对单独群成员禁言</th>
        </tr>
        <tr>
        <th>对特定群角色禁言</th>
        </tr>
        <tr>
        <th>设置群成员角色</th>
        <td rowspan="4">不支持</td>
        </tr>
        <tr>
        <th>转让群主</th>
        </tr>
        <tr>
        <th>解散群组</th>
        </tr>
        <tr>
        <th>全员禁言</th>
        </tr>
        </tbody></table>
        除此之外，还可以自定义群角色，但该角色拥有的客户端权限与**普通成员**一致。

        设置成功后，群内成员通过以下 ZIM 回调收到通知：
        
        | iOS | Android | macOS |
        |-----|---------|--------|
        | [groupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~objective-c_ios~protocol~ZIMEventHandler#zim-group-member-info-updated-operated-info-group-id) | [onGroupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~java_android~class~ZIMEventHandler#on-group-member-info-updated) | [groupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~objective-c_macos~protocol~ZIMEventHandler#zim-group-member-info-updated-operated-info-group-id) |
        
        | Windows | Web | 小程序 |
        |---------|-----|---------|
        | [onGroupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~cpp_windows~class~ZIMEventHandler#on-group-member-info-updated) | [groupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_web~interface~ZIMEventHandler#group-member-info-updated) | [groupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_wxxcx~interface~ZIMEventHandler#group-member-info-updated) |
        
        | Flutter | Unity3D | uni-app |
        |---------|---------|---------|
        | [onGroupMemberInfoUpdated](https://pub.dev/documentation/zego_zim/latest/zego_zim/ZIMEventHandler/onGroupMemberInfoUpdated.html) | [OnGroupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~cs_unity3d~class~ZIMEventHandler#on-group-member-info-updated) | [groupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_uni-app~interface~ZIMEventHandler#group-member-info-updated) |
        
        | React Native | HarmonyOS | |
        |---------|--------------|---|
        | [groupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_react-native~interface~ZIMEventHandler#group-member-info-updated) | [groupMemberInfoUpdated](https://doc-zh.zego.im/article/api?doc=zim_API~javascript_harmony~interface~ZIMEventHandler#group-member-info-updated) | |

        <Note title="说明">以下参数 `FromUserId` 和 `UserId` 对应的用户已在客户端调用 `login` 方法登录 ZIM 服务，或已调用 [服务端 API](/zim-server/user/batch-register-users) 完成注册。</Note>

        <Note title="说明">调用频率限制：20 次/秒。</Note>
      operationId: set-group-member-roles
      parameters:
        - name: Action
          in: query
          description: |
            > 接口原型参数
            >
            > https://zim-api.zego.im/?Action=SetGroupMemberRole
          required: true
          schema:
            type: string
            enum: [SetGroupMemberRole]
          style: form
          explode: true
        - $ref: '../shared-components.yaml#/components/parameters/AppId'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureNonce'
        - $ref: '../shared-components.yaml#/components/parameters/Timestamp'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureVersion'
        - $ref: '../shared-components.yaml#/components/parameters/Signature'
        - name: FromUserId
          in: query
          required: true
          description: |
            操作用户 ID，建议填群主 ID。
            > 注意
            >
            > 此参数不能与 ToUserId 相同。
          schema:
            type: string
            maxLength: 32
            example: "operator_user"
        - name: GroupId
          in: query
          required: true
          description: 群组 ID。
          schema:
            type: string
            maxLength: 32
            example: "group123"
        - name: ToUserId
          in: query
          required: true
          description: 待设置角色的目标用户 ID。
          schema:
            type: string
            maxLength: 32
            example: "target_user"
        - name: Role
          in: query
          required: true
          description: |
            角色：
            - 2: 管理员。
            - 3: 普通成员。
            - 其他值：可自定义角色，取值范围建议为 [100, 255]，权限与普通成员一致。
          schema:
            type: number
            enum: [2, 3]
            example: 2
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'

components:
  schemas:
    CommonResponse:
      type: object
      properties:
        Code:
          type: number
          description: |
            返回码。

            以下仅列出了接口业务逻辑相关的返回码，完整返回码请参考 [全局返回码](/zim-server/return-codes)。
            <table>
            <thead><tr><th>返回码</th><th>说明</th><th>处理建议</th></tr></thead>
            <tbody>
            <tr><td>660000001</td><td>服务端错误。</td><td>请重试，或联系 ZEGO 技术支持。</td></tr>
            <tr><td>660000002</td><td>参数错误。</td><td>请检查输入的参数。</td></tr>
            <tr><td>660300005</td><td>调用接口的频率超出了 AppID 级别限制。</td><td>请稍后重试。</td></tr>
            <tr><td>660600001</td><td>群不存在。</td><td>请确认 GroupId 是否正确。</td></tr>
            <tr><td>660600009</td><td>查询群信息失败。</td><td>请先确认 GroupID 是否正确；如正确请联系技术支持。</td></tr>
            <tr><td>660600024</td><td>ToUserId 不在群内。</td><td>请确认 ToUserId 是否在群内：<ul><li>如果在，请联系 ZEGO 技术支持处理。</li><li>如果不在，请将ToUserId 拉进群。</li></ul></td></tr>
            <tr><td>660600029</td><td>Role 不能设置为 1。</td><td>请修改 Role。</td></tr>
            <tr><td>660600030</td><td>FromUserId 不能和 ToUserId 相等。</td><td>请修改 ToUserId。</td></tr>
            </tbody>
            </table>
          example: 0
        Message:
          type: string
          description: 请求结果的说明信息。
          example: "success"
        RequestId:
          type: string
          description: 请求 ID。
          example: "343649807833778782"