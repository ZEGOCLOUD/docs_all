---
docType: API
---

# ZegoMediaDataPublisher

## ZegoMediaDataPublisher

*Declared in `ZegoExpressDefines.h`*

### Methods
<ParamField
  name="setEventHandler:"
  prototype="- (void)setEventHandler:(nullable id<[ZegoMediaDataPublisherEventHandler](../../api-reference/class#zegomediadatapublishereventhandler)>) handler;"
  desc="Set event callback handler for the media data publisher."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| handler | nullable id\<[ZegoMediaDataPublisherEventHandler](../../api-reference/class#zegomediadatapublishereventhandler)\> | The event handler |

**Details**

Set event callback handler for media data publisher.

<Note title="">
- **Use cases**: Often used in server-side publishing stream scenarios, such as AI classrooms.
- **When to call**: After calling the [createMediaDataPublisher] function to create a media data publisher.
- **Caution**: This API used to be named [setMediaDataPublisherEventHandler] before version 3.8.0. Please refer to [Upgrade guide v3.8.0+](https://docs.zegocloud.com/en/16413.html).
</Note>

<Warning title="">
- **Available since**: 2.17.0
</Warning>
</ParamField>
<ParamField
  name="addMediaFilePath:isClear:"
  prototype="- (void)addMediaFilePath:(NSString *) path isClear:(BOOL) isClear;"
  desc="Add media file to the publish queue. Currently, only mp4 / m4a / aac files are supported, and special conversion is required."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| path | NSString * | Local absolute path to the media file. |
| isClear | BOOL | Whether to clear the publish queue. |

**Details**

Add media file to the publish queue. Currently, only mp4 / m4a / aac file are supported, and special conversion is required.

<Note title="">
- **Use cases**: Often used in server-side publishing stream scenarios, such as AI classrooms.
- **When to call**: After calling the [createMediaDataPublisher] function to create a media data publisher.
- **Caution**: The mp4 file format must meet the following pointsï¼šThe video must be encoded as H.264 and cannot contain B frames, only I and P frames. The I frame interval is 2s, that is, a single GOP value is 2s; The frame rate, bit rate, and resolution of the video are consistent with the frame rate, bit rate, and resolution set by [setVideoConfig] before publishing stream; Audio encoding must be MPEG-4 AAC.
</Note>

<Warning title="">
- **Available since**: 2.17.0
</Warning>
</ParamField>
<ParamField
  name="reset"
  prototype="- (void)reset;"
  desc="Clear all the status in this media data publisher, so that it can be restarted next time."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
When you need to re-publish stream and do not need to continue publishing from the previous publish queue, you can call this function to reset this media data publisher's state.

<Note title="">
- **Use cases**: Often used in server-side publishing stream scenarios, such as AI classrooms.
- **Caution**: When the developer calls [logoutRoom], the state is automatically reset.
</Note>

<Warning title="">
- **Available since**: 2.17.0
</Warning>
</ParamField>
<ParamField
  name="setVideoSendDelayTime:"
  prototype="- (void)setVideoSendDelayTime:(int) delayTime;"
  desc="Set the delay time of video playback."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| delayTime | int | Video playback time.Required: Yes.Value range: [0, 100] ms. |

**Details**

When this value is set, when publishing video file stream, the SDK will permanently delay the video to the set time value before sending.

<Note title="">
- **Use cases**: Mainly used to correct the fixed audio and picture asynchronous phenomenon that occurs during streaming.
- **When to call**: After calling the [createMediaDataPublisher] function to create a media data publisher.
</Note>

<Warning title="">
- **Available since**: 2.17.0
</Warning>
</ParamField>
<ParamField
  name="seekTo:"
  prototype="- (void)seekTo:(unsigned long long) millisecond;"
  desc="Specify the starting point of the current video file publishing."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**Parameters**

| Name | Type | Description |
| --- | --- | --- |
| millisecond | unsigned long long | The timestamp of the start of streaming (relative to the timestamp of the file currently being published, the starting value is 0). the unit is milliseconds |

**Details**

Specify the starting point of the current video file publishing.

<Note title="">
- **When to call**: Called at any point between [OnMediaDataPublisherFileOpen] and [OnMediaDataPublisherFileClose]. For example: this function can be called directly in the [OnMediaDataPublisherFileOpen] callback.
</Note>

<Warning title="">
- **Available since**: 2.17.0
</Warning>
</ParamField>
<ParamField
  name="getTotalDuration"
  prototype="- (unsigned long long)getTotalDuration;"
  desc="Get the total duration of the current file."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
Get the total duration of the current file, in milliseconds.

<Note title="">
- **When to call**: After [onMediaDataPublisherFileDataBegin] callback.
</Note>

<Warning title="">
- **Available since**: 2.17.0
</Warning>

The total duration of the current file.
</ParamField>
<ParamField
  name="getCurrentDuration"
  prototype="- (unsigned long long)getCurrentDuration;"
  desc="Get the playing progress of the current file."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
Get the playing progress of the current file, in milliseconds.

<Note title="">
- **When to call**: After received the [onMediaDataPublisherFileDataBegin] callback.
</Note>

<Warning title="">
- **Available since**: 2.17.0
</Warning>

The playing progress of the current file.
</ParamField>
<ParamField
  name="getIndex"
  prototype="- (NSNumber *)getIndex;"
  desc="Get the channel index of the media data publisher."
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
Get the channel index of the media data publisher.

<Warning title="">
- **Available since**: 3.4.0
</Warning>
</ParamField>
