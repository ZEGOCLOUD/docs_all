---
docType: API
---

# ZegoMediaDataPublisher

## ZegoMediaDataPublisher

*Declared in `ZegoMediaDataPublisher.java`*

### 方法
<ParamField
  name="setEventHandler"
  prototype="public  void setEventHandler([IZegoMediaDataPublisherEventHandler](../../api-reference/class#izegomediadatapublishereventhandler) handler)"
  desc="设置媒体推流器的事件回调。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| handler | [IZegoMediaDataPublisherEventHandler](../../api-reference/class#izegomediadatapublishereventhandler) | 事件回调 Handler |

**详情**

设置媒体推流器的事件回调 handler。

<Note title="">
- **业务场景**：常用于服务器端推流的场景，例如 AI 课堂。
- **调用时机**：在调用 [createMediaDataPublisher] 函数创建媒体数据推流器后。
</Note>

<Warning title="">
- **支持版本**：2.17.0 及以上。
- **注意事项**：此 API 在 3.8.0 版本以前曾用名为 [setMediaDataPublisherEventHandler] 请参考 [3.8.0 及以上版本升级指南](https://doc-zh.zego.im/article/17982
</Warning>
</ParamField>
<ParamField
  name="addMediaFilePath"
  prototype="public  void addMediaFilePath(String path, boolean isClear)"
  desc="添加媒体文件到推流队列中。目前仅支持 mp4 / m4a / aac 文件，且需要做特殊转换。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| path | String | 媒体文件的本地绝对路径。 |
| isClear | boolean | 是否清空推流队列。 |

**详情**

添加媒体文件到推流队列中。目前仅支持 mp4 / m4a / aac 文件，且需要做特殊转换。

<Note title="">
- **业务场景**：常用于服务器端推流的场景，例如 AI 课堂。
- **调用时机**：在调用 [createMediaDataPublisher] 函数创建媒体数据推流器后。
</Note>

<Warning title="">
- **支持版本**：2.17.0 及以上。
- **注意事项**：mp4 文件格式必须满足以下几点：视频编码为 H.264，不能包含 B 帧，仅包含 I 帧和 P 帧，I 帧间隔为 2s，即单个 GOP 值为 2s；视频的帧率、码率、分辨率与推流前通过 [setVideoConfig] 设置的帧率、码率、分辨率保持一致；音频编码为 MPEG-4 AAC。
</Warning>
</ParamField>
<ParamField
  name="reset"
  prototype="public  void reset()"
  desc="清除此媒体推流器中的所有状态，以便下次推流时重新开始。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
当需要重新推流，且不需要从之前的推流队列中继续推时，可调用此函数重置媒体推流器的状态。

<Warning title="">
- **支持版本**：2.17.0 及以上。
- **注意事项**：当开发者调用了 [logoutRoom] 之后，会自动重置状态。
</Warning>
</ParamField>
<ParamField
  name="setVideoSendDelayTime"
  prototype="public  void setVideoSendDelayTime(int delayTime)"
  desc="设置推迟视频播放时间。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| delayTime | int | 推迟视频播放时间。是否必填：是。取值范围：[0, 100] ms。 |

**详情**

当设置了此值后，在推流视频文件时，SDK 会固定地将视频延迟至设置的时间值才开始发送。

<Note title="">
- **业务场景**：主要用于修正推流时出现的固定的音画不同步现象。
- **调用时机**：在调用 [createMediaDataPublisher] 函数创建媒体数据推流器后。
</Note>

<Warning title="">
- **支持版本**：2.17.0 及以上。
</Warning>
</ParamField>
<ParamField
  name="seekTo"
  prototype="public  void seekTo(long millisecond)"
  desc="指定当前视频文件推流发送的时间起始点。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| millisecond | long | 开始推流的时间戳（相对于当前正在推流文件的时间戳，起始值为 0），单位：毫秒。 |

**详情**

指定当前视频文件推流发送的时间起始点。

<Note title="">
- **调用时机**：在 [OnMediaDataPublisherFileOpen] 与 [OnMediaDataPublisherFileClose] 之间任意时间点调用都可。如：可以在 [OnMediaDataPublisherFileOpen] 回调中直接调用此函数。
</Note>

<Warning title="">
- **支持版本**：2.17.0 及以上。
</Warning>
</ParamField>
<ParamField
  name="getTotalDuration"
  prototype="public  long getTotalDuration()"
  desc="获取当前文件的总时长。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
获取当前文件的总时长，单位毫秒。

<Note title="">
- **调用时机**：[onMediaDataPublisherFileDataBegin] 回调之后。
</Note>

<Warning title="">
- **支持版本**：2.17.0 及以上。
</Warning>

当前文件的总时长。
</ParamField>
<ParamField
  name="getCurrentDuration"
  prototype="public  long getCurrentDuration()"
  desc="获取当前文件的播放进度。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
获取当前文件的播放进度，单位毫秒。

<Note title="">
- **调用时机**：[onMediaDataPublisherFileDataBegin] 回调之后。
</Note>

<Warning title="">
- **支持版本**：2.17.0 及以上。
</Warning>

当前文件的播放进度。
</ParamField>
<ParamField
  name="getIndex"
  prototype="public  int getIndex()"
  desc="获取媒体推流器的推流通道号。"
  parent_file="Declared in \`ZegoMediaDataPublisher.java\`"
  parent_name="ZegoMediaDataPublisher"
  parent_type="class">
获取媒体推流器的推流通道号。

<Warning title="">
- **支持版本**：3.4.0 及以上。
</Warning>
</ParamField>
