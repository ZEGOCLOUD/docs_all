# Authenticating server-to-server callbacks
---

To ensure system security, you must authenticate every callback request sent from the ZEGOCLOUDserver to your application server. You can verify the callback request by comparing the signature included in the request with the locally calculated signature.

## Verifying the callback request signature

The following flow chart shows the signature calculation and verification process:

<Frame width="512" height="auto" caption="">
  <img src="https://storage.zego.im/sdk-doc/Pics/server_v2/Verify_signature_en.png" />
</Frame>

Parameter descriptions are as follows:

| Parameter | Description |
|-----------|-------------|
| callbacksecret | Server-side verification key. Generated when registering a project in the [ZEGOCLOUDConsole](https://console.zego.im/), and can be viewed in "Console > Project Configuration > Project Information > Configuration Information". |
| timestamp | Unix timestamp. |
| nonce | Random number. |


## Example Code

The following example code is used to generate and verify the signature.

<CodeGroup> 
```PHP title="PHP Example"
// Get signature, timestamp, nonce from request parameters
$signature = $_POST["signature"];
$timestamp = $_POST["timestamp"];
$nonce = $_POST["nonce"];

$secret = callbacksecret; // callbacksecret obtained from the backend
$tmpArr = array($secret, $timestamp, $nonce);
sort($tmpArr, SORT_STRING);
$tmpStr = implode( $tmpArr );
$tmpStr = sha1( $tmpStr );

if( $tmpStr == $signature ){
    return true;
} else {
    return false;
}
```
```java title="Java Example"
// Get signature, timestamp, nonce from request parameters
String signature = request.getParameter("signature");
long timestamp = request.getParameter("timestamp");
String nonce = request.getParameter("nonce");

// Get callbacksecret from backend
String secret = callbacksecret;

String[] tempArr = {secret, ""+timestamp, nonce};
Arrays.sort(tempArr);
        
String tmpStr = "";
for (int i = 0; i < tempArr.length; i++) {
    tmpStr += tempArr[i];
}
tmpStr = org.apache.commons.codec.digest.DigestUtils.sha1Hex(tmpStr);

return tmpStr.equals(signature);
```

</CodeGroup>

## Output Example

```PHP title="PHP Example"
$nonce = 123412;
$timestamp = 1470820198;
$secret = 'secret';
// After sorting the three parameters, the order is: nonce, timestamp, secret
// The original string to be encrypted after sorting and concatenation is: 1234121470820198secret
// The encryption result is: 5bd59fd62953a8059fb7eaba95720f66d19e4517
```