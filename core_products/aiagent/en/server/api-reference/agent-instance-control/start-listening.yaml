openapi: 3.0.0
info:
  title: open-api-desc
  version: 1.0.0
  contact:
    name: AI Agent API Support
    email: support@zegocloud.com

servers:
  $ref: '../shared-components.yaml#/servers'

tags:
  - name: agent-instance-control

paths:
  /:
    post:
      tags:
        - agent-instance-control
      summary: StartListening
      description: In walkie-talkie mode, the AI agent starts listening. For enabling walkie-talkie mode, please refer to the AdvancedConfig.CommunicationMode parameter description in [Create Agent Instance](/aiagent-server/api-reference/agent-instance-management/create-agent-instance).
      operationId: start-listening
      parameters:
        - name: Action
          in: query
          description: |
            > API prototype parameter
            >
            > https://aigc-aiagent-api.zegotech.cn?Action=StartListening
          required: true
          allowEmptyValue: false
          schema:
            type: string
            enum: [StartListening]
          style: form
          explode: true
        # Reference shared parameters
        - $ref: '../shared-components.yaml#/components/parameters/AppId'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureNonce'
        - $ref: '../shared-components.yaml#/components/parameters/Timestamp'
        - $ref: '../shared-components.yaml#/components/parameters/Signature'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureVersion'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StartListeningRequest"
            example:
              AgentInstanceId: "1907755175297171456"
              Sequence: 1
      responses:
        "200":
          description: Started listening successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StartListeningResponse"

components:
  schemas:
    StartListeningRequest:
      type: object
      required:
        - AgentInstanceId
      properties:
        AgentInstanceId:
          type: string
          description: Unique identifier of the Agent instance, globally unique.
          example: "1907755175297171456"
        Sequence:
          type: integer
          format: int64
          description: A sequence number defined by the client that increases with requests. Each user/device increments independently. The AI Agent backend only processes the request with the latest Sequence. If not passed, requests are processed in the order received by the AI Agent backend. Due to network issues, the order of user speaking may not match the order received by the backend.
          example: 1

    StartListeningResponse:
      type: object
      properties:
        Code:
          type: integer
          description: Return code, 0 indicates success, other values indicate failure. For details, please refer to the [Return Codes](/aiagent-server/api-reference/return-codes) description.
          example: 0
        Message:
          type: string
          description: Request result description
          example: "success"
        RequestId:
          type: string
          description: Request ID
          example: "8916619579948490296"

