import {getPlatformData} from "/snippets/utils-content-parser.js"


export const expressSDKMap = {
  'Android': <a href='https://doc-zh.zego.im/article/3575' target='_blank'>ZEGO Express SDK</a>,
  'iOS': <a href='https://doc-zh.zego.im/article/3574' target='_blank'>ZEGO Express SDK</a>,
  'Web': <a href='https://doc-zh.zego.im/article/6839' target='_blank'>ZEGO Express SDK</a>,
}

# å¿«é€Ÿå¼€å§‹

æœ¬æ–‡æ¡£ç”¨äºè¯´æ˜å¦‚ä½•å¿«é€Ÿé›†æˆå®¢æˆ·ç«¯ SDK ï¼ˆZEGO Express SDKï¼‰å¹¶åœ¨æ‚¨çš„ä¸šåŠ¡åå°è°ƒç”¨ AI Agent ç›¸å…³åå°æ¥å£å®ç°ä¸ AI Agent çš„è¯­éŸ³äº’åŠ¨ã€‚

## å‰ææ¡ä»¶

- å·²åœ¨ [ZEGO æ§åˆ¶å°](https://console.zego.im/) åˆ›å»ºé¡¹ç›®ï¼Œå¹¶ç”³è¯·æœ‰æ•ˆçš„ AppID å’Œ AppSignï¼Œè¯¦æƒ…è¯·å‚è€ƒ [æ§åˆ¶å° - é¡¹ç›®ä¿¡æ¯](https://doc-zh.zego.im/article/12107)ã€‚
- è”ç³» ZEGO æŠ€æœ¯æ”¯æŒå¼€é€š AI Agent ç›¸å…³æœåŠ¡å¹¶è·å– LLM å’Œ TTS ç›¸å…³é…ç½®ä¿¡æ¯ã€‚
- å·²ç»é›†æˆäº†æ”¯æŒ AI é™å™ªå’Œ AI å›å£°æ¶ˆé™¤çš„ {getPlatformData(props,expressSDKMap)}ã€‚
- å·²éƒ¨ç½²ä¸šåŠ¡åå°å¹¶å®ç°è°ƒç”¨ AI Agent ç›¸å…³æœåŠ¡ç«¯ APIï¼ˆå¯å‚è€ƒæœåŠ¡ç«¯ç¤ºä¾‹ä»£ç ï¼‰ã€‚
<Note title="è¯´æ˜">
æ–‡æœ¬è½¬è¯­éŸ³ï¼ˆTTSï¼‰æœåŠ¡ä¾›åº”å•†ã€‚å¯é€‰ï¼šAliyunï¼šé˜¿é‡Œäº‘ã€Bytedanceï¼šç«å±±å¼•æ“ã€Minimaxï¼šMiniMaxã€‚

è¯¦æƒ…è¯·å‚è€ƒ [TTS å‚æ•°](/aiagent-server/common-parameter-description#tts)è¯´æ˜æ–‡æ¡£ã€‚
</Note>
<Warning title="æ³¨æ„">è¯·è”ç³» ZEGO æŠ€æœ¯æ”¯æŒè·å–æ”¯æŒ AI é™å™ªå’Œ AI å›å£°æ¶ˆé™¤çš„ ZEGO Express SDK ç‰ˆæœ¬ï¼Œå¹¶åœ¨é›†æˆä½¿ç”¨æ—¶å¼€å¯  AI é™å™ªå’Œ AI å›å£°æ¶ˆé™¤ä»¥è·å¾—æ›´å¥½çš„è¯­éŸ³äº¤äº’æ•ˆæœã€‚</Warning>

## ç¤ºä¾‹ä»£ç 
ä»¥ä¸‹æ˜¯å®ç°æ ¸å¿ƒèƒ½åŠ›æ‰€éœ€è¦çš„ç¤ºä¾‹ä»£ç ï¼Œæ‚¨å¯ä»¥å‚è€ƒç¤ºä¾‹ä»£ç æ¥å®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚

<CardGroup cols={2}>
:::if{props.platform=undefined}
<Card title="Android å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç " href="https://github.com/ZEGOCLOUD/ai_agent_quick_start/tree/master/android" target="_blank">
Android å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç ã€‚åŒ…å«æœ€åŸºæœ¬çš„ç™»å½•ã€æ¨æµã€æ‹‰æµã€é€€å‡ºæˆ¿é—´ç­‰èƒ½åŠ›ã€‚
</Card>
:::
:::if{props.platform="iOS"}
<Card title="iOS å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç " href="https://github.com/ZEGOCLOUD/ai_agent_quick_start/tree/master/ios" target="_blank">
iOS å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç ã€‚åŒ…å«æœ€åŸºæœ¬çš„ç™»å½•ã€æ¨æµã€æ‹‰æµã€é€€å‡ºæˆ¿é—´ç­‰èƒ½åŠ›ã€‚
</Card>
:::
:::if{props.platform="Web"}
<Card title="Web å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç " href="https://github.com/ZEGOCLOUD/ai_agent_quick_start/tree/master/web" target="_blank">
Web å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç ã€‚åŒ…å«æœ€åŸºæœ¬çš„ç™»å½•ã€æ¨æµã€æ‹‰æµã€é€€å‡ºæˆ¿é—´ç­‰èƒ½åŠ›ã€‚
</Card>
:::
<Card title="æœåŠ¡ç«¯ç¤ºä¾‹ä»£ç "  href="https://github.com/ZEGOCLOUD/ai_agent_quick_start_server" target="_blank">
æœåŠ¡ç«¯ç¤ºä¾‹ä»£ç ã€‚åŒ…å«æœ€åŸºæœ¬çš„è·å– ZEGO Tokenã€æ³¨å†Œæ™ºèƒ½ä½“ã€åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹ã€åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹ç­‰èƒ½åŠ›ã€‚
</Card>
</CardGroup>

## æ•´ä½“ä¸šåŠ¡æµç¨‹å›¾

æ‚¨éœ€è¦åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ ZEGO Express SDK å®ç°çœŸå®ç”¨æˆ·è¿›å…¥æˆ¿é—´å¹¶æ¨æµã€‚ç„¶åè°ƒç”¨ AI Agent æä¾›çš„æœåŠ¡ç«¯ API æ¥å£ï¼Œå®ç°å°†æ™ºèƒ½ä½“åŠ å…¥æˆ¿é—´å¹¶ä¸çœŸå®ç”¨æˆ·è¿›è¡Œå®æ—¶äº’åŠ¨ã€‚

```mermaid
sequenceDiagram
    participant å®¢æˆ·ç«¯
    participant ä¸šåŠ¡åå°
    participant AI Agentåå°
    
    å®¢æˆ·ç«¯->>å®¢æˆ·ç«¯: åˆå§‹åŒ– ZEGO Express SDK
    
    å®¢æˆ·ç«¯->>ä¸šåŠ¡åå°: æ³¨å†Œæ™ºèƒ½ä½“
    ä¸šåŠ¡åå°->>AI Agentåå°: æ³¨å†Œæ™ºèƒ½ä½“
    AI Agentåå°-->>ä¸šåŠ¡åå°: 
    ä¸šåŠ¡åå°-->>å®¢æˆ·ç«¯: 
    
    å®¢æˆ·ç«¯->>ä¸šåŠ¡åå°: è·å– Token
    ä¸šåŠ¡åå°-->>å®¢æˆ·ç«¯: Token
    
    å®¢æˆ·ç«¯->>å®¢æˆ·ç«¯: ç”¨æˆ·ä½¿ç”¨ Token ç™»å½•æˆ¿é—´å¹¶æ¨æµ
    
    å®¢æˆ·ç«¯->>ä¸šåŠ¡åå°: åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹
    ä¸šåŠ¡åå°->>AI Agentåå°: åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹
    AI Agentåå°->>AI Agentåå°: æ™ºèƒ½ä½“ç™»å½•æˆ¿é—´å¹¶æ¨æµã€æ‹‰ç”¨æˆ·æµ
    AI Agentåå°-->>ä¸šåŠ¡åå°: 
    ä¸šåŠ¡åå°-->>å®¢æˆ·ç«¯: 
    
    
    å®¢æˆ·ç«¯->>å®¢æˆ·ç«¯: ç”¨æˆ·æ‹‰æ™ºèƒ½ä½“æµ
    
    å®¢æˆ·ç«¯->>ä¸šåŠ¡åå°: åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹
    ä¸šåŠ¡åå°->>AI Agentåå°: åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹
    AI Agentåå°-->>ä¸šåŠ¡åå°: 
    ä¸šåŠ¡åå°-->>å®¢æˆ·ç«¯: 
    
    å®¢æˆ·ç«¯->>å®¢æˆ·ç«¯: ç”¨æˆ·åœæ­¢æ¨æµå¹¶é€€å‡ºæˆ¿é—´
```

## æ ¸å¿ƒèƒ½åŠ›å®ç°


<Steps>
<Step title="åœ¨å®¢æˆ·ç«¯åˆå§‹åŒ– ZEGO Express SDK">

ä»¥ä¸‹æ˜¯åˆå§‹åŒ– ZEGO Express SDK çš„å…³é”®æ­¥éª¤ï¼š
:::if{props.platform=undefined}
1 æ·»åŠ æƒé™å£°æ˜

è¿›å…¥ â€œapp/src/mainâ€ ç›®å½•ï¼Œæ‰“å¼€ â€œAndroidManifest.xmlâ€ æ–‡ä»¶ï¼Œæ·»åŠ æƒé™ã€‚
```xml AndroidManifest.xml
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECORD_AUDIO" /> 
```
2 è¿è¡Œæ—¶ç”³è¯·å½•éŸ³æƒé™
```java
private final ActivityResultLauncher<String> requestPermissionLauncher = registerForActivityResult(
    new ActivityResultContracts.RequestPermission(), new ActivityResultCallback<Boolean>() {
        @Override
        public void onActivityResult(Boolean isGranted) {
            if (isGranted) {
                // åŒæ„æƒé™
            }
        }
    });
//å‘èµ·è¯·æ±‚
requestPermissionLauncher.launch(Manifest.permission.RECORD_AUDIO);
```
3 åˆ›å»ºå¹¶åˆå§‹åŒ– ZegoExpressEngine
```java {3}
ZegoEngineProfile zegoEngineProfile = new ZegoEngineProfile();
zegoEngineProfile.appID = KeyCenter.appID;
zegoEngineProfile.scenario = ZegoScenario.HIGH_QUALITY_CHATROOM;
zegoEngineProfile.application = getApplication();
ZegoExpressEngine.createEngine(zegoEngineProfile, null);
```

æ›´è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [é›†æˆ SDK](https://doc-zh.zego.im/article/3575) å’Œ [å®ç°éŸ³é¢‘é€šè¯](https://doc-zh.zego.im/article/7636)ã€‚
:::
:::if{props.platform="iOS"}
1 åœ¨ Info.plist æ–‡ä»¶å£°æ˜å¿…è¦çš„æƒé™

```xml Info.plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    ...
    <key>UIBackgroundModes</key>
    <array>
        <string>audio</string>
    </array>
    <key>NSMicrophoneUsageDescription</key>
    <string>éœ€è¦è®¿é—®éº¦å…‹é£ä»¥è¿›è¡Œè¯­éŸ³èŠå¤©</string>
</dict>
</plist>
```
2 è¿è¡Œæ—¶ç”³è¯·å½•éŸ³æƒé™

```objectivec
- (void)requestAudioPermission:(void(^)(BOOL granted))completion {
    /// éœ€è¦åœ¨é¡¹ç›®çš„ Info.plist æ–‡ä»¶ä¸­æ·»åŠ éº¦å…‹é£æƒé™çš„ä½¿ç”¨è¯´æ˜
    AVAudioSession *audioSession = [AVAudioSession sharedInstance];
    [audioSession requestRecordPermission:^(BOOL granted) {
        dispatch_async(dispatch_get_main_queue(), ^{
            completion(granted);
        });
    }];
}
```

3 åˆ›å»ºå¹¶åˆå§‹åŒ– ZegoExpressEngine

```objectivec {4}
-(void)initZegoExpressEngine{
    ZegoEngineProfile* profile = [[ZegoEngineProfile alloc]init];
    profile.appID = kZegoPassAppId;
    profile.scenario = ZegoScenarioHighQualityChatroom; //è®¾ç½®è¯¥åœºæ™¯å¯ä»¥é¿å…ç”³è¯·ç›¸æœºæƒé™ï¼Œæ¥å…¥æ–¹åº”æŒ‰è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯è®¾ç½®å…·ä½“å€¼
    
    [ZegoExpressEngine createEngineWithProfile:profile eventHandler:self];
}
```

æ›´è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [é›†æˆ SDK](https://doc-zh.zego.im/article/3574) å’Œ [å®ç°éŸ³é¢‘é€šè¯](https://doc-zh.zego.im/article/7631)ã€‚
:::
:::if{props.platform="Web"}
1 åŠ è½½AIé™å™ªæ¨¡å—

2 å®ä¾‹åŒ– ZegoExpressEngine

3 æ£€æŸ¥ç³»ç»Ÿè¦æ±‚ï¼ˆWebRTC æ”¯æŒå’Œéº¦å…‹é£æƒé™ï¼‰
```javascript {7,9,11}
import { ZegoExpressEngine } from "zego-express-engine-webrtc";
import { VoiceChanger } from "zego-express-engine-webrtc/voice-changer";

const appID = 1234567 // ä»å³æ„æ§åˆ¶å°è·å–
const server = 'xxx' // ä»å³æ„æ§åˆ¶å°è·å–
// åŠ è½½AIé™å™ªæ¨¡å—
ZegoExpressEngine.use(VoiceChanger);
// å®ä¾‹åŒ– ZegoExpressEngineä¼ å…¥appIdå’Œserverç­‰é…ç½®
const zg = new ZegoExpressEngine(appID, server);
// æ£€æŸ¥ç³»ç»Ÿè¦æ±‚
const checkSystemRequirements = async () => {
    // æ£€æµ‹æ˜¯å¦æ”¯æŒwebRTC
    const rtc_sup = await zg.checkSystemRequirements("webRTC");
    if (!rtc_sup.result) {
      // æµè§ˆå™¨ä¸æ”¯æŒwebrtc
  }
    // æ£€æµ‹æ˜¯å¦å¼€å¯éº¦å…‹é£æƒé™
    const mic_sup = await zg.checkSystemRequirements("microphone");
    if (!mic_sup.result) {
      // æœªå¼€å¯éº¦å…‹é£æƒé™
  }
}
checkSystemRequirements()
```

æ›´è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [é›†æˆ SDK](https://doc-zh.zego.im/article/6839) å’Œ [å®ç°éŸ³é¢‘é€šè¯](https://doc-zh.zego.im/article/9540)ã€‚
:::

</Step>
<Step title="æ³¨å†Œæ™ºèƒ½ä½“">
æ³¨å†Œæ™ºèƒ½ä½“ç”¨äºè®¾å®šæ™ºèƒ½ä½“åŸºç¡€é…ç½®ï¼ŒåŒ…æ‹¬æ™ºèƒ½ä½“åç§°ã€LLMã€TTSã€ASRç­‰ç›¸å…³é…ç½®ã€‚æ³¨å†Œåå¯ä»¥è¯¥æ™ºèƒ½ä½“ä½œä¸ºæ¨¡æ¿åˆ›å»ºå¤šä¸ªå®ä¾‹ä¸å¤šä¸ªçœŸå®ç”¨æˆ·è¿›è¡Œäº’åŠ¨ã€‚

é€šå¸¸æ™ºèƒ½ä½“æ˜¯ç›¸å¯¹æ¯”è¾ƒå›ºå®šçš„ï¼Œä¸€æ—¦è®¾å®šå¥½æ™ºèƒ½ä½“çš„ç›¸å…³å‚æ•°ï¼ˆäººè®¾å½¢è±¡ï¼‰å°±ä¸ä¼šç»å¸¸æ”¹åŠ¨ã€‚æ‰€ä»¥å»ºè®®æŒ‰ç…§ä¸šåŠ¡æµç¨‹éœ€è¦åœ¨åˆå§‹åŒ–åº”ç”¨æ—¶æˆ–è€…å…¶ä»–å…¶ä»–æ­¥éª¤æ³¨å†Œæ™ºèƒ½ä½“å³å¯ã€‚

<Note title="è¯´æ˜">ä¸€ä¸ªæ™ºèƒ½ä½“åªèƒ½æ³¨å†Œä¸€æ¬¡ï¼ˆåŒä¸€ä¸ªIDï¼‰ï¼Œå¦‚æœé‡å¤æ³¨å†Œä¼šè¿”å›é”™è¯¯ç  410001008ã€‚</Note>

ä»¥ä¸‹æ˜¯è°ƒç”¨ä¸šåŠ¡åå°æ¥å£å®ç°æ³¨å†Œæ™ºèƒ½ä½“çš„ç¤ºä¾‹ï¼š

:::if{props.platform=undefined}
<CodeGroup>
```java å®¢æˆ·ç«¯è°ƒç”¨æ³¨å†Œæ™ºèƒ½ä½“æ¥å£ {6-10}
public static void registerAgent(String agentId, String agentName) throws IOException {
    JSONObject json = new JSONObject();
    json.put("agent_id", agentId);
    json.put("agent_name", agentName);
    
    RequestBody body = RequestBody.create(json.toString(), JSON);
    Request request = new Request.Builder()
            .url(YOUR_SERVER_URL + "/api/agent/register") // YOUR_SERVER_URL ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
            .post(body)
            .build();
    
    try (Response response = client.newCall(request).execute()) {
        System.out.println(response.body().string());
    }
}
```
```javascript æœåŠ¡ç«¯å®ç°æ³¨å†Œæ™ºèƒ½ä½“é€»è¾‘
// æ³¨æ„ï¼šprocess.env. ä¸ºä»ç¯å¢ƒå˜é‡è¯»å–çš„å€¼ã€‚è¯·å‚è€ƒæœåŠ¡ç«¯ç¤ºä¾‹ä»£ç çš„ .env.example æ–‡ä»¶ã€‚
async registerAgent(agentId: string, agentName: string) {
    if (!process.env.LLM_BASE_URL || !process.env.LLM_API_KEY || !process.env.LLM_MODEL) {
        throw new Error('LLM_BASE_URL, LLM_API_KEY and LLM_MODEL environment variables must be set');
    }
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=RegisterAgent
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-configuration-management/register-agent
    const action = 'RegisterAgent';
    const body = {
        AgentId: agentId,
        Name: agentName,
        LLM: {
            Url: process.env.LLM_BASE_URL || "",
            ApiKey: process.env.LLM_API_KEY || "",
            Model: process.env.LLM_MODEL || "",
            // SystemPrompt: SYSTEM_PROMPT
        },
        TTS: {
            Vendor: "Bytedance",
            Params: {
                "app": {
                    "appid": process.env.TTS_BYTEDANCE_APP_ID || "",
                    "token": process.env.TTS_BYTEDANCE_TOKEN || "",
                    "cluster": process.env.TTS_BYTEDANCE_CLUSTER || ""
                },
                "speed_ratio": 1,
                "volume_ratio": 1,
                "pitch_ratio": 1,
                "emotion": "happy",
                "audio": {
                    "rate": 24000,
                    "voice_type": process.env.TTS_BYTEDANCE_VOICE_TYPE || ""
                }
            },
            FilterText: [{ BeginCharacters: "(", EndCharacters: ")" }, { BeginCharacters: "ï¼ˆ", EndCharacters: "ï¼‰" }, { BeginCharacters: "{", EndCharacters: "}" }],
        }
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    return this.sendRequest<any>(action, body);
}
```
</CodeGroup>
:::

:::if{props.platform="iOS"}
<CodeGroup>
```swift å®¢æˆ·ç«¯è°ƒç”¨æ³¨å†Œæ™ºèƒ½ä½“æ¥å£ {2,7,8}
+ (void)registerAgentWithId:(NSString *)agentId name:(NSString *)agentName {
    NSURL *url = [NSURL URLWithString:[kBaseUrl stringByAppendingString:@"/api/agent/register"]]; // kBaseUrl ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    NSDictionary *body = @{
        @"agent_id": agentId,
        @"agent_name": agentName
    };
    NSError *error;
    NSData *bodyData = [NSJSONSerialization dataWithJSONObject:body 
                                                       options:0 
                                                         error:&error];
    if (error) {
        NSLog(@"JSONåºåˆ—åŒ–é”™è¯¯: %@", error);
        return;
    }
    [request setHTTPBody:bodyData];
    NSURLSession *session = [NSURLSession sharedSession];
    NSURLSessionDataTask *task = [session dataTaskWithRequest:request 
                                            completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
        if (error) {
            NSLog(@"Error: %@", error);
            return;
        }
        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;
        if (httpResponse.statusCode == 200) {
            NSError *jsonError;
            NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data 
                                                                 options:0 
                                                                   error:&jsonError];
            if (jsonError) {
                NSLog(@"JSONè§£æé”™è¯¯: %@", jsonError);
                return;
            }
            
            NSLog(@"æ³¨å†ŒAgentæˆåŠŸ: %@", json);
        } else {
            NSLog(@"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : %ld", (long)httpResponse.statusCode);
        }
    }];
    
    [task resume];
}
```
```javascript æœåŠ¡ç«¯å®ç°æ³¨å†Œæ™ºèƒ½ä½“é€»è¾‘
// æ³¨æ„ï¼šprocess.env. ä¸ºä»ç¯å¢ƒå˜é‡è¯»å–çš„å€¼ã€‚è¯·å‚è€ƒæœåŠ¡ç«¯ç¤ºä¾‹ä»£ç çš„ .env.example æ–‡ä»¶ã€‚
async registerAgent(agentId: string, agentName: string) {
    if (!process.env.LLM_BASE_URL || !process.env.LLM_API_KEY || !process.env.LLM_MODEL) {
        throw new Error('LLM_BASE_URL, LLM_API_KEY and LLM_MODEL environment variables must be set');
    }
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=RegisterAgent
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-configuration-management/register-agent
    const action = 'RegisterAgent';
    const body = {
        AgentId: agentId,
        Name: agentName,
        LLM: {
            Url: process.env.LLM_BASE_URL || "",
            ApiKey: process.env.LLM_API_KEY || "",
            Model: process.env.LLM_MODEL || "",
            // SystemPrompt: SYSTEM_PROMPT
        },
        TTS: {
            Vendor: "Bytedance",
            Params: {
                "app": {
                    "appid": process.env.TTS_BYTEDANCE_APP_ID || "",
                    "token": process.env.TTS_BYTEDANCE_TOKEN || "",
                    "cluster": process.env.TTS_BYTEDANCE_CLUSTER || ""
                },
                "speed_ratio": 1,
                "volume_ratio": 1,
                "pitch_ratio": 1,
                "emotion": "happy",
                "audio": {
                    "rate": 24000,
                    "voice_type": process.env.TTS_BYTEDANCE_VOICE_TYPE || ""
                }
            },
            FilterText: [{ BeginCharacters: "(", EndCharacters: ")" }, { BeginCharacters: "ï¼ˆ", EndCharacters: "ï¼‰" }, { BeginCharacters: "{", EndCharacters: "}" }],
        }
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    return this.sendRequest<any>(action, body);
}
```
</CodeGroup>
:::

:::if{props.platform="Web"}
<CodeGroup>
```javascript å®¢æˆ·ç«¯è°ƒç”¨æ³¨å†Œæ™ºèƒ½ä½“æ¥å£ {3,8-11}
async function registerAgent(agentId, agentName) {
  try {
    const response = await fetch(`${YOUR_SERVER_URL}/api/agent/register`, { // YOUR_SERVER_URL ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        agent_id: agentId,
        agent_name: agentName
      }),
    });
    
    const data = await response.json();
    console.log('æ³¨å†ŒAI Agentç»“æœ:', data);
    return data;
  } catch (error) {
    console.error('æ³¨å†ŒAI Agentå¤±è´¥:', error);
    throw error;
  }
}
```
```javascript æœåŠ¡ç«¯å®ç°æ³¨å†Œæ™ºèƒ½ä½“é€»è¾‘
// æ³¨æ„ï¼šprocess.env. ä¸ºä»ç¯å¢ƒå˜é‡è¯»å–çš„å€¼ã€‚è¯·å‚è€ƒæœåŠ¡ç«¯ç¤ºä¾‹ä»£ç çš„ .env.example æ–‡ä»¶ã€‚
async registerAgent(agentId: string, agentName: string) {
    if (!process.env.LLM_BASE_URL || !process.env.LLM_API_KEY || !process.env.LLM_MODEL) {
        throw new Error('LLM_BASE_URL, LLM_API_KEY and LLM_MODEL environment variables must be set');
    }
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=RegisterAgent
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-configuration-management/register-agent
    const action = 'RegisterAgent';
    const body = {
        AgentId: agentId,
        Name: agentName,
        LLM: {
            Url: process.env.LLM_BASE_URL || "",
            ApiKey: process.env.LLM_API_KEY || "",
            Model: process.env.LLM_MODEL || "",
            // SystemPrompt: SYSTEM_PROMPT
        },
        TTS: {
            Vendor: "Bytedance",
            Params: {
                "app": {
                    "appid": process.env.TTS_BYTEDANCE_APP_ID || "",
                    "token": process.env.TTS_BYTEDANCE_TOKEN || "",
                    "cluster": process.env.TTS_BYTEDANCE_CLUSTER || ""
                },
                "speed_ratio": 1,
                "volume_ratio": 1,
                "pitch_ratio": 1,
                "emotion": "happy",
                "audio": {
                    "rate": 24000,
                    "voice_type": process.env.TTS_BYTEDANCE_VOICE_TYPE || ""
                }
            },
            FilterText: [{ BeginCharacters: "(", EndCharacters: ")" }, { BeginCharacters: "ï¼ˆ", EndCharacters: "ï¼‰" }, { BeginCharacters: "{", EndCharacters: "}" }],
        }
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    return this.sendRequest<any>(action, body);
}
```
</CodeGroup>
:::

</Step>
<Step title="ç”¨æˆ·è¿›å…¥æˆ¿é—´å¹¶æ¨æµ">
çœŸå®ç”¨æˆ·ç™»å½•æˆ¿é—´åæ¨æµã€‚æ³¨æ„åœ¨æ­¤åœºæ™¯ä¸‹éœ€è¦å¼€å¯ AI é™å™ªå’Œ AI å›å£°æ¶ˆé™¤ä»¥è·å¾—æ›´å¥½çš„æ•ˆæœã€‚
ç™»å½•ç”¨çš„ token éœ€è¦ä»ä¸šåŠ¡åå°è·å–ï¼Œè¯·å‚è€ƒå®Œæ•´ç¤ºä¾‹ä»£ç ã€‚

<Note title="è¯´æ˜">
è¯·ç¡®ä¿ roomIDã€userIDã€streamID åœ¨ä¸€ä¸ª ZEGO APPID ä¸‹æ˜¯å”¯ä¸€çš„ã€‚
- roomID: ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰ç”Ÿæˆè§„åˆ™,ä¼šç”¨æ¥ç™»å½• Express SDK çš„æˆ¿é—´ã€‚ä»…æ”¯æŒæ•°å­—ï¼Œè‹±æ–‡å­—ç¬¦ å’Œ '~', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '_', '+', '=', '-', '`', ';', 'â€™', ',', '.', '\<', '\>', ''ã€‚å¦‚æœéœ€è¦ä¸ Web SDK äº’é€šï¼Œè¯·ä¸è¦ä½¿ç”¨ '%'ã€‚
- userID: é•¿åº¦ä¸è¶…è¿‡32å­—èŠ‚ã€‚ä»…æ”¯æŒæ•°å­—ï¼Œè‹±æ–‡å­—ç¬¦ å’Œ '~', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '_', '+', '=', '-', '`', ';', 'â€™', ',', '.', '\<', '\>', '\'ã€‚å¦‚æœéœ€è¦ä¸ Web SDK äº’é€šï¼Œè¯·ä¸è¦ä½¿ç”¨ '%'ã€‚
- streamID: é•¿åº¦ä¸è¶…è¿‡256å­—èŠ‚ã€‚ä»…æ”¯æŒæ•°å­—ï¼Œè‹±æ–‡å­—ç¬¦ å’Œ '-', '_'ã€‚
</Note>

:::if{props.platform=undefined}
```java å®¢æˆ·ç«¯ç™»å½•æˆ¿é—´å¹¶æ¨æµ {5,6,12-17,25,30}
private void loginRoom(String agentId, String userId, String userName, String token,
    IZegoRoomLoginCallback callback) {
    ZegoEngineConfig config = new ZegoEngineConfig();
    HashMap<String, String> advanceConfig = new HashMap<String, String>();
    advanceConfig.put("set_audio_volume_ducking_mode", "1");
    advanceConfig.put("enable_rnd_volume_adaptive", "true");
    config.advancedConfig = advanceConfig;
    ZegoExpressEngine.setEngineConfig(config);
    ZegoExpressEngine.getEngine().setRoomScenario(ZegoScenario.HIGH_QUALITY_CHATROOM);
    ZegoExpressEngine.getEngine().setAudioDeviceMode(ZegoAudioDeviceMode.GENERAL);

    // å¼€å¯ AI é™å™ªå’Œ AI å›å£°æ¶ˆé™¤
    ZegoExpressEngine.getEngine().enableAEC(true);
    ZegoExpressEngine.getEngine().setAECMode(ZegoAECMode.AI_AGGRESSIVE);
    ZegoExpressEngine.getEngine().enableAGC(true);
    ZegoExpressEngine.getEngine().enableANS(true);
    ZegoExpressEngine.getEngine().setANSMode(ZegoANSMode.AI_BALANCED);

    ZegoRoomConfig roomConfig = new ZegoRoomConfig();
    roomConfig.isUserStatusNotify = true;
    roomConfig.token = token;

    String roomId = generateRoomID(agentId);
    ZegoExpressEngine.getEngine()
        .loginRoom(roomId, new ZegoUser(userId, userName), roomConfig, (errorCode, extendedData) -> {
            Timber.d(
                "loginRoom() called with: errorCode = [" + errorCode + "], extendedData = [" + extendedData + "]");
            if (errorCode == 0) {
                String userSteamID = generateUserStreamID(agentId, userId);
                ZegoExpressEngine.getEngine().startPublishingStream(userSteamID);
                ZegoExpressEngine.getEngine().muteMicrophone(false);
            }
            if (callback != null) {
                callback.onRoomLoginResult(errorCode, extendedData);
            }

        });
}
```
:::
:::if{props.platform="iOS"}
```swift å®¢æˆ·ç«¯ç™»å½•æˆ¿é—´å¹¶æ¨æµ {9-11,17,20-24,35}
// è®°å½•æ™ºèƒ½ä½“
self.streamToPlay = [self getAgentStreamID];

ZegoEngineConfig* engineConfig = [[ZegoEngineConfig alloc] init];
engineConfig.advancedConfig = @{
    @"set_audio_dump_mode":@1,//å–æ¶ˆå½•åˆ¶æ–‡ä»¶å¤§å°é™åˆ¶
    @"notify_remote_device_unknown_status": @"true",
    @"notify_remote_device_init_status":@"true",
    @"enforce_audio_loopback_in_sync": @"true", /**è¯¥é…ç½®ç”¨æ¥åšåº”ç­”å»¶è¿Ÿä¼˜åŒ–çš„ï¼Œéœ€è¦é›†æˆå¯¹åº”ç‰ˆæœ¬çš„ZegoExpressEngine sdkï¼Œè¯·è”ç³»å³æ„åŒå­¦**/
    @"set_audio_volume_ducking_mode":@1,/**è¯¥é…ç½®æ˜¯ç”¨æ¥åšéŸ³é‡é—ªé¿çš„**/
    @"enable_rnd_volume_adaptive":@"true",/**è¯¥é…ç½®æ˜¯ç”¨æ¥åšæ’­æ”¾éŸ³é‡è‡ªé€‚ç”¨**/
};
[ZegoExpressEngine setEngineConfig:engineConfig];

//è¿™ä¸ªè®¾ç½®åªå½±å“AECï¼ˆå›å£°æ¶ˆé™¤ï¼‰ï¼Œæˆ‘ä»¬è¿™é‡Œè®¾ç½®ä¸ºModeGeneralï¼Œæ˜¯ä¼šèµ°æˆ‘ä»¬è‡ªç ”çš„å›å£°æ¶ˆé™¤ï¼Œè¿™æ¯”è¾ƒå¯æ§ï¼Œ
//å¦‚æœå…¶ä»–é€‰é¡¹ï¼Œå¯èƒ½ä¼šèµ°ç³»ç»Ÿçš„å›å£°æ¶ˆé™¤ï¼Œè¿™åœ¨iphoneæ‰‹æœºä¸Šæ•ˆæœå¯èƒ½ä¼šæ›´å¥½ï¼Œä½†å¦‚æœåœ¨ä¸€äº›androidæœºä¸Šæ•ˆæœå¯èƒ½ä¸å¥½
[[ZegoExpressEngine sharedEngine] setAudioDeviceMode:ZegoAudioDeviceModeGeneral];

//è¯·æ³¨æ„ï¼šå¼€å¯ AI é™å™ªå’Œ AI å›å£°æ¶ˆé™¤éœ€è¦è”ç³» ZEGO æŠ€æœ¯æ”¯æŒè·å–å¯¹åº”çš„ZegoExpressionEngine.xcframeworkï¼Œå…·å¤‡è¯¥èƒ½åŠ›çš„ç‰ˆæœ¬è¿˜æœªå‘å¸ƒ
[[ZegoExpressEngine sharedEngine] enableAGC:TRUE];
[[ZegoExpressEngine sharedEngine] enableAEC:TRUE];
[[ZegoExpressEngine sharedEngine] setAECMode:ZegoAECModeAIAggressive];
[[ZegoExpressEngine sharedEngine] enableANS:TRUE];
[[ZegoExpressEngine sharedEngine] setANSMode:ZegoANSModeAIBalanced];

// ç™»å½•æˆ¿é—´
[self loginRoom:^(int errorCode, NSDictionary *extendedData) {
    if (errorCode!=0) {
        NSString* errorMsg =[NSString stringWithFormat:@"è¿›å…¥è¯­éŸ³æˆ¿é—´å¤±è´¥:%d", errorCode];
        completion(NO, errorMsg);
        return;
    }
    
    //è¿›æˆ¿åå¼€å§‹æ¨æµ
    [self startPushlishStream];
}];
```
:::
:::if{props.platform="Web"}
```javascript å®¢æˆ·ç«¯ç™»å½•æˆ¿é—´å¹¶æ¨æµ {22-25}
const userId = "" // ç™»å½• Express SDKæˆ¿é—´ç”¨æˆ·ID
const roomId = "" // RTC æˆ¿é—´ ID
const userStreamId = "" // ç”¨æˆ·æ¨æµ ID
async function enterRoom() {
  try {
    // ç”Ÿæˆ RTC Token [å‚è€ƒæ–‡æ¡£]ï¼ˆhttps://doc-zh.zego.im/article/7646ï¼‰
    const token = await Api.getToken();
    // ç™»å½•æˆ¿é—´
    await zg.loginRoom(roomId, token, {
      userID: userId,
      userName: "",
    });

    // åˆ›å»ºæœ¬åœ°éŸ³é¢‘æµ
    const localStream = await zg.createZegoStream({
      camera: {
        video: false,
        audio: true,
      },
    });
    if (localStream) {
      // æ¨é€æœ¬åœ°æµ
      await zg.startPublishingStream(userStreamId, localStream);
      // å¼€å¯Aié™å™ªï¼ˆéœ€è¦ç‰¹æ®Šç¼–åŒ…çš„ ZEGO Express SDKï¼‰
      const enableResult = await zg.enableAiDenoise(localStream, true);
      if (enableResult.errorCode === 0) {
        return zg.setAiDenoiseMode(localStream, 1);
      }
    }
  } catch (error) {
    console.error("è¿›å…¥æˆ¿é—´å¤±è´¥:", error);
    throw error;
  }
}
enterRoom()
```
:::
</Step>
<Step title="åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹">
å¯ä»¥ç”¨å·²æ³¨å†Œçš„æ™ºèƒ½ä½“ä¸ºæ¨¡æ¿åˆ›å»ºå¤šä¸ªæ™ºèƒ½ä½“å®ä¾‹åŠ å…¥ä¸åŒæˆ¿é—´ä¸ä¸åŒç”¨æˆ·è¿›è¡Œå®æ—¶äº’åŠ¨ã€‚åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹åï¼Œæ™ºèƒ½ä½“å®ä¾‹ä¼šè‡ªåŠ¨ç™»å½•æˆ¿é—´å¹¶æ¨æµï¼ŒåŒæ—¶ä¹Ÿä¼šæ‹‰çœŸå®ç”¨æˆ·çš„æµã€‚

åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹æˆåŠŸåï¼ŒçœŸå®ç”¨æˆ·ç›‘å¬æµå˜åŒ–äº‹ä»¶å¹¶æ‹‰æµå°±å¯ä»¥ä¸æ™ºèƒ½ä½“è¿›è¡Œå®æ—¶äº’åŠ¨äº†ã€‚

ä»¥ä¸‹æ˜¯è°ƒç”¨ä¸šåŠ¡åå°æ¥å£å®ç°åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹çš„ç¤ºä¾‹ï¼š
:::if{props.platform=undefined}
<CodeGroup>
```java å®¢æˆ·ç«¯è°ƒç”¨åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹æ¥å£ {12-15}
public static void createAgentInstance(String agentId, String roomId, String userId, String userStreamId, 
                             String agentStreamId, String agentUserId) throws IOException {
    JSONObject json = new JSONObject();
    json.put("agent_id", agentId);
    json.put("room_id", roomId);
    json.put("user_id", userId);
    json.put("user_stream_id", userStreamId);
    json.put("agent_stream_id", agentStreamId);
    json.put("agent_user_id", agentUserId);
    
    RequestBody body = RequestBody.create(json.toString(), JSON);
    Request request = new Request.Builder()
            .url(YOUR_SERVER_URL + "/api/agent/create") // YOUR_SERVER_URL ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
            .post(body)
            .build();
    
    try (Response response = client.newCall(request).execute()) {
        // è¯·æ±‚è¿”å›æ•°æ®ç¤ºä¾‹ï¼š{code: 0, agent_instance_id: "new_instance_id", message: 'create agent instance success'}
        // agent_instance_id ç”¨äºåˆ é™¤æ™ºèƒ½ä½“å®ä¾‹
        System.out.println(response.body().string());
    }
}
```
```java å®¢æˆ·ç«¯æ‹‰æ™ºèƒ½ä½“çš„æµ {12-19}
// ç›‘å¬å›è°ƒ
void setEventHandler() {
        engine.setEventHandler(new IZegoEventHandler() {
            @Override
            // æˆ¿é—´å†…å…¶ä»–ç”¨æˆ·æ¨æµ/åœæ­¢æ¨æµæ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™é‡Œæ”¶åˆ°ç›¸åº”ç”¨æˆ·çš„éŸ³è§†é¢‘æµå¢å‡çš„é€šçŸ¥
            public void onRoomStreamUpdate(String roomID, ZegoUpdateType updateType, ArrayList<ZegoStream> streamList, JSONObject extendedData) {
                super.onRoomStreamUpdate(roomID, updateType, streamList, extendedData);
                //å½“ updateType ä¸º ZegoUpdateType.ADD æ—¶ï¼Œä»£è¡¨æœ‰éŸ³è§†é¢‘æµæ–°å¢ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è°ƒç”¨ startPlayingStream æ¥å£æ‹‰å–æ’­æ”¾è¯¥éŸ³è§†é¢‘æµ
                if (updateType == ZegoUpdateType.ADD) {
                    // å¼€å§‹æ‹‰æµï¼Œè®¾ç½®è¿œç«¯æ‹‰æµæ¸²æŸ“è§†å›¾ï¼Œè§†å›¾æ¨¡å¼é‡‡ç”¨ SDK é»˜è®¤çš„æ¨¡å¼ï¼Œç­‰æ¯”ç¼©æ”¾å¡«å……æ•´ä¸ª View
                    ZegoStream stream = streamList.get(0);
                    // åˆ¤æ–­æ˜¯å¦æ˜¯æ™ºèƒ½ä½“æµ
                    if (stream.streamID.equals(agentStreamID)) {
                        // å¦‚ä¸‹ remoteUserView ä¸º UI ç•Œé¢ä¸Šçš„ TextureView.
                        ZegoCanvas playCanvas = new ZegoCanvas(findViewById(R.id.remoteUserView));
                        ZegoExpressEngine.getEngine().startPlayingStream(agentStreamID, playCanvas);
                    }
                }
            }
        });
}
```
```javascript æœåŠ¡ç«¯å®ç°åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹é€»è¾‘
async createAgentInstance(agentId: string, userId: string, rtcInfo: RtcInfo, messages?: any[]) {
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=CreateAgentInstance
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-instance-management/create-agent-instance
    const action = 'CreateAgentInstance';
    const body = {
        AgentId: agentId,
        UserId: userId,
        RTC: rtcInfo,
        MessageHistory: {
            SyncMode: 1, // Change to 0 to use history messages from ZIM
            Messages: messages && messages.length > 0 ? messages : [],
            WindowSize: 10
        }
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    const result = await this.sendRequest<any>(action, body);
    console.log("create agent instance result", result);
    return result.AgentInstanceId;
}
```
</CodeGroup>
:::
:::if{props.platform="iOS"}
<CodeGroup>
```swift å®¢æˆ·ç«¯è°ƒç”¨åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹æ¥å£ {7,12-19}
+ (void)createAgentWithId:(NSString *)agentId
                   roomId:(NSString *)roomId
                   userId:(NSString *)userId
             userStreamId:(NSString *)userStreamId
           agentStreamId:(NSString *)agentStreamId
             agentUserId:(NSString *)agentUserId {
    NSURL *url = [NSURL URLWithString:[kBaseUrl stringByAppendingString:@"/api/agent/create"]]; // kBaseUrl ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    
    NSDictionary *body = @{
        @"agent_id": agentId,
        @"room_id": roomId,
        @"user_id": userId,
        @"user_stream_id": userStreamId,
        @"agent_stream_id": agentStreamId,
        @"agent_user_id": agentUserId
    };
    
    NSError *error;
    NSData *bodyData = [NSJSONSerialization dataWithJSONObject:body 
                                                       options:0 
                                                         error:&error];
    if (error) {
        NSLog(@"JSONåºåˆ—åŒ–é”™è¯¯: %@", error);
        return;
    }
    
    [request setHTTPBody:bodyData];
    
    NSURLSession *session = [NSURLSession sharedSession];
    NSURLSessionDataTask *task = [session dataTaskWithRequest:request 
                                            completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
        if (error) {
            NSLog(@"Error: %@", error);
            return;
        }
        
        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;
        if (httpResponse.statusCode == 200) {
            NSError *jsonError;
            NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data 
                                                                 options:0 
                                                                   error:&jsonError];
            if (jsonError) {
                NSLog(@"JSONè§£æé”™è¯¯: %@", jsonError);
                return;
            }
            
            NSLog(@"åˆ›å»ºAgentå®ä¾‹æˆåŠŸ: %@", json);
        } else {
            NSLog(@"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : %ld", (long)httpResponse.statusCode);
        }
    }];
    
    [task resume];
}
```

```objectivec å®¢æˆ·ç«¯æ‹‰æ™ºèƒ½ä½“çš„æµ {12}
//ç›‘å¬æˆ¿é—´æµä¿¡æ¯æ›´æ–°çŠ¶æ€ï¼Œæ‹‰å–æ™ºèƒ½ä½“æµæ’­æ”¾
- (void)onRoomStreamUpdate:(ZegoUpdateType)updateType
                streamList:(NSArray<ZegoStream *> *)streamList
              extendedData:(nullable NSDictionary *)extendedData
                    roomID:(NSString *)roomID{    
    if (updateType == ZegoUpdateTypeAdd) {
        for (int i=0; i<streamList.count; i++) {
            ZegoStream* item = [streamList objectAtIndex:i];
            
            if ([item.streamID isEqualToString: self.streamToPlay]) {
                NSLog(@"åŒ¹é…åˆ°ç›®æ ‡æµï¼Œå‡†å¤‡æ’­æ”¾: streamID=%@", self.streamToPlay);
                [self startPlayStream:self.streamToPlay];
                break;
            }
        }
    } else if(updateType == ZegoUpdateTypeDelete) {
        for (int i=0; i<streamList.count; i++) {
            ZegoStream* item = [streamList objectAtIndex:i];
            [[ZegoExpressEngine sharedEngine] stopPlayingStream:item.streamID];
        }
    }
}
```
```javascript æœåŠ¡ç«¯å®ç°åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹é€»è¾‘
async createAgentInstance(agentId: string, userId: string, rtcInfo: RtcInfo, messages?: any[]) {
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=CreateAgentInstance
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-instance-management/create-agent-instance
    const action = 'CreateAgentInstance';
    const body = {
        AgentId: agentId,
        UserId: userId,
        RTC: rtcInfo,
        MessageHistory: {
            SyncMode: 1, // Change to 0 to use history messages from ZIM
            Messages: messages && messages.length > 0 ? messages : [],
            WindowSize: 10
        }
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    const result = await this.sendRequest<any>(action, body);
    console.log("create agent instance result", result);
    return result.AgentInstanceId;
}
```
</CodeGroup>
:::
:::if{props.platform="Web"}
<CodeGroup>

```javascript å®¢æˆ·ç«¯è°ƒç”¨åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹æ¥å£ {3,8-16}
async function createAgentInstance(agentId, roomId, userId, userStreamId, agentStreamId, agentUserId, messages = []) {
  try {
    const response = await fetch(`${YOUR_SERVER_URL}/api/agent/create`, { // YOUR_SERVER_URL ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        agent_id: agentId,
        room_id: roomId,
        user_id: userId,
        user_stream_id: userStreamId,
        agent_stream_id: agentStreamId,
        agent_user_id: agentUserId,
        messages: messages
      }),
    });
    
    const data = await response.json();
    console.log('åˆ›å»ºAI Agentå®ä¾‹ç»“æœ:', data);
    return data;
  } catch (error) {
    console.error('åˆ›å»ºAI Agentå®ä¾‹å¤±è´¥:', error);
    throw error;
  }
}

```
```javascript å®¢æˆ·ç«¯æ‹‰æ™ºèƒ½ä½“çš„æµ {9}
// ç›‘å¬è¿œç«¯æµæ›´æ–°äº‹ä»¶
function setupEvent() {
  zg.on("roomStreamUpdate",
    async (roomID, updateType, streamList) => {
      if (updateType === "ADD" && streamList.length > 0) {
        try {
          for (const stream of streamList) {
            // æ‹‰æ™ºèƒ½ä½“æµ
            const mediaStream = await zg.startPlayingStream(stream.streamID);
            if (!mediaStream) return;
            const remoteView = await zg.createRemoteStreamView(mediaStream);
            if (remoteView) {
             // è¿™é‡Œéœ€è¦é¡µé¢ä¸Šæœ‰ä¸ªidä¸ºremoteSteamViewçš„å®¹å™¨æ¥æ”¶æ™ºèƒ½ä½“æµ [å‚è€ƒæ–‡æ¡£]ï¼ˆhttps://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~javascript_web~class~ZegoStreamViewï¼‰
              remoteView.play("remoteSteamView", {
                enableAutoplayDialog: false,
              });
            }
          }
        } catch (error) {
          console.error("æ‹‰æµå¤±è´¥:", error);
        }
      }
    }
  );
}
```
```javascript æœåŠ¡ç«¯å®ç°åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹é€»è¾‘
async createAgentInstance(agentId: string, userId: string, rtcInfo: RtcInfo, messages?: any[]) {
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=CreateAgentInstance
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-instance-management/create-agent-instance
    const action = 'CreateAgentInstance';
    const body = {
        AgentId: agentId,
        UserId: userId,
        RTC: rtcInfo,
        MessageHistory: {
            SyncMode: 1, // Change to 0 to use history messages from ZIM
            Messages: messages && messages.length > 0 ? messages : [],
            WindowSize: 10
        }
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    const result = await this.sendRequest<any>(action, body);
    console.log("create agent instance result", result);
    return result.AgentInstanceId;
}
```
</CodeGroup>
:::
æ­å–œä½ ğŸ‰ï¼å®Œæˆè¿™ä¸€æ­¥éª¤åï¼Œæ‚¨å·²ç»æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªæ™ºèƒ½ä½“å®ä¾‹ï¼Œå¹¶å¯ä»¥ä¸çœŸå®ç”¨æˆ·è¿›è¡Œå®æ—¶äº’åŠ¨äº†ã€‚æ‚¨å¯ä»¥ç”¨è¯­éŸ³é—®æ™ºèƒ½ä½“ä»»ä½•é—®é¢˜ï¼Œæ™ºèƒ½ä½“éƒ½ä¼šç”¨è¯­éŸ³å›ç­”æ‚¨çš„é—®é¢˜ï¼
</Step>
<Step title="ç”¨æˆ·é€€å‡ºæˆ¿é—´å¹¶åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹">
åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹åï¼Œæ™ºèƒ½ä½“å®ä¾‹ä¼šè‡ªåŠ¨é€€å‡ºæˆ¿é—´å¹¶åœæ­¢æ¨æµã€‚ç”¨æˆ·å†åœæ­¢æ¨æµå’Œé€€å‡ºæˆ¿é—´åï¼Œä¸€æ¬¡å®Œæ•´çš„äº’åŠ¨å°±ç»“æŸäº†ã€‚

ä»¥ä¸‹æ˜¯è°ƒç”¨ä¸šåŠ¡åå°æ¥å£å®ç°åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹çš„ç¤ºä¾‹ï¼š
:::if{props.platform=undefined}
<CodeGroup>
```java å®¢æˆ·ç«¯è°ƒç”¨åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹æ¥å£ {6-10,14,15}
// agentInstanceId åœ¨åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹æ¥å£è¿”å›
public static void deleteAgentInstance(String agentInstanceId) throws IOException {
    JSONObject json = new JSONObject();
    json.put("agent_instance_id", agentInstanceId);
    
    RequestBody body = RequestBody.create(json.toString(), JSON);
    Request request = new Request.Builder()
            .url(YOUR_SERVER_URL + "/api/agent/delete") // YOUR_SERVER_URL ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
            .post(body)
            .build();
    
    try (Response response = client.newCall(request).execute()) {
        System.out.println(response.body().string());
        ZegoExpressEngine.getEngine().logoutRoom();
        ZegoExpressEngine.destroyEngine(null);
    }
}
```
```javascript æœåŠ¡ç«¯å®ç°åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹é€»è¾‘
async deleteAgentInstance(agentInstanceId: string) {
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=DeleteAgentInstance
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-instance-management/delete-agent-instance
    const action = 'DeleteAgentInstance';
    const body = {
        AgentInstanceId: agentInstanceId
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    return this.sendRequest(action, body);
}
```
</CodeGroup>
:::
:::if{props.platform="iOS"}
<CodeGroup>
```swift å®¢æˆ·ç«¯è°ƒç”¨åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹æ¥å£ {4,8-10,43-46}
// agentInstanceId åœ¨åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹æ¥å£è¿”å›
// 3. åˆ é™¤AI Agentå®ä¾‹
+ (void)deleteAgentWithInstanceId:(NSString *)agentInstanceId {
    NSURL *url = [NSURL URLWithString:[kBaseUrl stringByAppendingString:@"/api/agent/delete"]]; // kBaseUrl ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    NSDictionary *body = @{
        @"agent_instance_id": agentInstanceId
    };
    NSError *error;
    NSData *bodyData = [NSJSONSerialization dataWithJSONObject:body 
                                                       options:0 
                                                         error:&error];
    if (error) {
        NSLog(@"JSONåºåˆ—åŒ–é”™è¯¯: %@", error);
        return;
    }
    [request setHTTPBody:bodyData];
    NSURLSession *session = [NSURLSession sharedSession];
    NSURLSessionDataTask *task = [session dataTaskWithRequest:request 
                                            completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
        if (error) {
            NSLog(@"Error: %@", error);
            return;
        }
        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;
        if (httpResponse.statusCode == 200) {
            NSError *jsonError;
            NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data 
                                                                 options:0 
                                                                   error:&jsonError];
            if (jsonError) {
                NSLog(@"JSONè§£æé”™è¯¯: %@", jsonError);
                return;
            }
            
            NSLog(@"åˆ é™¤Agentå®ä¾‹æˆåŠŸ: %@", json);
            if ([ZegoExpressEngine sharedEngine] == nil) {
                return;
            }
    
            [[ZegoExpressEngine sharedEngine] stopPlayingStream:self.streamToPlay];
            [[ZegoExpressEngine sharedEngine] stopPublishingStream];
            [[ZegoExpressEngine sharedEngine] logoutRoomWithCallback:nil];
            [ZegoExpressEngine destroyEngine:nil];
        } else {
            NSLog(@"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : %ld", (long)httpResponse.statusCode);
        }
    }];
    
    [task resume];
}
```
```javascript æœåŠ¡ç«¯å®ç°åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹é€»è¾‘
async deleteAgentInstance(agentInstanceId: string) {
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=DeleteAgentInstance
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-instance-management/delete-agent-instance
    const action = 'DeleteAgentInstance';
    const body = {
        AgentInstanceId: agentInstanceId
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    return this.sendRequest(action, body);
}
```
</CodeGroup>
:::
:::if{props.platform="Web"}
<CodeGroup>
```javascript å®¢æˆ·ç«¯è°ƒç”¨åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹æ¥å£ {4,10,17-22}
// agentInstanceId åœ¨åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹æ¥å£è¿”å›
async function deleteAgentInstance(agentInstanceId) {
  try {
    const response = await fetch(`${YOUR_SERVER_URL}/api/agent/delete`, { // YOUR_SERVER_URL ä¸ºæ‚¨çš„ä¸šåŠ¡åå°åœ°å€
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        agent_instance_id: agentInstanceId
      }),
    });
    
    const data = await response.json();
    console.log('åˆ é™¤AI Agentå®ä¾‹ç»“æœ:', data);

    // é”€æ¯æœ¬åœ°æµ
    await zg.destroyStream(localStream);
    // é€€å‡ºæˆ¿é—´
    await zg.logoutRoom(roomId);
    // é”€æ¯Expresså¼•æ“
    zg.destroyEngine();
  } catch (error) {
    console.error('åˆ é™¤AI Agentå®ä¾‹å¤±è´¥:', error);
    throw error;
  }
}
```
```javascript æœåŠ¡ç«¯å®ç°åˆ é™¤æ™ºèƒ½ä½“å®ä¾‹é€»è¾‘
async deleteAgentInstance(agentInstanceId: string) {
    // è¯·æ±‚æ¥å£ï¼šhttps://aigc-aiagent-api.zegotech.cn?Action=DeleteAgentInstance
    // æ–‡æ¡£è¯´æ˜ï¼šhttps://doc-zh.zego.im/aiagent-server/agent-instance-management/delete-agent-instance
    const action = 'DeleteAgentInstance';
    const body = {
        AgentInstanceId: agentInstanceId
    };
    // sendRequest æ–¹æ³•å°è£…äº†è¯·æ±‚çš„ URL å’Œå…¬å…±å‚æ•°ã€‚è¯¦æƒ…å‚è€ƒï¼šhttps://doc-zh.zego.im/aiagent-server/accessing-server-apis
    return this.sendRequest(action, body);
}
```
</CodeGroup>
:::
</Step>
</Steps>

ä»¥ä¸Šå°±æ˜¯æ‚¨å®ç°ä¸æ™ºèƒ½ä½“è¿›è¡Œå®æ—¶è¯­éŸ³äº’åŠ¨çš„å®Œæ•´æ ¸å¿ƒæµç¨‹ã€‚
