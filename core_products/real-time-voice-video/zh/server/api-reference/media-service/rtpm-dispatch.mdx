---
id: rtpm-dispatch
title: "RTMPDispatchV2"
description: "调用本接口可以发起 RTMP 推拉流调度，支持 'pull' 和 'push' 两种调度模式。"
api: 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
info_path: core_products/real-time-voice-video/zh/server/api-reference/media-service/open-api-desc
---

<h1 className={"openapi__heading"}>RTMPDispatchV2</h1>

<MethodEndpoint method={"get"} path={"/"}></MethodEndpoint>


调用本接口可以发起 RTMP 推拉流调度，支持 "pull" 和 "push" 两种调度模式。

当您需要自行通过 RTMP 协议，从 ZEGO 音视频云进行直播流的推流或拉流时，可以通过本接口获取 RTMP 的推流或拉流节点。开发者在客户端传入流 ID（StreamId）、调度模式（Type）、客户端 IP（ClientIP）和序列号（Sequence）后，ZEGO 媒体服务器（RTC 服务）返回调度结果集，供客户推拉流。

例如，当通过 OBS 等第三方推流工具进行 RTMP 推流时，需要进行推流调度；当需要第三方播放器拉 RTMP 流进行播放时，需要进行拉流调度。

<Warning title="注意">
首次使用本接口，需要联系 ZEGO 技术支持进行配置。
</Warning>
<Note title="调用频率限制">同一个 AppID 下：40 次/秒</Note>
## 旧版接口使用说明

<Accordion title="使用 RTMPDispatch 访问 ZEGO 服务端" defaultOpen="false">
<Note title="说明">

**RTMPDispatchV2（推荐）** 和 **RTMPDispatch** 的区别是，访问 ZEGO 服务端时：

- 使用的是 `RTMPDispatchV2`，ZEGO 服务端返回的 Data 数据为 URL 形式。
- 使用的是 `RTMPDispatch`，ZEGO 服务端返回的 Data 数据为 IP Port 形式。

</Note>

请求地址：`https://rtc-api.zego.im/?Action=RTMPDispatch`

响应示例：

```json
{
    "Code":0,
    "Message":"ok",
    "RequestId":"5094436160208407316",
    "Data":[
        "81.69.49.115:1935"
    ]
}
```
</Accordion>
<br/>

<Note title="说明">
测试环境下（详见 IsTest 公共参数说明），流 ID 需要加上 "zegotest-AppId-" 前缀。例如，流 ID 为 "test"，在 AppId 为 "123456789" 的测试环境下，流 ID 应为 "zegotest-123456789-test"。
</Note>

## Request
<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Query Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"name":"Action","in":"query","description":"> 接口原型参数\n>\n> https://rtc-api.zego.im?Action=RTMPDispatchV2\n","required":true,"schema":{"type":"string","enum":["RTMPDispatchV2"]},"style":"form","explode":true}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"AppId","in":"query","description":"💡公共参数。AppId，ZEGO 分配的用户唯一凭证。","required":true,"schema":{"type":"integer","format":"uint32"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureNonce","in":"query","description":"💡公共参数。随机字符串。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Timestamp","in":"query","description":"💡公共参数。Unix 时间戳，单位为秒。最多允许 10 分钟的误差。","required":true,"schema":{"type":"integer","format":"int64"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Signature","in":"query","description":"💡公共参数。签名，用于验证请求的合法性。请参考[签名机制](/real-time-video-server/api-reference/accessing-server-apis#签名机制)生成。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureVersion","in":"query","description":"💡公共参数。签名版本号。","required":true,"schema":{"type":"string","default":"2.0","enum":["2.0"]}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"IsTest","in":"query","description":"💡公共参数。是否为测试环境。设为 true 表示使用测试环境。\n2021-11-16 及之前在 ZEGO 控制台 创建的项目默认是测试环境，可根据业务需求设置此参数；而之后创建的项目默认是正式环境。\n> ⚠️注意：测试环境跟正式环境是隔离的，请不要在操作正式环境 appid 时误把该参数标记为 true。2021-11-16 及之后创建的项目建议**不要填写该参数**。\n>\n> 📌是否必填参数：2021-11-16 及之前在 [ZEGO 控制台](https://console.zego.im)创建的项目为**必填**，之后创建的则不是必填。\n","required":false,"schema":{"type":"string","enum":["false","true"],"default":"false"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"StreamId","in":"query","required":true,"schema":{"type":"string"},"description":"流 ID，长度不超过 256 的字符串。\n- 流 ID 由您自己定义。\n- 在推流时，需要在整个 AppID 内全局唯一，若出现在同一个 AppID 内，不同的用户各推了一条流且流名相同，将会导致后推流的用户推流失败。\n- 仅支持数字，英文字符 和 '-', '_'。\n"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Sequence","in":"query","required":true,"schema":{"type":"Int64"},"description":"请求序列号；仅用于请求对帐，推荐使用时间戳（毫秒级别）。"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Type","in":"query","required":true,"schema":{"type":"string"},"description":"调度模式：\n- pull：获取 RTMP 的拉流节点\n- push：获取 RTMP 的推流节点\n"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"ClientIP","in":"query","required":false,"schema":{"type":"string"},"description":"非必选，如有，则传入客户端 IP 地址，例如：119.23.242.129。\n\n> **注意**\n>\n> 当前不支持 IPv6 格式的 IP 地址。\n"}}></ParamsItem></ul></div></details>
<div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>成功</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><ul className={"response-schema-first-body-node-container"}><SchemaItem collapsible={false} name={"Code"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"integer","format":"number","description":"返回码。\n以下仅列出了接口业务逻辑相关的部分返回码，完整返回码请参考 [全局返回码](/real-time-video-server/api-reference/return-codes)。\n<table>\n  <thead>\n    <tr><th>返回码</th><th>说明</th><th>处理建议</th></tr>\n  </thead>\n  <tbody>\n    <tr><td>1010、30002</td><td>接口调用频率过高。</td><td>请降低接口请求频率。</td></tr>\n    <tr><td>1001</td><td>调度失败。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1002</td><td>推流节点为空。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1003</td><td>拉流节点为空。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1005</td><td>App 不在线。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1006</td><td>无效参数。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>30003</td><td>内部错误。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>30004</td><td>参数 isTest 错误。</td><td>请检查公共请求参数 isTest 是否正确。</td></tr>\n    <tr><td>30005</td><td>无效的 AppId。</td><td>请检查 AppId 是否正确。</td></tr>\n    <tr><td>30009</td><td>无效的 StreamId，流名不规范。</td><td>请检查 StreamId 是否符合流名编码规范。</td></tr>\n    <tr><td>30010</td><td>无效的调度动作。</td><td>请检查 Type 是否正确。</td></tr>\n    <tr><td>30011</td><td>无效的客户端 IP 地址。</td><td>请检查 ClientIP 是否正确。</td></tr>\n  </tbody>\n</table>\n","example":0}}></SchemaItem><SchemaItem collapsible={false} name={"Message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"操作结果描述","example":"ok"}}></SchemaItem><SchemaItem collapsible={false} name={"RequestId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"请求 ID","example":"5094436160208407316"}}></SchemaItem><SchemaItem collapsible={false} name={"Data"} required={false} schemaName={"object"} qualifierMessage={undefined} schema={{"type":"object","description":"RTMP 推流或拉流节点。\n\n> **说明**\n>\n> 获取此节点后，请在 2 小时内发起推流或拉流，否则可能导致节点被占用或下线。因此，建议每次进行 RTMP 推拉流时，都调用本接口获得最新的节点。\n","example":["rtmp://81.69.49.115:1935/1540531164/caodantest"]}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"Code\": 0,\n  \"Message\": \"ok\",\n  \"RequestId\": \"5094436160208407316\",\n  \"Data\": [\n    \"rtmp://81.69.49.115:1935/1540531164/caodantest\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      