openapi: 3.0.0
info:
  title: open-api-desc
  version: 1.0.0
  contact:
    name: Real-time Voice/Video API Support
    email: support@zegocloud.com

tags:
  - name: room

servers:
  $ref: '../shared-components.yaml#/servers'

paths:
  /:
    get:
      tags:
        - room
      summary: AddStream
      description: |
        è°ƒç”¨æœ¬æ¥å£å¯å‘æŒ‡å®šæˆ¿é—´å¢åŠ ä¸€è·¯æµã€‚å¤šç”¨äºâ€œä¸€èµ·çœ‹â€åœºæ™¯ï¼Œæ¯”å¦‚å°† CDN çš„ç›´æ’­æµæ·»åŠ åˆ°æŒ‡å®šæˆ¿é—´ï¼Œä»è€Œè®©æˆ¿é—´å†…çš„ç”¨æˆ·è·å–æµ IDï¼Œå®ç°æœåŠ¡ç«¯æ§åˆ¶æŒ‡å®šæˆ¿é—´çš„ç›´æ’­å†…å®¹ã€‚

        <Warning title="æ³¨æ„">
        - å¾€æŒ‡å®šæˆ¿é—´å¢åŠ æµæ—¶éœ€è¦ä¿è¯è¯¥æˆ¿é—´æ˜¯å­˜åœ¨çš„ï¼Œæœ¬æ¥å£æ— æ³•åˆ›å»ºæˆ¿é—´ã€‚è‹¥æ‚¨å¸Œæœ›å¢åŠ æµæ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºå¯¹åº”æˆ¿é—´ï¼Œè¯·è”ç³» ZEGO æŠ€æœ¯æ”¯æŒå¼€å¯ç›¸å…³åŠŸèƒ½ã€‚
        - æœ¬æ¥å£ä¸€èˆ¬ä¸ [åˆ é™¤æˆ¿é—´æµ](/real-time-video-server/api-reference/room/delete-stream) é…åˆä½¿ç”¨ï¼Œæ¯”å¦‚ä¸šåŠ¡ä¸Šéœ€è¦åœæ­¢å‘æŸä¸ªæˆ¿é—´å¹¿æ’­æµã€‚
        </Warning>

        æœ¬æ¥å£ä»…ç”¨äºæŠ›å‡ºæˆ¿é—´å†…æµå¢åŠ çš„ç›¸å…³é€šçŸ¥ï¼Œä¸ä¼šæ‰§è¡Œå®é™…çš„æ¨æµæ“ä½œã€‚å¼€å‘è€…éœ€è¦ä»è‡ªå·±çš„å®¢æˆ·ç«¯ï¼Œè°ƒç”¨ `startPublishingStream` æ¥å£è¿›è¡Œæ¨æµï¼ˆæˆ–å…¶å®ƒçš„æ¨æµæ–¹å¼ï¼‰ï¼Œè¯¥æ¡è¢«å¢åŠ çš„æµæ‰èƒ½è¢« `startPlayingStream` æ¥å£æ‹‰æµåˆ°ã€‚

        å®¢æˆ·ç«¯æ¥æ”¶æˆ¿é—´å†…æµå¢åŠ çš„é€šçŸ¥ä½¿ç”¨ ZEGO SDK å›è°ƒæ¥å£ï¼š

        | |ZegoExpress SDK|LiveRoom SDK|
        |-|-|-|
        |iOS/macOS| onRoomStreamUpdate | onStreamUpdated |
        |Android| onRoomStreamUpdate | onStreamUpdated |
        |Windows| onRoomStreamUpdate |  OnStreamUpdated |
        |Web| roomStreamUpdate | onStreamUpdated |

        <Note title="è°ƒç”¨é¢‘ç‡é™åˆ¶">åŒä¸€ä¸ª AppID ä¸‹æ‰€æœ‰æˆ¿é—´ï¼š10 æ¬¡/ç§’ï¼ˆæµ‹è¯•ç¯å¢ƒï¼š1 æ¬¡/ç§’ï¼‰</Note>
        <Warning title="æ³¨æ„">
        - ä¸å»ºè®®ä½¿ç”¨ä¸æˆ¿é—´å†…å®é™…ç”¨æˆ·ç›¸åŒçš„ UserIdï¼Œé¿å…ä¸å®¢æˆ·ç«¯ SDK çš„æµæ–°å¢è¡Œä¸ºäº§ç”Ÿå†²çªã€‚å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„åç§°æ ‡è¯†ä¸ºæœåŠ¡ç«¯è¡Œä¸ºï¼Œä¾‹å¦‚ï¼šuserId = â€œServer-Administratorâ€ã€‚
        - å¦‚æœä½¿ç”¨äº†ä¸æˆ¿é—´å†…å®é™…ç”¨æˆ·ç›¸åŒçš„ UserIdï¼ˆä¸å»ºè®®ï¼‰æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹äº‹é¡¹ï¼š
          - ç›¸åº”æ“ä½œäºº UserId çš„å®¢æˆ·ç«¯ä¸ä¼šæ”¶åˆ°æœ¬æœåŠ¡ç«¯æ¥å£è§¦å‘çš„æµå¢åŠ å›è°ƒã€‚
          - å¦‚æœå®é™…æˆ¿é—´å†…ç”¨æˆ· UserId æ²¡æœ‰æ¨æµï¼Œä¼šè§¦å‘ç›¸åº” StreamId çš„æµåˆ é™¤é€»è¾‘ã€‚
          - å¦‚æœå®é™…æˆ¿é—´å†…ç”¨æˆ· UserId é€€å‡ºæˆ¿é—´ï¼Œä¼šè§¦å‘ç›¸åº” StreamId çš„æµåˆ é™¤é€»è¾‘ã€‚
        </Warning>

      operationId: add-stream
      parameters:
        - name: Action
          in: query
          description: |
            > æ¥å£åŸå‹å‚æ•°
            >
            > https://rtc-api.zego.im?Action=AddStream
          required: true
          allowEmptyValue: false
          schema:
            type: string
            enum: [AddStream]
          style: form
          explode: true
        # å…¬å…±å‚æ•°
        - $ref: '../shared-components.yaml#/components/parameters/AppId'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureNonce'
        - $ref: '../shared-components.yaml#/components/parameters/Timestamp'
        - $ref: '../shared-components.yaml#/components/parameters/Signature'
        - $ref: '../shared-components.yaml#/components/parameters/SignatureVersion'
        - $ref: '../shared-components.yaml#/components/parameters/IsTest'
        # ä¸šåŠ¡å‚æ•°
        - name: RoomId
          in: query
          description: æˆ¿é—´ IDã€‚
          required: true
          schema:
            type: string
        - name: UserId
          in: query
          description: ç”¨æˆ· IDã€‚
          required: true
          schema:
            type: string
        - name: UserName
          in: query
          description: ç”¨æˆ·åã€‚
          required: false
          schema:
            type: string
        - name: StreamId
          in: query
          description: æµ IDï¼Œä¸è¶…è¿‡ 256 å­—èŠ‚ã€‚
          required: true
          schema:
            type: string
            maxLength: 256
        - name: StreamTitle
          in: query
          description: |
            æµæ ‡é¢˜ï¼Œä¸è¶…è¿‡ 127 å­—èŠ‚ã€‚
            ä½¿ç”¨æ—¶ï¼Œè¯·å¯¹è¯¥å‚æ•°å†…å®¹è¿›è¡Œ UrlEncodeã€‚
          required: false
          schema:
            type: string
            maxLength: 127
        - name: ExtraInfo
          in: query
          description: æµé™„åŠ ä¿¡æ¯ï¼Œä¸è¶…è¿‡ 1024 å­—èŠ‚ã€‚
          required: false
          schema:
            type: string
            maxLength: 1024
        - name: CensorFlag
          in: query
          description: |
            æ˜¯å¦å…è®¸é€å®¡æ ‡è¯†ã€‚å®¡æ ¸æˆ¿é—´æµåˆ—è¡¨æ—¶ï¼Œå½“å‰æµæ˜¯å¦å…è®¸å®¡æ ¸ï¼š0 è¡¨ç¤ºå…è®¸ï¼Œ1 è¡¨ç¤ºä¸å…è®¸ã€‚
            > **ğŸ“Œ é‡è¦è¯´æ˜**
            >
            > - å½“è®¾ç½®ä¸ºä¸å…è®¸é€å®¡æ—¶ï¼Œå®¡æ ¸æœåŠ¡å•†å°†ä¸ä¼šæ‹‰å–æ­¤æ¡æµé€å®¡ã€‚
            >
            > - åœ¨ä½¿ç”¨æµæ³¨å…¥æ–¹å¼å®ç°è·¨æˆ¿é—´ PK çš„ä¸šåŠ¡åœºæ™¯æ—¶ï¼Œå»ºè®®å°†æ­¤å­—æ®µè®¾ç½®ä¸º"ä¸å…è®¸"ï¼Œä»¥é¿å…åŒä¸€æ¡æµåœ¨å¤šä¸ªæˆ¿é—´å†…è¢«é‡å¤é€å®¡ã€‚
          required: false
          schema:
            type: integer
            format: int32
            enum: [0, 1]
            default: 0
      responses:
        "200":
          description: æ“ä½œæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AddStreamResponse'

components:
  schemas:
    AddStreamResponse:
      type: object
      properties:
        Code:
          type: integer
          format: int32
          example: 0
          description: |
            è¿”å›ç ã€‚ä»¥ä¸‹ä»…åˆ—å‡ºäº†æ¥å£ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„éƒ¨åˆ†è¿”å›ç ï¼Œå®Œæ•´è¿”å›ç è¯·å‚è€ƒ [å…¨å±€è¿”å›ç ](/real-time-video-server/api-reference/return-codes)ã€‚

            <table>
              <thead>
                <tr>
                  <th>è¿”å›ç </th>
                  <th>è¯´æ˜</th>
                  <th>å¤„ç†å»ºè®®</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>123</td>
                  <td>è®¾ç½®æµä¿¡æ¯å¤±è´¥ã€‚</td>
                  <td>è¯·é‡è¯•ï¼Œæˆ–è”ç³» ZEGO æŠ€æœ¯æ”¯æŒå¤„ç†ã€‚</td>
                </tr>
                <tr>
                  <td>1012</td>
                  <td>å¤šä¸ªç”¨æˆ·æ“ä½œåŒä¸€ä¸ªæµã€‚</td>
                  <td>è¯·æ£€æŸ¥é€»è¾‘ã€‚</td>
                </tr>
              </tbody>
            </table>
        Message:
          type: string
          example: success
          description: æ“ä½œç»“æœæè¿°ã€‚
        RequestId:
          type: string
          example: 4443515903608307334
          description: è¯·æ±‚ IDã€‚

