---
articleID: 6644
date: "2024-01-02"
---
# Network Speed Test

- - -

## Feature Overview

ZEGO provides network speed test functionality, which can detect uplink and downlink network speeds before users publish/play streams, to determine the bitrate of audio and video streams suitable for publishing/playing under current network conditions.


When the uplink speed test results show a high packet loss rate, it is recommended to use methods such as lowering resolution or lowering frame rate to reduce the publish stream bitrate to ensure normal publishing; when the downlink speed test results show a high packet loss rate, it is recommended to use the [Layered Video Encoding](/real-time-video-android-java/video/set-video-encoding) feature provided by the SDK to play low-bitrate streams to ensure normal playing.

When the following situations occur in developers' business, ZEGO recommends using the SDK's network speed test feature:

- In call scenarios, network quality assessment needs to be performed.

- In education scenarios, pre-class network detection needs to be performed.

- In live streaming scenarios, network connection speed testing needs to be performed.



The basic principle of network speed test is shown in the following figure:

<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/Common/ZegoExpressEngine/Network_speed_test.png" /></Frame>

## Example Source Code Download

Please refer to [Download Example Source Code](/real-time-video-android-java/quick-start/run-example-code) to get the source code.

For related source code, please check the files in the "/ZegoExpressExample/Others/src/main/java/im/zego/others/networkandperformance" directory.

## Prerequisites

Before implementing the network speed test feature, please ensure:

- You have created a project in the [ZEGO Console](https://console.zego.im) and applied for a valid AppID and AppSign. For details, please refer to [Console - Project Information](/console/project-info).
- You have integrated ZEGO Express SDK in your project and implemented basic audio and video streaming functionality. For details, please refer to [Quick Start - Integration](/real-time-video-android-java/quick-start/integrating-sdk) and [Quick Start - Implementation](/real-time-video-android-java/quick-start/implementing-video-call).


## Usage Steps

### 1 Listen for speed test callbacks

Before starting the speed test, you can first set speed test related callbacks.

- In normal speed test situations, the [onNetworkSpeedTestQualityUpdate](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-callback-i-zego-event-handler#on-network-speed-test-quality-update) callback will be triggered when network speed quality updates.

- When an error occurs during the speed test process, the [onNetworkSpeedTestError](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-callback-i-zego-event-handler#on-network-speed-test-error) callback will be triggered.


```java
// Set speed test related callbacks
ZegoExpressEngine.getEngine().setEventHandler(new IZegoEventHandler() {
    @Override
    // Network speed test quality callback
    public void onNetworkSpeedTestQualityUpdate(ZegoNetworkSpeedTestQuality quality, ZegoNetworkSpeedTestType type) {

    }

    @Override
    // Network speed test exception callback
    public void onNetworkSpeedTestError(int errorCode, ZegoNetworkSpeedTestType type) {

    }
});
```

### 2 Start speed test

Create an instance of [ZegoNetworkSpeedTestConfig](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-entity-zego-network-speed-test-config) network speed test configuration, set whether to perform uplink and downlink speed tests and expected bitrate according to the actual situation, and call the [startNetworkSpeedTest](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-zego-express-engine#start-network-speed-test) interface to enable network speed test.

<Note title="Note">


After calling the [startNetworkSpeedTest](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-zego-express-engine#start-network-speed-test) interface to enable speed test, it supports speed test for 30 seconds by default (if you need to adjust the duration, please contact ZEGO Technical Support to modify the dynamic configuration). After timeout, the speed test will be forcibly ended. If you need to continue the speed test, please call this interface again.
</Note>



```java
ZegoNetworkSpeedTestConfig config =new ZegoNetworkSpeedTestConfig();

// Perform uplink speed test, specify expected publish stream bitrate
config.testUplink = true;
config.expectedUplinkBitrate = ZegoExpressEngine.getEngine().getVideoConfig().bitrate;

// Perform downlink speed test, specify expected play stream bitrate
config.testDownlink = true;
config.expectedDownlinkBitrate = ZegoExpressEngine.getEngine().getVideoConfig().bitrate;

// Start speed test, default callback interval is 3 seconds
engine.startNetworkSpeedTest(config);

// If you need to set callback interval, you can refer to the following call (take 1.5 seconds as an example)
engine.startNetworkSpeedTest(config, 1500);
```

The speed test results will be returned in the network speed test quality [ZegoNetworkSpeedTestQuality](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-entity-zego-network-speed-test-quality) in [onNetworkSpeedTestQualityUpdate](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-callback-i-zego-event-handler#on-network-speed-test-quality-update). By analyzing each parameter value, you can know whether the current network quality is good.

The parameters in [ZegoNetworkSpeedTestQuality](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-entity-zego-network-speed-test-quality) are as follows:

<table>

<tbody><tr>
<th>Parameter</th>
<th>Description</th>
<th>Explanation</th>
</tr>
<tr>
<td>connectCost</td>
<td>Time to connect to server, in milliseconds.</td>
<td>If the network connection is disconnected during the speed test process, it will automatically reconnect. This variable will be updated accordingly. The smaller the value, the better.</td>
</tr>
<tr>
<td>rtt</td>
<td>Network latency, in milliseconds.</td>
<td>Represents the time consumed between the SDK and the server round trip. The smaller the value, the better.</td>
</tr>
<tr>
<td>packetLostRate</td>
<td>Packet loss rate, in percentage.</td>
<td>The value range is 0.0 - 1.0. For example, 0.5 means that out of every 10 packets sent to the server, 5 may be lost on the way.</td>
</tr>
<tr>
<td>
quality
</td>
<td>
Network quality
</td>
<td>
Represents the current network quality level. For details, please refer to [ZegoStreamQualityLevel](@-ZegoStreamQualityLevel).
<ul>
<li>
ZegoStreamQualityLevel.EXCELLENT: Excellent quality.
</li>
<li>
ZegoStreamQualityLevel.GOOD: Good quality.
</li>
<li>
ZegoStreamQualityLevel.MEDIUM: Normal quality.
</li>
<li>
ZegoStreamQualityLevel.BAD: Poor quality.
</li>
<li>
ZegoStreamQualityLevel.DIE: Abnormal quality.
</li>
<li>
ZegoStreamQualityLevel.UNKNOWN: Unknown quality.
</li>
</ul>
</td>
</tr>
</tbody></table>

### 3 Stop speed test

Call the [stopNetworkSpeedTest](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-zego-express-engine#stop-network-speed-test) interface to stop network speed test.

After stopping the speed test, you will no longer receive [onNetworkSpeedTestQualityUpdate](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-callback-i-zego-event-handler#on-network-speed-test-quality-update) or [onNetworkSpeedTestError](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~Java_android~class~im-zego-zegoexpress-callback-i-zego-event-handler#on-network-speed-test-error) callbacks.

```java
engine.stopNetworkSpeedTest();
```
