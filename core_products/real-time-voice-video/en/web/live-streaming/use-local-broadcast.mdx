---
articleID: 18341
---
# Use Local Broadcast

- - -

## Feature Overview


With the development of real-time interaction, video interaction is no longer limited to single camera images. Screen sharing images, multi-camera images, fun accessories, product information, etc. have become content that more and more live rooms or users need to display.

ZEGO's local broadcast plugin supports mixing images and sounds locally, merging multiple audio and video streams or page elements into a single audio and video stream for stream publishing, helping developers implement richer scenarios.

### Effect Demonstration

<table>

<tbody><tr>
<th>Online Education/Meeting</th>
<th>E-commerce Live Streaming</th>
<th>Game Live Streaming</th>
</tr>
<tr>
<td><Frame width="512" height="auto" caption=""><img src="https://media-resource.spreading.io/docuo/workspace740/af061ebc6eaf0f12ae9e7f72235bd04e/35da73d68d.png" /></Frame><Frame width="512" height="auto" caption=""><img src="https://media-resource.spreading.io/docuo/workspace740/af061ebc6eaf0f12ae9e7f72235bd04e/19258ba8aa.png" /></Frame></td>
<td><Frame width="512" height="auto" caption=""><img src="https://media-resource.spreading.io/docuo/workspace740/af061ebc6eaf0f12ae9e7f72235bd04e/953330e49e.png" /></Frame></td>
<td><Frame width="512" height="auto" caption=""><img src="https://media-resource.spreading.io/docuo/workspace740/af061ebc6eaf0f12ae9e7f72235bd04e/363fd4daa6.png" /></Frame></td>
</tr>
</tbody></table>

### Feature Trial

<CardGroup cols={2}>
  <Card title="Local Broadcast Plugin" href="https://zegoim.github.io/express-demo-web/src/Examples/Others/StreamCompositor/index.html">
  Start Experience >>
</Card>
</CardGroup>

### Applicable Scenarios

- Online education
- Online meetings
- Live streaming sales
- Game live streaming
- Show live streaming

### Compatibility Description

- Desktop: Supports Chrome 94 or above, Edge 94 or above. **For the best experience, we recommend using the latest version of Chrome or Edge browser.**
- Local broadcast plugin is not recommended for use on mobile.


## Prerequisites

Before implementing the local broadcast feature, please ensure:

- You have created a project in the [ZEGOCLOUD Console](https://console.zego.im) and applied for a valid AppID and Server address. For details, please refer to [Console - Project Information](/console/project-info).
- You have integrated ZEGO Express SDK in your project and implemented basic audio and video stream publishing and playing functions. For details, please refer to [Quick Start - Integration](/real-time-video-web/quick-start/integrating-sdk) and [Quick Start - Implementation](/real-time-video-web/quick-start/implementing-video-call).


## Implementation Steps

### 1 Integrate Local Broadcast Plugin

Developers can integrate the `local broadcast plugin` through any of the following methods.

#### Method 1: Integrate using npm

Find the "index.js" file in your project directory and add the following code to import the local broadcast plugin package.

```html
import { ZegoExpressEngine } from'zego-express-engine-webrtc';
import { StreamCompositor } from'zego-express-engine-webrtc/stream-compositor';

ZegoExpressEngine.use(StreamCompositor);
```

#### Method 2: Manual integration

Get the latest package on the [Download](/real-time-video-web/client-sdk/download-sdk) page. The files in the unzipped package contain the local broadcast plugin package. Find the "index.html" file in your project directory and add the following code to manually integrate the local broadcast plugin package.

```javascript
<script src="./stream-compositor-XXX.js"></script>
<script src="./ZegoExpressWebRTC-XXX.js"></script>
<script>
        ZegoExpressEngine.use(StreamCompositor);
        ...
</script>
```

### 2 Create Local Broadcast Plugin Processing Instance

Create and initialize a [ZegoExpressEngine](@-ZegoExpressEngine) instance, then call the [createStreamCompositor](@createStreamCompositor) interface to create a local broadcast plugin processing instance.

```javascript
// Initialize instance, appID and server please obtain from the console
const zg = new ZegoExpressEngine(appID, server);
const compositor = zg.createStreamCompositor();
```

### 3 Create Local Data Stream

Call the [createZegoStream](@createZegoStream) interface with different parameters to create local data streams for camera and screen sharing respectively.

```javascript
const cameraStream = await zg.createZegoStream();
const screenStream = await zg.createZegoStream({ screen: { video: true } });
```

### 4 (Optional) Set Camera Stream Background Transparent

If you want to set the video stream background outside the portrait collected by the camera to transparent, to achieve portrait picture-in-picture, presenter mode, and immersive live streaming sales, you need to import the `background processing module`.

1. Contact ZEGOCLOUD technical support to enable related permissions.
2. Find the "index.js" file in your project directory and add the following code to import the background processing module.

```javascript
import { BackgroundProcess } from'zego-express-engine-webrtc/background-process';
// Reference background processing module
ZegoExpressEngine.use(BackgroundProcess);
```

3. Call the [setTransparentBackgroundOptions](@setTransparentBackgroundOptions) interface to set the transparent effect of the background of the image with a portrait collected by the camera stream; then call the [enableBackgroundProcess](@enableBackgroundProcess) interface to enable background processing.

```javascript
zg.setTransparentBackgroundOptions(cameraStream);
await zg.enableBackgroundProcess(cameraStream, true, 0);
```

### 5 Set Input Stream Layers

Call the [setInputEndpoint](@setInputEndpoint) interface to set the layout effect, rendering mode, layer, etc. of the input stream.

```javascript
compositor.setInputEndpoint(screenStream, {
    layout: { x: 0, y: 0, width: 1280, height: 720, zOrder: 0 }
});

compositor.setInputEndpoint(cameraStream, {
    layout: { x: 0, y: 0, width: 320, height: 180, zOrder: 1 }
});
```

<Note title="Note">


The larger the zOrder value of the layer parameter, the higher the layer.

</Note>




### 6 Create Image Input Layer

Call the [addImage](@addImage) interface to set the position of the image layer.

```javascript
const img = document.getElementById("backImg");

compositor.addImage(img, {
    x: 0,
    y: 540,
    width: 320,
    height: 180,
    zOrder: 1
});
```

<Warning title="Notice">


- Due to browser security policy influence, if the image resource is not under the same domain, the server needs to enable cross-origin access permissions. You need to set the `crossOrigin` attribute of `HTMLImageElement` to 'anonymous'.
- Image loading takes time. You need to call the [addImage](@addImage) interface after the image loading is completed (in the `onload` event).


</Warning>



### 7 Set Output Parameters and Layout

Call the [setOutputConfig](@setOutputConfig) interface to set the width, height, frame rate, etc. of the output stream.

```javascript
const width = 1280, height = 720;

compositor.setOutputConfig({
    width: width,
    height: height,
    framerate: 15
});
```

### 8 Start Composing Media Stream

Call the [startComposingStream](@startComposingStream) interface to start composing media streams.

```javascript
// Output video stream mediaStream
const outputStream = await compositor.startComposingStream();
```

### 9 Stop Composing Media Stream

Call the [stopComposingStream](@stopComposingStream) interface to stop composing media streams; then call [destroyStream](@destroyStream) to destroy stream data and release resources.

```javascript
await compositor.stopComposingStream();
zg.destroyStream(cameraStream);
zg.destroyStream(screenStream);
```
