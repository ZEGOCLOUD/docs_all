---
articleID: 7646
date: "2024-10-11"
---
# Using Token for Authentication

---

## Feature Overview

Authentication refers to verifying whether a user has permission to access the system, to avoid security risks caused by lack of permission control or improper operation. ZEGOCLOUD authenticates users through Token (including basic authentication Token and permission authentication Token).


|Authentication Method|Description|Application Scenarios|
|-|-|-|
|[Basic Authentication Token](/real-time-video-web/communication/using-token-authentication)|Developers must include the Token parameter when logging into a room to verify the legitimacy of the user.|Basic authentication Token is the basic capability of Token, used for simple permission verification scenarios in business. In most cases, generating this Token is sufficient. |
|[Permission Authentication Token](/real-time-video-web/communication/using-token-authentication)|To further improve security, the room ID and stream ID permission bits are opened, which can verify the login room ID and stream ID.|General usage scenarios for room ID and stream ID permission bits are as follows:<ul><li>Rooms are divided into ordinary rooms and member rooms, requiring control to prevent non-member users from logging into member rooms.</li><li>In voice chat rooms or show live streaming, it is necessary to ensure consistency between streaming users and users on the mic, preventing "ghost mic" phenomenon, that is, hearing the sound of non-mic users in the room.</li><li>In speaking games like Werewolf, it is necessary to prevent hackers from cracking the application and using other user IDs to log into the same room to obtain game progress information for cheating, affecting the game experience of normal users.</li></ul>|


## Prerequisites

Basic authentication Token is enabled by default. For permission authentication Token (i.e., room ID and stream ID permission bits), please contact ZEGOCLOUD technical support to enable.

<Warning title="Note">


Only ZEGOCLOUD Express SDK version 2.14.0 and above supports using Token for authentication as described in this document.

</Warning>



## Process Overview

When using Token for authentication, developers need to generate Token first, then log into the room with the Token. The ZEGOCLOUD server validates users with Token.

Taking the use of Token to determine whether a user can log into a room as an example, the process is as follows:


<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/QuickStart/token_uml.png" /></Frame>

1. The developer client initiates a request to apply for Token.
2. Generate Token on the developer server and return it to the developer client.
3. The developer client carries the obtained Token and userID, roomID information to log into the corresponding room.
4. The ZEGOCLOUD SDK automatically sends the Token to the ZEGOCLOUD server for validation.
5. The ZEGOCLOUD server returns the validation result to the ZEGOCLOUD SDK.
6. The ZEGOCLOUD SDK then directly returns the validation result to the developer client. Clients without permission will fail to log in.


## Generating and Using Token

This section will introduce in detail how developers generate Token through the server, how to use Token, and how to handle Token expiration.

### 1 Obtain AppID and ServerSecret

Generating Token requires the developer project's unique identifier AppID and key ServerSecret. Please refer to "Project Information" in [Console - Project Management](/console/project-info) to obtain.

After obtaining the project's AppID and ServerSecret information, developers can generate Token on their own server according to actual business needs. The developer client sends a request to apply for Token to the developer server, and the developer server generates Token and returns it to the corresponding client.



### 2 Generate Token on Server

import GenerateTemporaryToken from '/snippets/common/en/token/generate-temporary-token.mdx'

<GenerateTemporaryToken />

ZEGOCLOUD provides an open-source zego_server_assistant plugin on GitHub/Gitee, supporting Go, C++, Java, Objective-C, Python, PHP, .NET, Node.js for deploying Token generation on the developer server.

Reference information for each language used to generate Token on the server in the zego_server_assistant plugin:

<table>

<tbody><tr>
<th rowspan="2">Language</th>
<th rowspan="2">Supported Version</th>
<th rowspan="2">Key Function</th>
<th rowspan="2">Repository URL</th>
<th colspan="2">Usage Examples</th>
</tr>
<tr>
<th>Basic Authentication Token</th>
<th>Permission Authentication Token</th>
</tr>
<tr>
<td>Go</td>
<td>Go 1.14.15 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/go/src/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/go/src/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-base.go">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-base.go">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-for-rtcroom.go">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-for-rtcroom.go">Gitee</a></li></ul></td>
</tr>
<tr>
<td>C++</td>
<td>C++ 11 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/c++/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Java</td>
<td>Java 1.8 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/java/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/java/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleBase.java">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleBase.java">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleForRtcRoom.java">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleForRtcRoom.java">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Python</td>
<td>Python 3.6.8 or above</td>
<td>generate_token04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/python/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/python/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/python/token04/test/base_sample.py">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/python/token04/test/base_sample.py">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/python/token04/test/rtcroom_sample.py">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/python/token04/test/rtcroom_sample.py">Gitee</a></li></ul></td>
</tr>
<tr>
<td>PHP</td>
<td>PHP 5.6 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/php/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/php/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant_php/blob/main/test/test.php">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/php/token04/test/test.php">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant_php/blob/main/test/testForRtcRoom.php">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/php/token04/test/testForRtcRoom.php">Gitee</a></li></ul></td>
</tr>
<tr>
<td>.NET</td>
<td>.NET Framework 3.5 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/.net/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/.net/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Node.js</td>
<td>Node.js 8 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/nodejs/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/nodejs/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-base.js">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-base.js">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-rtc-room.js">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-rtc-room.js">Gitee</a></li></ul></td>
</tr>
</tbody></table>

<Warning title="Note">


- Temporary Token acquisition method: For developers' convenience, [ZEGOCLOUD Console](https://console.zego.im/) provides the function to generate temporary Tokens. Developers can directly obtain temporary Tokens for use. For details, please refer to [Console - Development Assistance](/console/development-assistance/temporary-token). However, in the developer's own online environment, Token must be generated through their own server.
- To ensure security, it is strongly recommended that you use the server to generate Token; otherwise, there is a risk of ServerSecret being stolen.
- Please use "token04" in zego_server_assistant to generate Token.

</Warning>



Taking Go language as an example, developers can refer to the following steps to use zego_server_assistant to generate Token:

1. Use the command `git clone https://github.com/zegoim/zego_server_assistant` to get the dependency package.
2. In your code, import the plugin via `import "github.com/zegoim/zego_server_assistant/token/go/src/token04"`.
3. Call the GenerateToken04 method provided by the plugin to generate Token.

<a id="tab_item1"></a>
<Tabs>
<Tab title="Generate Basic Authentication Token">
**Basic Authentication Token**: Used for simple permission verification scenarios in business. The zego_server_assistant plugin provides sample code for generating basic authentication Token. At this time, the "payload" field can be passed empty. The sample code for generating basic authentication Token is as follows:
```go
package main
import (
     "fmt"
     "github.com/zegoim/zego_server_assistant/token/go/src/token04"
   )
    /*
    Sample code for basic authentication token generation
    */
func main() {
    var appId uint32 = 1    // Numeric ID assigned by Zego, unique identifier for each developer
    userId := "demo"       // User ID
    serverSecret := "fa94dd0f974cf2e293728a526b028271" // Key for AES encryption when obtaining token
    var effectiveTimeInSeconds int64 = 3600            // Effective duration of token, unit: seconds
    var payload string = ""                            // Token business authentication extension, leave empty for basic authentication token
    //Generate token
    token, err := token04.GenerateToken04(appId, userId, serverSecret, effectiveTimeInSeconds, payload)
    if err != nil {
	fmt.Println(err)
	return
    }
    fmt.Println(token)
}
```
</Tab>
<Tab title="Generate Permission Authentication Token">

Sample code for generating permission authentication Token is as follows:
```go
package main
import (
    "encoding/json"
    "fmt"
    "github.com/zegoim/zego_server_assistant/token/go/src/token04"
)
/*
Sample code for permission authentication token generation
*/
//Token business extension: permission authentication attributes
type RtcRoomPayLoad struct {
    RoomId       string      `json:"room_id"`        //Room ID (required); used for strong verification of the room ID of the interface
    Privilege    map[int]int `json:"privilege"`      //Permission bit switch list; used for strong verification of operation permissions of the interface
    StreamIdList []string    `json:"stream_id_list"` //Stream list; used for strong verification of the stream ID of the interface; allowed to be empty, if empty, stream ID will not be verified
}
func main() {
    var appId uint32 = 1                               // Numeric ID assigned by Zego, unique identifier for each developer
    roomId := "demo"                                   // Room ID
    userId := "demo"                                   // User ID
    serverSecret := "fa94dd0f974cf2e293728a526b028271" // Key for AES encryption when obtaining token
    var effectiveTimeInSeconds int64 = 3600            // Effective duration of token, unit: seconds
    //Please refer to github.com/zegoim/zego_server_assistant/token/go/src/token04/token04.go for definition
    ////Permission bit definition
    //const (
    //	PrivilegeKeyLogin   = 1 // Login permission bit authentication
    //	PrivilegeKeyPublish = 2 // Stream publishing permission bit authentication
    //)
    ////Permission switch definition
    //const (
    //	PrivilegeEnable     = 1 // Has permission
    //	PrivilegeDisable    = 0 // No permission
    //)
    //Business permission authentication configuration, can configure multiple permission bits
    privilege := make(map[int]int)
    privilege[token04.PrivilegeKeyLogin] = token04.PrivilegeEnable    // Has room login permission
    privilege[token04.PrivilegeKeyPublish] = token04.PrivilegeDisable // No stream publishing permission
    //Token business extension configuration
    payloadData := &RtcRoomPayLoad{
	RoomId:       roomId,
	Privilege:    privilege,
	StreamIdList: nil,
	}
    payload, err := json.Marshal(payloadData)
    if err != nil {
	fmt.Println(err)
	return
    }
    //Generate token
    token, err := token04.GenerateToken04(appId, userId, serverSecret, effectiveTimeInSeconds, string(payload))
    if err != nil {
	fmt.Println(err)
	return
}
    fmt.Println(token)
}
```
</Tab>
</Tabs>

<Warning title="Note">

When running the Java source code to generate Token, if "java.security.InvalidKeyException:illegal Key Size" exception appears, please refer to [Related FAQ](https://doc-zh.zego.im/faq/java_illegal_key_size_solution?product=ExpressVideo&platform=all) to solve.
</Warning>





### 3 Use Token

The user carries the obtained Token and user, roomID information to log into the corresponding room through the [loginRoom](@loginRoom) interface.

<Warning title="Note">

The userID used when calling the [loginRoom](@loginRoom) interface to log into the room must be consistent with the userID used when "4.2 Generate Token on Server".
</Warning>

```javascript
let roomID = 'xxx' // Room ID to log into
let token = 'xxxxxxxxxx' // Request from developer server
let user = {userID : 'xxxx'} // Unique identifier of the user in the room
let loginResult = await zg.loginRoom(roomID, token, user) // Log into room
```

If developers need to modify stream publishing permission bits after logging into the room, they can call the [renewToken](@renewToken) interface to update Token. After updating, it will affect the next stream publishing permission; previously successful stream publishing will not be affected.


```javascript
let token = await getToken(); // Re-request from developer server to obtain Token;
zg.renewToken(token);
```

### 4 Handling Token Expiration

<Warning title="Note">

Token expiration may cause issues such as stream publishing/playing exceptions. Please strictly follow the instructions below to handle expired Tokens in a timely manner.
</Warning>

30 seconds before Token expiration, the SDK will send a notification through the [tokenWillExpire](@tokenWillExpire) callback; when logging into the room after Token expiration, you will receive error code `1102018` (Token expired).

After receiving the Token expiration callback or Token expiration error code, developers need to obtain a new valid Token from their server and call the [renewToken](@renewToken) interface provided by the SDK to update the Token.

If you are using ZEGOCLOUD Express SDK version **2.14.0** or above, and after Token expiration, the [renewToken](@renewToken) interface is not called to update the Token, when permissions expire:
  - Logged-in users will not be kicked out of the room.
  - Currently successful stream publishing/playing will not be affected. However, after stopping stream publishing, you cannot publish streams again unless the Token is updated.

<Note title="Description">


ZEGOCLOUD also provides another Token expiration handling method. You can contact ZEGOCLOUD technical support to configure:
  - Logged-in users will be kicked out of the room and can only log into the room again after updating the Token.
  - Currently successful stream publishing will be stopped.

</Note>




```javascript
zg.on('tokenWillExpire',(roomID: string)=>{
    let token = await getToken(); // Re-request from developer server to obtain Token
    zg.renewToken(token);
});
```


## API Reference

| Method | Description |
|-------|--------|
| [loginRoom](@loginRoom) | Log into room |
| [renewToken](@renewToken) | Update Token |
| [tokenWillExpire](@tokenWillExpire) | Token expiration callback |
