# Login to Multiple Rooms

---

## Prerequisites

Before implementing multi-room functionality, please ensure:

- You have integrated ZEGO Express SDK (version 2.9.0 or above) in the project and implemented basic real-time audio and video functions. For details, please refer to [Quick Start - Integration](/real-time-video-u3d-cs/quick-start/integrating-sdk) and [Quick Start - Implementation](/real-time-video-u3d-cs/quick-start/implementing-video-call).
- You have created a project in [ZEGOCLOUD Console](https://console.zegocloud.com) and applied for valid AppID and AppSign. For details, please refer to "Project Information" in [Console - Project Management](/console/project-info).

- You have contacted ZEGOCLOUD Technical Support to enable multi-room functionality.


## Usage Steps

Taking the same user joining two rooms as an example, the overall implementation flow is as follows:

<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/Common/MultiRoom/MultiRoom_new.png" /></Frame>

1. Set the room mode to multi-room before initializing the SDK.
2. Initialize the SDK.
3. Join the first room. After successful login, you can publish streams, play streams, send and receive real-time messages in this room.
4. Join the second room. After successful login, you can publish streams, play streams, send and receive real-time messages in this room.
5. Leave the first and second rooms. There is no timing restriction for leaving rooms.

The implementation of specific functions is as follows:


















## Download Example Source Code

Please refer to [Download Example Source Code](/real-time-video-u3d-cs/quick-start/run-example-code) to get the source code.

For related source code, please view files in the "/ZegoExpressExample/Others/src/main/java/im/zego/others/multiplerooms" directory.

## Prerequisites

Before implementing multi-room functionality, please ensure:

- You have integrated ZEGO Express SDK (version 2.9.0 or above) in the project and implemented basic real-time audio and video functions. For details, please refer to [Quick Start - Integration](/real-time-video-u3d-cs/quick-start/integrating-sdk) and [Quick Start - Implementation](/real-time-video-u3d-cs/quick-start/implementing-video-call).
- You have created a project in [ZEGOCLOUD Console](https://console.zegocloud.com) and applied for valid AppID and AppSign. For details, please refer to "Project Information" in [Console - Project Management](/console/project-info).

- You have contacted ZEGOCLOUD Technical Support to enable multi-room functionality.


## Usage Steps

Taking the same user joining two rooms as an example, the overall implementation flow is as follows:

<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/Common/MultiRoom/MultiRoom_new.png" /></Frame>

1. Set the room mode to multi-room before initializing the SDK.
2. Initialize the SDK.
3. Join the first room. After successful login, you can publish streams, play streams, send and receive real-time messages in this room.
4. Join the second room. After successful login, you can publish streams, play streams, send and receive real-time messages in this room.
5. Leave the first and second rooms. There is no timing restriction for leaving rooms.

The implementation of specific functions is as follows:


### 1 Set multi-room mode

Before initializing the SDK, you must call the [SetRoomMode](@SetRoomMode) interface and set the room mode to multi-room mode through the [ZegoRoomMode](@-ZegoRoomMode) class, i.e., the "mode" value is "MULTI_ROOM".

<Note title="Note">


If you set multi-room mode without enabling multi-room functionality, login to the room will fail and an error will be returned with error code "1002036".

</Note>




```java
// Set room mode to multi-room mode
ZegoExpressEngine.SetRoomMode(ZegoRoomMode.MULTI_ROOM)
```
### Initialize SDK

Please refer to "Initialization" in [Quick Start - Implementation]() for SDK initialization.

### Login room

Pass in parameters such as room ID (roomID) and call the [LoginRoom](@LoginRoom) interface to login to the room.

- In single-room mode, you can only login to one room at the same time. When calling the [LoginRoom](@LoginRoom) interface, if you have already logged into another room, it will prompt that you have logged into the same room.
- In multi-room mode, you can login to multiple rooms at the same time, and the logged-in user information must be the same.

```java
// Create user
ZegoUser user = new ZegoUser("user1");

// Start login room
engine.LoginRoom("room1", user);
```


### Publish stream

Pass in parameters such as stream ID (streamID), room ID (roomID), and call the [StartPublishingStream](@StartPublishingStream) (with "ZegoPublisherConfig" parameter) interface to publish stream in the specified room.

<Warning title="Warning">


In multi-room mode, you must use [ZegoPublisherConfig](@-ZegoPublisherConfig) to specify the "roomID" associated with the "streamID". After exiting the specified room, the stream publishing operation for that room will stop.

</Warning>



```java
ZegoPublisherConfig config = new ZegoPublisherConfig();
config.roomID = "room1";

// Start publishing stream
engine.StartPublishingStream("stream1", config, ZegoPublishChannel.MAIN);
```

### Play stream

Pass in parameters such as stream ID (streamID), room ID (roomID), and call the [StartPlayingStream](@StartPlayingStream) (with "ZegoPlayerConfig" parameter) interface to play stream in the specified room.

<Warning title="Warning">


In multi-room mode, you must use [ZegoPlayerConfig](@-ZegoPlayerConfig) to specify the "roomID" associated with the "streamID". After exiting the specified room, the stream playing operation for that room will stop.

</Warning>




```java
ZegoPlayerConfig config = new ZegoPlayerConfig();
config.roomID = "room1";

// The following play_view is a SurfaceView/TextureView/SurfaceTexture object on the UI
engine.StartPlayingStream("stream1", new ZegoCanvas(play_view), config);
```


### 6 Send/Receive real-time messages

Multi-room and single-room sending and receiving real-time messages are implemented in the same way. For details, please refer to [Common Features - Real-time Message]().

### Logout room

Pass in the room ID (roomID) and call the [LogoutRoom](@LogoutRoom_2) interface to logout of the room.

<Note title="Note">


If you want to logout of all logged-in rooms at once, you can directly call the [LogoutRoom](@logoutRoom__2) interface without "roomID".

</Note>



- In single-room mode, logging out of the room will stop all publishing and playing streams at the same time.
- In multi-room mode, logging out of a room can only logout of the specified room and stop the publishing and playing streams of that room.


```java
// Logout room
engine.LogoutRoom("room1");
```


## FAQ

#### What is the reason for the failure when calling the [SetRoomMode](@SetRoomMode) interface?

- Whether the [SetRoomMode](@SetRoomMode) interface was called before initializing the SDK. In this case, error code "1001020" will be reported.
- Whether you have contacted ZEGOCLOUD Technical Support to enable multi-room functionality.
- Whether the correct parameters are passed in.

#### What is the reason for the login failure when calling [LoginRoom](@LoginRoom) with error code "1002036"?

If multi-room mode is set without enabling multi-room functionality, login to the room will fail and error code "1002036" will be returned.

#### What is the reason for the login failure when calling [LoginRoom](@LoginRoom) with error code "1002037"?

When the number of simultaneously logged-in rooms exceeds the maximum number of rooms, error code "1002037" will be returned. Currently, the default is to join up to 5 rooms at the same time. If you have more requirements, please contact ZEGOCLOUD Technical Support for extended capabilities.

#### What is the reason for the login failure when calling [LoginRoom](@LoginRoom) with error code "1002018"?

In multi-room mode, if the logged-in user information passed in is not the same, error code "1002018" will be returned.

#### What is the reason for the stream publishing failure when calling [StartPublishingStream](@StartPublishingStream) with error code "1003070"?

In multi-room mode, you must call the [StartPublishingStream](@StartPublishingStream) interface with the "ZegoPublisherConfig" parameter to publish stream, otherwise error code "1003070" will be returned.

#### What is the reason for the stream playing failure when calling [StartPlayingStream](@StartPlayingStream) with error code "1004070"?

In multi-room mode, you must call the [StartPlayingStream](@StartPlayingStream) interface with the "ZegoPlayerConfig" parameter to play stream, otherwise error code "1004070" will be returned.
