---
articleID: 14350
date: "2024-10-11"
---
# Using Token Authentication

---

## Function Introduction

Authentication refers to verifying whether a user has permission to access the system, to avoid security risks caused by lack of permission control or improper operation. ZEGO authenticates users through Tokens (including basic authentication Tokens and permission authentication Tokens).


|Authentication Method|Description|Application Scenarios|
|-|-|-|
|[Basic Authentication Token](/real-time-video-flutter/communication/using-token-authentication)|Developers must include the Token parameter when logging into the room to verify the user's legitimacy.|Basic authentication Token is the basic capability of Token, used for simple permission verification scenarios in business. In most cases, generating this Token is sufficient. |
|[Permission Authentication Token](/real-time-video-flutter/communication/using-token-authentication)|To further improve security, room ID and stream ID permission bits are open, which can verify the logged-in room ID and publishing stream ID.|General usage scenarios for room ID and stream ID permission bits are as follows:<ul><li>Rooms have the distinction between ordinary rooms and member rooms, and it is necessary to control non-member users from logging into member rooms.</li><li>In audio chat rooms or show live streaming, it is necessary to control the consistency between publishing users and on-mic users to prevent the "ghost mic" phenomenon, that is, hearing the sound of non-on-mic users in the room.</li><li>In speaking games such as Werewolf, it is necessary to prevent hackers from cracking the application and using other user IDs to log into the same room to obtain game progress information for cheating, affecting the gaming experience of normal users.</li></ul>|


## Prerequisites

Basic authentication Token is enabled by default. For permission authentication Token (i.e., room ID and stream ID permission bits), please contact ZEGO technical support to enable it.

<Warning title="Warning">


- Only ZEGO Express SDK version 2.17.1 and above supports using Token authentication as described in this document.
- If you have integrated ZEGO Express SDK version before 2.17.1 (using AppSign authentication) and now want to upgrade to version 2.17.1 and use Token authentication, you can learn more about AppSign authentication and Token authentication through the [How to Upgrade from AppSign Authentication to Token Authentication](https://doc-zh.zego.im/faq/token_upgrade) document.

</Warning>





## Process Overview

When using Token authentication, developers need to generate a Token first, then log into the room with the Token. The ZEGO server verifies users carrying Tokens.

Taking the use of Token to determine whether a user can log into a room as an example, the usage process is shown below:


<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/QuickStart/token_uml.png" /></Frame>

1. The developer's client initiates a request to apply for a Token.
2. Generate a Token on the developer's server and return it to the developer's client.
3. The developer's client logs into the corresponding room with the obtained Token, userID, and roomID information.
4. The ZEGO SDK automatically sends the Token to the ZEGO server for verification.
5. The ZEGO server returns the verification result to the ZEGO SDK.
6. The ZEGO SDK then directly returns the verification result to the developer's client. Clients without permission will fail to log in.


## Token Generation and Usage

This section will introduce in detail how developers generate Tokens through the server, how to use Tokens, and how to handle Token expiration.

### 1 Obtain AppID and ServerSecret

Generating a Token requires the developer's project unique identifier AppID and key ServerSecret. Please refer to "Project Information" in [Console - Project Management](/console/project-info) to obtain them.

After developers obtain their project's AppID and ServerSecret information, they can generate Tokens on their own server according to actual business needs. The developer's client sends a Token application request to the developer's server, and the developer's server generates a Token and returns it to the corresponding client.



### 2 Generate Token on Server

import GenerateTemporaryToken from '/snippets/common/zh/token/generate-temporary-token.mdx'

<GenerateTemporaryToken />

ZEGO provides an open-source zego_server_assistant plugin on GitHub/Gitee. Please use the "token04" version in the plugin to generate Tokens. The plugin supports Go, C++, Java, Objective-C, Python, PHP, .NET, and Node.js languages:

<table>

<tbody><tr>
<th rowspan="2">Language</th>
<th rowspan="2">Supported Version</th>
<th rowspan="2">Key Function</th>
<th rowspan="2">Plugin Download Address</th>
<th colspan="2">Usage Examples</th>
</tr>
<tr>
<th>Basic Authentication Token</th>
<th>Permission Authentication Token</th>
</tr>
<tr>
<td>Go</td>
<td>Go 1.14.15 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/go/src/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/go/src/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-base.go">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-base.go">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-for-rtcroom.go">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-for-rtcroom.go">Gitee</a></li></ul></td>
</tr>
<tr>
<td>C++</td>
<td>C++ 11 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/c++/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Java</td>
<td>Java 1.8 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/java/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/java/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleBase.java">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleBase.java">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleForRtcRoom.java">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleForRtcRoom.java">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Python</td>
<td>Python 3.6.8 or above</td>
<td>generate_token04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/python/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/python/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/python/token04/test/base_sample.py">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/python/token04/test/base_sample.py">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/python/token04/test/rtcroom_sample.py">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/python/token04/test/rtcroom_sample.py">Gitee</a></li></ul></td>
</tr>
<tr>
<td>PHP</td>
<td>PHP 5.6 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/php/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/php/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant_php/blob/main/test/test.php">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/php/token04/test/test.php">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant_php/blob/main/test/testForRtcRoom.php">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/php/token04/test/testForRtcRoom.php">Gitee</a></li></ul></td>
</tr>
<tr>
<td>.NET</td>
<td>.NET Framework 3.5 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/.net/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/.net/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Node.js</td>
<td>Node.js 8 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/nodejs/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/nodejs/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-base.js">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-base.js">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-rtc-room.js">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-rtc-room.js">Gitee</a></li></ul></td>
</tr>
</tbody></table>

Taking Go language as an example, developers can refer to the following steps to use zego_server_assistant to generate Tokens:

1. Use the command `git clone https://github.com/zegoim/zego_server_assistant` to obtain the dependency package.
2. In your code, introduce the plugin through `import "github.com/zegoim/zego_server_assistant/token/go/src/token04"`.
3. Call the GenerateToken04 method provided by the plugin to generate a Token.


<a id="tab_item1"></a>
<Tabs>
<Tab title="Generate Basic Authentication Token">
When generating a basic authentication Token, pass an empty string for the "payload" field. The specific example code is as follows:

```go
package main
import (
    "fmt"
    "github.com/zegoim/zego_server_assistant/token/go/src/token04"
)
/*
Basic authentication token generation example code
*/
func main() {
    var appId uint32 = 1    // Numeric ID assigned by Zego, unique identifier for each developer
    userId := "demo"   // User ID
    serverSecret := "fa94dd0f974cf2e293728a526b028271"  // Key for AES encryption when obtaining token
    var effectiveTimeInSeconds int64 = 3600    // Effective duration of token, unit: seconds
    var payload string = ""   // Token business authentication extension, leave empty for basic authentication token
    //Generate token
    token, err := token04.GenerateToken04(appId, userId, serverSecret, effectiveTimeInSeconds, payload)
    if err != nil {
	fmt.Println(err)
	return
    }
    fmt.Println(token)
}
```
</Tab>
<Tab title="Generate Permission Authentication Token">
To further improve security, permission authentication Token opens up room ID and stream ID permission bits, which can verify the logged-in room ID and publishing stream ID. At this time, the "payload" field needs to be generated according to rules. The permission bit verification rules are as follows:

- Only verify login permission: Verify permission when logging in, not when publishing stream.
- Only verify publishing permission: Verify permission when publishing stream, not when logging in.
- Verify both login and publishing permissions: Verify permissions when both logging in and publishing stream.

<Warning title="Warning">
When generating a permission authentication Token, "RoomId" must be passed in.
</Warning>

```go
package main
import (
    "encoding/json"
    "fmt"
    "github.com/zegoim/zego_server_assistant/token/go/src/token04"
)
/*
Permission authentication token generation example code
*/
//Token business extension: permission authentication attributes
type RtcRoomPayLoad struct {
    RoomId       string      `json:"room_id"`        //Room ID (required); used for strong verification of the room ID of the interface
    Privilege    map[int]int `json:"privilege"`      //Permission bit switch list; used for strong verification of operation permissions of the interface
    StreamIdList []string    `json:"stream_id_list"` //Stream list; used for strong verification of the stream ID of the interface; allowed to be empty, if empty, stream ID will not be verified
}
func main() {
    var appId uint32 = 1                               // Numeric ID assigned by Zego, unique identifier for each developer
    roomId := "demo"                                   // Room ID
    userId := "demo"                                   // User ID
    serverSecret := "fa94dd0f974cf2e293728a526b028271" // Key for AES encryption when obtaining token
    var effectiveTimeInSeconds int64 = 3600            // Effective duration of token, unit: seconds

    //Please refer to github.com/zegoim/zego_server_assistant/token/go/src/token04/token04.go for definition
    ////Permission bit definition
    //const (
    //	PrivilegeKeyLogin   = 1 // Login permission bit authentication
    //	PrivilegeKeyPublish = 2 // Publishing stream permission bit authentication
    //)
    ////Permission switch definition
    //const (
    //	PrivilegeEnable     = 1 // Has permission
    //	PrivilegeDisable    = 0 // No permission
    //)
    //Business permission authentication configuration, can configure multiple permission bits
    privilege := make(map[int]int)
    privilege[token04.PrivilegeKeyLogin] = token04.PrivilegeEnable    // Has room login permission
    privilege[token04.PrivilegeKeyPublish] = token04.PrivilegeDisable // No publishing stream permission
    //Token business extension configuration
    payloadData := &RtcRoomPayLoad{
	RoomId:       roomId,
	Privilege:    privilege,
	StreamIdList: nil,
}
    payload, err := json.Marshal(payloadData)
    if err != nil {
	fmt.Println(err)
	return
}
    //Generate token
    token, err := token04.GenerateToken04(appId, userId, serverSecret, effectiveTimeInSeconds, string(payload))
    if err != nil {
	fmt.Println(err)
	return
}
    fmt.Println(token)
}
```
</Tab>
</Tabs>

<Warning title="Warning">

When running the Java source code for generating Tokens, if the "java.security.InvalidKeyException:illegal Key Size" exception prompt appears, please refer to [Related FAQ Document](https://doc-zh.zego.im/faq/java_illegal_key_size_solution?product=ExpressVideo&platform=all) to solve it.
</Warning>


### 3 Use Token

Users log into the corresponding room through the [loginRoom](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/loginRoom.html) interface with the obtained Token, user, and roomID information.

<Warning title="Warning">


The userID used when calling the [loginRoom](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/loginRoom.html) interface to log into the room must be consistent with the userID used when "Generating Token on Server".

</Warning>




```dart
var config = ZegoRoomConfig.defaultConfig();
config.token = 'Your token';
var user = ZegoUser('Your userID', 'Your userName');
ZegoExpressEngine.instance.loginRoom('Your roomID', user, config: config);
```

If developers need to modify permission bits after logging into the room, they can also call the [renewToken](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/renewToken.html) interface to update the Token. After updating, it will affect the permissions for logging into certain rooms and publishing certain streams next time. Previously successful room logins and stream publishing will not be affected.


```dart
ZegoExpressEngine.instance.renewToken('Your roomID', 'New token');
```


### 4 Token Expiration Handling Mechanism

<Warning title="Warning">

Token expiration may cause issues such as publishing/playing stream exceptions. Please strictly follow the instructions below to handle expired Tokens in a timely manner.
</Warning>


30 seconds before the Token expires, the SDK will send a notification through the [onRoomTokenWillExpire](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomTokenWillExpire.html) callback; when logging into the room after the Token has expired, you will receive the `1002078` (Token expired) error code through `onDebugError` or `onRoomStateChanged`.

After receiving the Token about to expire callback or receiving the Token expired error code, developers need to obtain a new valid Token from their own server and call the [renewToken](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/renewToken.html) interface provided by the SDK to update the Token.

If you have integrated **ZEGO Express SDK version 2.17.0** or above, after the Token expires and the [renewToken](@renewToken) interface is not called to update the Token, when permissions expire:
  - Logged-in users will not be kicked out of the room.
  - Currently successful publishing/playing streams will not be affected. However, after stopping publishing stream, you cannot publish stream again unless the Token is updated.


<Note title="Note">
ZEGO also provides another Token expiration handling method. You can contact ZEGO technical support to configure:
  - Logged-in users will be kicked out of the room, and can only log into the room again after updating the Token.
  - Currently successful publishing streams will be stopped.
</Note>


```dart
ZegoExpressEngine.onRoomTokenWillExpire = (String roomID, int remainTimeInSecond) {
    String token = getToken(); // Request developer server again to obtain Token;
    ZegoExpressEngine.instance.renewToken(roomID, token);
  };
```

## Other

<Accordion title="Client-side Token Generation and Usage (Not Recommended)" defaultOpen="false">
If you cannot distribute Tokens through the server during development, you can first use client-side code to generate Tokens, and complete the integration after the server development is finished.

<Warning title="Warning">


- When the app goes live, do not generate Tokens on the client side, otherwise your ServerSecret will be at risk of exposure.
- To ensure security, it is strongly recommended that you use the server to generate Tokens, otherwise there is a risk of ServerSecret being stolen.
</Warning>


Reference information for each language in the zego_server_assistant plugin for client-side Token generation is as follows:

<table>

  <tbody><tr>
    <th>Language</th>
    <th>Supported Version</th>
    <th>Key Function</th>
    <th>Specific Address</th>
  </tr>
  <tr>
    <td>C++</td>
    <td>C++ 11 or above</td>
    <td>GenerateToken04</td>
    <td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/c++/token04">Gitee</a></li></ul></td>
  </tr>
  <tr>
    <td>Java</td>
    <td>Java 1.8 or above</td>
    <td>generateToken04</td>
    <td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/java/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/java/token04">Gitee</a></li></ul></td>
  </tr>
  <tr>
    <td>Objective-C</td>
    <td>-</td>
    <td>GenerateToken04</td>
    <td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/oc/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/oc/token04">Gitee</a></li><ul></ul></ul></td>
  </tr>
</tbody></table>

If you need to use client-side Token generation, please refer to [Use Token](#3-use-token).

If the Token expires, please refer to [Token Expiration Handling](#4-token-expiration-handling-mechanism) for handling.
</Accordion>



## API Reference

| Method | Description |
|-------|--------|
| [loginRoom](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/loginRoom.html) | Log into room |
| [renewToken](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/renewToken.html) | Update Token |
| [onRoomTokenWillExpire](https://doc-zh.zego.im/unique-api/express-video-sdk/zh/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomTokenWillExpire.html) | Token expiration callback |


## Related Documents

[How to prevent "ghost mic" or "room bombing" in audio/video interaction?](https://doc-zh.zego.im/faq/bombing)
