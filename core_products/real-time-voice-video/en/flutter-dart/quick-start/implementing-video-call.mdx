---
articleID: 7634
date: "2025-01-21"
---
# Implementing Video Call

---


## Feature Introduction

<Warning title="Note">


This document applies to the following platforms: Android, iOS, Windows, Web, Linux.

</Warning>


This document will introduce how to quickly implement a simple real-time audio and video call.

Explanation of related concepts:

- ZEGO Express SDK: A real-time audio and video SDK provided by ZEGO, providing developers with convenient integration, high definition and smoothness, multi-platform interoperability, low latency, and high concurrency audio and video services.
- Stream: Refers to a group of audio and video data that is continuously being sent, encapsulated in a specified encoding format. A user can publish multiple streams at the same time (for example, one for camera data and one for screen sharing data) and can also play multiple streams at the same time. Each stream is identified by a stream ID (streamID).
- Publish stream: The process of pushing the packaged audio and video data stream from the capture stage to the ZEGO real-time audio and video cloud.
- Play stream: The process of pulling and playing existing audio and video data streams from the ZEGO real-time audio and video cloud.
- Room: An audio and video space service provided by ZEGO, used to organize user groups. Users in the same room can send and receive real-time audio and video and messages to each other.
    1. Users need to login to a room first before they can publish/play streams.
    2. Users can only receive related messages in the room they are in (user join/leave, audio and video stream changes, etc.).
    3. Each room is identified by a unique AppID within an AppID. All users who use the same AppID to login to the room belong to the same room.



For more related concepts, please refer to [Term Explanation](/glossary/term-explanation).


## Prerequisites

Before implementing basic real-time audio and video functions, please ensure:

- ZEGO Express SDK has been integrated into the project to implement basic real-time audio and video functions. For details, please refer to [Quick Start - Integration](/real-time-video-flutter/quick-start/integrating-sdk).
- A project has been created in the [ZEGOCLOUD Console](https://console.zegocloud.com), and a valid AppID and AppSign have been applied for. For details, please refer to "Project Information" in [Console - Project Management](/console/project-info).

<Warning title="Note">

The SDK also supports Token authentication. If you have higher requirements for project security, it is recommended to upgrade the authentication method. For details, please refer to [How to upgrade from AppSign authentication to Token authentication](https://www.zegocloud.com/docs/faq/token_upgrade?product=ExpressVideo).
</Warning>


## Usage Steps

The basic process for users to make video calls through ZEGO Express SDK is as follows:

User A and B join the room. User B previews and publishes the audio and video stream to the ZEGO cloud service (Publish stream). After user A receives the notification of user B's published audio and video stream, user A plays user B's audio and video stream in the notification (Play stream).

<Frame width="512" height="auto" caption="">
  <img src="https://doc-media.zego.im/sdk-doc/Pics/Common/ZegoExpressEngine/common_usage_new.png" />
</Frame>

The API call sequence of the entire publish/play process is as follows:

<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/QuickStart/quickstart_uml_createEngineWithProfile_2.png" /></Frame>

<a id="CreateEngine"> </a>

### 1 Create Engine

**1. Create Interface (Optional)**

<Accordion title="Add Interface Elements" defaultOpen="false">
Before starting, it is recommended that developers add the following interface elements to facilitate the implementation of basic real-time audio and video functions.

- Local preview window
- Remote video window
- End button

<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/QuickStart/UI.jpg" /></Frame>
</Accordion>

**2. Import SDK**

Import the SDK in the project.

```dart
import 'package:zego_express_engine/zego_express_engine.dart';
```

**3. Create Engine**

Call the [createEngineWithProfile](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/createEngineWithProfile.html) interface and pass the applied AppID and AppSign to the parameters "appID" and "appSign". To prevent "appsign" from being exposed, please do not pass "appsign" on the Web platform.

<Warning title="Note">


The SDK also supports Token authentication. If you have higher requirements for project security, it is recommended to upgrade the authentication method. For details, please refer to [How to upgrade from AppSign authentication to Token authentication](https://www.zegocloud.com/docs/faq/token_upgrade?product=ExpressVideo).

</Warning>

<Warning title="Note">If it is a voice scenario, be sure to call `enableCamera(false)` to turn off the camera to avoid starting video capture and publishing stream, which will generate additional video traffic.</Warning>


```dart
ZegoEngineProfile profile = ZegoEngineProfile(
    appID, // Please obtain through official website registration, format: 1234567890
    ZegoScenario.General, // General scenario access
    appSign: appSign, // Please obtain through official website registration, format: '0123456789012345678901234567890123456789012345678901234567890123' (64 characters in total), no need to pass in for Web platform
    enablePlatformView: true); // Web platform needs to be true
// Create engine
ZegoExpressEngine.createEngineWithProfile(profile);
```

**4. Set Callbacks**

After creating the engine, developers can choose to use anonymous functions to implement callback functions as needed, and assign them to the corresponding callback function properties of the engine instance to register callbacks

<Warning title="Note">


To avoid missing event notifications, it is recommended to register callbacks immediately after creating the engine

</Warning>




<a id="createroom"></a>

### 2 Login Room

**1. Login**

After creating a ZegoUser user object by passing in the user ID parameter "userID", call the [loginRoom](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/loginRoom.html) interface, pass in the room ID parameter "roomID" and user parameter "user", and login to the room. If the room does not exist, calling this interface will create and login to this room.

- Within the same AppID, ensure that "roomID" information is globally unique.
- Within the same AppID, ensure that "userID" is globally unique. It is recommended that developers set it to a meaningful value and associate "userID" with their own business account system.
- The constructor method of "ZegoUser" [ZegoUser.id](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoUser/ZegoUser.id.html) will set "userName" to be the same as the passed parameter "userID". "userID" cannot be "null", otherwise login to the room will fail.


```dart
// Create user object
ZegoUser user = ZegoUser.id('user1');
// Only by passing in a ZegoRoomConfig with the "isUserStatusNotify" parameter set to "true" can you receive the onRoomUserUpdate callback.
ZegoRoomConfig config = ZegoRoomConfig.defaultConfig();
config.isUserStatusNotify = true;
// If you use appsign for authentication, you do not need to fill in the token parameter; if you need to use a more secure authentication method: token authentication, Web platform only supports token authentication, please refer to [How to upgrade from AppSign authentication to Token authentication](https://www.zegocloud.com/docs/faq/token_upgrade?product=ExpressVideo&platform=all)
// config.token = "xxxx";
// Start logging in to the room
ZegoExpressEngine.instance.loginRoom('room1', user, config: config);
```

**2. Listen to Event Callbacks After Logging in to the Room**


According to actual application needs, listen to the event notifications you care about after logging in to the room, such as room state updates, user state updates, stream state updates, etc.

- [onRoomStateUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomStateUpdate.html): Room state update callback. After logging in to the room, when the room connection state changes (such as room disconnection, login authentication failure, etc.), the SDK will notify through this callback.
- [onRoomUserUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomUserUpdate.html): User state update callback. After logging in to the room, when users are added to or deleted from the room, the SDK will notify through this callback.

    Only when calling the [loginRoom](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/loginRoom.html) interface to login to the room and passing in the [ZegoRoomConfig](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoRoomConfig-class.html) configuration, and the "isUserStatusNotify" parameter is set to "true", users can receive the [onRoomUserUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomUserUpdate.html) callback.

- [onRoomStreamUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomStreamUpdate.html): Stream state update callback. After logging in to the room, when users in the room newly publish or delete audio and video streams, the SDK will notify through this callback.

<Warning title="Note">


- Only when calling the [loginRoom](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/loginRoom.html) interface to login to the room and passing in the [ZegoRoomConfig](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoRoomConfig-class.html) configuration, and the "isUserStatusNotify" parameter is set to "true", users can receive the [onRoomUserUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomUserUpdate.html) callback.
- Normally, if a user wants to play videos published by other users, they can call the [startPlayingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePlayer/startPlayingStream.html) interface in the callback of stream state update (addition) to play the audio and video stream published by the remote user.

</Warning>




```dart

// The following are common room-related callbacks
// Room state update callback
ZegoExpressEngine.onRoomStateUpdate = (String roomID, ZegoRoomState state, int errorCode, Map<String, dynamic> extendedData) {
    // Implement event callbacks as needed
};

// User state update
ZegoExpressEngine.onRoomUserUpdate = (String roomID, ZegoUpdateType updateType, List<ZegoUser> userList) {
    // Implement event callbacks as needed
};

// Stream state update
ZegoExpressEngine.onRoomStreamUpdate = (String roomID, ZegoUpdateType updateType, List<ZegoStream> streamList) {
    // Implement event callbacks as needed
};

```

<a id="publishingStream"></a>

### 3 Publish Stream

**1. Start Publishing Stream**

Call the [startPublishingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePublisher/startPublishingStream.html) interface and pass in the stream ID parameter "streamID" to send the local audio and video stream to remote users.

<Warning title="Note">


Within the same AppID, ensure that "streamID" is globally unique. If within the same AppID, different users each publish a stream with the same "streamID", it will cause the later publishing user to fail to publish stream.

</Warning>



```dart
// Start publishing stream
ZegoExpressEngine.instance.startPublishingStream("streamID");
```

**2. Enable Local Rendering and Preview (Optional)**

<Accordion title="Start Local Preview After Rendering the Screen" defaultOpen="false">
Use `createCanvasView` to create a `widget`, add it to the view, return a `viewID` from the `onViewCreated` callback, and call the [startPreview](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePublisher/startPreview.html) interface with `viewID` to start local preview

Flutter has two rendering methods: PlatformView and TextureRenderer.
- Android, iOS, and MacOS can choose to use TextureRenderer or PlatformView by setting the "enablePlatformView" parameter when creating the engine.
- The Web platform only supports the PlatformView method, and there are no resource and stability issues.
- Windows and Linux currently only support the TextureRenderer method.

<Note title="Note">

Compared with TextureRenderer, PlatformView consumes slightly more resources and has lower stability, but with Flutter version iteration, robustness continues to improve.

</Note>




**createCanvasView Interface Usage Demonstration**

- The interface will automatically choose to use TextureRenderer or PlatformView based on the "enablePlatformView" parameter set when creating the engine and the methods supported by the platform.
- Android, iOS, and MacOS platforms will choose to use TextureRenderer or PlatformView based on the "enablePlatformView" parameter set when creating the engine.
- Web, Windows, and Linux will not be affected by the "enablePlatformView" parameter set when creating the engine, only using the supported method.

Get the Widget for preview, then use the viewID to create a ZegoCanvas object and start previewing.

```dart
// Add this Widget to the page's rendering tree to display the preview screen
_previewViewWidget = await ZegoExpressEngine.instance.createCanvasView((viewID) {
    _previewViewID = viewID;

    // Set the preview canvas
    ZegoCanvas previewCanvas = ZegoCanvas.view(viewID);

    // Start preview
    ZegoExpressEngine.instance.startPreview(canvas: previewCanvas);
});
```
</Accordion>

**3. Listen to Event Callbacks After Publishing Stream**


According to actual application needs, listen to the event notifications you care about after publishing stream, such as publishing stream state updates, etc.

[onPublisherStateUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onPublisherStateUpdate.html): Publishing stream state update callback. After successfully calling the publishing stream interface, when the publishing stream state changes (such as network interruption causing publishing stream exceptions, etc.), the SDK will notify through this callback while retrying to publish stream.

```dart
// Common publishing stream related callbacks
// Publishing stream state update callback
ZegoExpressEngine.onPublisherStateUpdate = (String streamID, ZegoPublisherState state, int errorCode, Map<String, dynamic> extendedData) {
    // Implement event callbacks as needed
};
```

<Note title="Note">If you need to know about ZEGO Express SDK's camera/video/microphone/audio/speaker related interfaces, please refer to [FAQ - How to implement switching camera/video screen/microphone/audio/speaker?](https://www.zegocloud.com/docs/faq/How_to_switch_devices).</Note>

<a id="PlayingStream"></a>

### 4 Play Stream

Call the [startPlayingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePlayer/startPlayingStream.html) interface, based on the passed stream ID parameter "streamID", to play the audio and video stream published by the remote user, and render the playing stream screen as needed.

- If you only need to play audio stream and do not need to display the playing stream screen, you can directly call the [startPlayingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePlayer/startPlayingStream.html) interface.

```dart
ZegoExpressEngine.instance.startPlayingStream(streamID);
```

- If you need to render the playing stream screen while playing stream, Flutter has two rendering methods: PlatformView and TextureRenderer.
    - Android and iOS can choose to use TextureRenderer or PlatformView by setting the "enablePlatformView" parameter when creating the engine.
    - The Web platform only supports the PlatformView method, and there are no resource and stability issues.
    - Windows and MacOS currently only support the TextureRenderer method.

<Note title="Note">

Compared with TextureRenderer, PlatformView consumes slightly more resources and has lower stability, but with Flutter version iteration, robustness continues to improve.

</Note>


**createCanvasView Interface Usage Demonstration**

- The interface will automatically choose to use TextureRenderer or PlatformView based on the "enablePlatformView" parameter set when creating the engine and the methods supported by the platform.
- Android, iOS, and MacOS platforms will choose to use TextureRenderer or PlatformView based on the "enablePlatformView" parameter set when creating the engine.
- Web, Windows, and Linux will not be affected by the "enablePlatformView" parameter set when creating the engine, only using the supported method.

Get the Widget for preview, then use the viewID to create a ZegoCanvas object and start previewing.

```dart
// Add this Widget to the page's rendering tree to display the preview screen
_playViewWidget = await ZegoExpressEngine.instance.createCanvasView((viewID) {
    _playViewID = viewID;

    // Set the playing canvas
    ZegoCanvas canvas = ZegoCanvas.view(viewID);

    // Start playing
    ZegoExpressEngine.instance.startPlayingStream(streamID, canvas: canvas);
});
```

**2. Listen to Event Callbacks After Playing Stream**

According to actual application needs, listen to the event notifications you care about after playing stream, such as playing stream state updates, etc.

[onPlayerStateUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onPlayerStateUpdate.html): Playing stream state update callback. After successfully calling the playing stream interface, when the playing stream state changes (such as network interruption causing publishing stream exceptions, etc.), the SDK will notify through this callback while retrying to play stream.

```dart
// Common playing stream related callbacks
// Playing stream state related callbacks
ZegoExpressEngine.onPlayerStateUpdate = (String streamID, ZegoPlayerState state, int errorCode, Map<String, dynamic> extendedData) {
    // Implement event callbacks as needed
};
```

### 5 Test Publish and Play Stream Functions Online

Run the project on a real device. After running successfully, you can see the local video screen.

For convenience, ZEGO provides a [Web Debug Demo](https://zegodev.github.io/zego-express-webrtc-sample/assistDev/index.html). On this page, enter the same AppID and RoomID, enter different UserIDs and corresponding [Token](/console/development-assistance/temporary-token), and you can join the same room to communicate with real device devices. When the audio and video call starts successfully, you can hear the remote audio and see the remote video screen.



### 6 Stop Publish and Play Stream

<a id="stopPublishingStream"></a>

**1. Stop Publishing Stream/Preview/Rendering**

Call the [stopPublishingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePublisher/stopPublishingStream.html) interface to stop sending the local audio and video stream to remote users.

```dart
// Stop publishing stream
ZegoExpressEngine.instance.stopPublishingStream();
```

If local preview is enabled, call the [stopPreview](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePublisher/stopPreview.html) interface to stop preview.

```dart
// Stop preview
ZegoExpressEngine.instance.stopPreview();
```

If createCanvasView was used during preview, call the [destroyCanvasView](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressCanvasViewUtils/destroyCanvasView.html) interface to destroy it.

```dart
// _previewViewID is the viewID obtained when calling [createCanvasView]
ZegoExpressEngine.instance.destroyCanvasView(_previewViewID);
```

**2. Stop Playing Stream/Rendering**

Call the [stopPlayingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePlayer/stopPlayingStream.html) interface to stop playing the audio and video stream published by remote users.

<Warning title="Note">


If the developer receives a notification of audio and video stream "decrease" through the [onRoomStreamUpdate](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/onRoomStreamUpdate.html) callback, please call the [stopPlayingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePlayer/stopPlayingStream.html) interface in time to stop playing stream, to avoid playing empty streams and generating additional costs; or, developers can choose the appropriate timing according to their own business needs and actively call the [stopPlayingStream](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEnginePlayer/stopPlayingStream.html) interface to stop playing stream.

</Warning>




```dart
// Stop playing stream
ZegoExpressEngine.instance.stopPlayingStream(streamID);
```

If createCanvasView was used during playing stream, call the [destroyCanvasView](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressCanvasViewUtils/destroyCanvasView.html) interface to destroy it.

```dart
// _playViewID is the viewID obtained when calling [createCanvasView]
ZegoExpressEngine.instance.destroyCanvasView(_playViewID);
```

### 7 Logout Room

Call the [logoutRoom](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngineRoom/logoutRoom.html) interface to logout of the room.

```dart
// Logout of room
ZegoExpressEngine.instance.logoutRoom('room1');
```

### 8 Destroy Engine

Call the [destroyEngine](https://www.zegocloud.com/docs/unique-api/express-video-sdk/en/dart_flutter/zego_express_engine/ZegoExpressEngine/destroyEngine.html) interface to destroy the engine, used to release resources used by the SDK.

```dart
// Destroy engine
ZegoExpressEngine.destroyEngine();
```
