---
articleID: 10182
date: "2025-03-05"
---


# Audio 3A Processing

- - -

## Introduction

During real-time video calls or live streaming, audio can undergo 3A processing, mainly including AEC (Acoustic Echo Cancellation), AGC (Automatic Gain Control), and ANS (Active Noise Suppression), to improve call or live streaming quality and user experience.

- AEC (Acoustic Echo Cancellation): Filters captured audio data to reduce echo in the audio.
- AGC (Automatic Gain Control): After enabling this function, the SDK can automatically adjust the microphone volume to adapt to near and far sound pickup and maintain stable volume.
- ANS (Active Noise Suppression): Identifies and eliminates background noise in the sound. After enabling this function, the voice can be clearer. You can also enable music scenario detection to identify communication and music scenarios in real time without consumption, further preserving the fidelity of human voice and music audio quality in music scenarios. If users need a more aggressive noise suppression strategy, you can use the [Scenario-Based AI Noise Suppression](/real-time-video-windows-cpp/audio/scenario-based-ai-noise-reduction) feature.

<Warning title="Note">


If you need to use music scenario detection capability, please contact ZEGOCLOUD Technical Support for special packaging and configuration.
</Warning>


## Download Sample Source Code

Please refer to [Download Sample Source Code](/real-time-video-windows-cpp/quick-start/run-example-code) to obtain the source code.

For related source code, please check the files in the "/ZegoExpressExample/Examples/AdvancedAudioProcessing/AEC_ANS_AGC" directory.

## Default Configuration and Recommended Configuration

The default configuration and recommended configuration for audio 3A processing in the SDK are as follows:

|Interface Name|Interface Description|Default Configuration|Recommended Configuration
|-|-|-|-|
|[enableAEC](@enableAEC)|Turn on/off acoustic echo cancellation. |Before calling this function, the SDK internally automatically determines whether to use AEC. Once this function is called, the SDK no longer makes automatic determination.|In general usage scenarios, it is recommended not to modify this configuration and keep the default.|
|[setAECMode](@setAECMode)|Set the acoustic echo cancellation mode.|ZEGO_AEC_MODE_AGGRESSIVE (Aggressive echo cancellation).|In general usage scenarios, it is recommended not to modify this configuration and keep the default.|
|[enableAGC](@enableAGC)|Turn on/off automatic gain control.|Before calling this function, the SDK internally automatically determines whether to use AGC. Once this function is called, the SDK no longer makes automatic determination.|<ul><li>In normal voice chat scenarios, it is recommended to use the default configuration.</li><li>In music radio scenarios, it is recommended not to enable automatic gain control to restore the human voice.</li><li>In education scenarios, such as large classes, small classes, and 1v1, it is recommended to enable automatic gain control.</li></ul>|
|[enableANS](@enableANS)|Turn on/off noise suppression.|Before calling this function, the SDK internally automatically determines whether to use ANS. Once this function is called, the SDK no longer makes automatic determination.|In general usage scenarios, it is recommended not to modify this configuration and keep the default.|
|[enableTransientANS](@enableTransientANS)|Turn on/off transient noise suppression.|Before calling this function, transient noise suppression is not enabled by default.|In general usage scenarios, it is recommended not to modify this configuration and keep the default.|
|[setANSMode](@setANSMode)|Set the audio noise suppression mode.|ZEGO_ANS_MODE_MEDIUM (Moderate noise suppression).|In general usage scenarios, it is recommended not to modify this configuration and keep the default.|

## Prerequisites

Before using audio 3A processing, ensure that:

- A project has been created in the [ZEGOCLOUD Console](https://console.zegocloud.com), and valid AppID and AppSign have been obtained. For details, please refer to [Console - Project Information](/console/project-info).
- ZEGO Express SDK has been integrated into the project, and basic audio and video streaming functionality has been implemented. For details, please refer to [Quick Start - Integration](/real-time-video-windows-cpp/quick-start/integrating-sdk) and [Quick Start - Implementation Process](/real-time-video-windows-cpp/quick-start/implementing-video-call).


## Usage Steps

### Set AEC (Acoustic Echo Cancellation)

<Warning title="Note">


[enableAEC](@enableAEC), [enableHeadphoneAEC](@enableHeadphoneAEC), and [setAECMode](@setAECMode) must be called before [startPublishingStream](@startPublishingStream), [startPlayingStream](@startPlayingStream), [startPreview](@startPreview), [createMediaPlayer](@createMediaPlayer), [createAudioEffectPlayer](@createAudioEffectPlayer), and [createRealTimeSequentialDataManager](@createRealTimeSequentialDataManager) to take effect.
</Warning>

Developers can complete echo cancellation related settings according to the following steps:

1. Call the [enableAEC](@enableAEC) interface to enable echo cancellation. After enabling this function, the SDK will filter the captured audio data to reduce echo in the audio.
2. (Optional) Developers can set whether to enable echo cancellation when using headphones by calling the [enableHeadphoneAEC](@enableHeadphoneAEC) interface.
3. After enabling echo cancellation, developers can set the echo cancellation mode by calling the [setAECMode](@setAECMode) interface. The SDK supports the following three echo cancellation modes:

    |Enumeration Value|Description|
    |-|-|
    |ZEGO_AEC_MODE_AGGRESSIVE| Aggressive echo cancellation, which may significantly affect audio quality, but echo will be eliminated very cleanly.|
    |ZEGO_AEC_MODE_MEDIUM|Moderate echo cancellation, which may slightly affect audio quality a little bit, but residual echo will be less.|
    |ZEGO_AEC_MODE_SOFT|Comfortable echo cancellation, where echo cancellation basically does not affect the audio quality of the sound. There may sometimes be a little residual echo, but it will not affect normal listening.|

<Warning title="Note">


Express SDK supports AI echo cancellation, which further improves the fidelity of human voice while effectively eliminating echo. If you need to use AI echo cancellation, please contact ZEGOCLOUD Technical Support for special packaging first.
</Warning>

Taking setting moderate echo cancellation as an example:

```cpp
// Enable AEC
engine->enableAEC(true);
// Set AEC mode to ZEGO_AEC_MODE_MEDIUM
engine->setAECMode(ZEGO_AEC_MODE_MEDIUM);
```

### Set AGC (Automatic Gain Control)

<Warning title="Note">


[enableAGC](@enableAGC) must be called before [startPublishingStream](@startPublishingStream), [startPlayingStream](@startPlayingStream), [startPreview](@startPreview), [createMediaPlayer](@createMediaPlayer), [createAudioEffectPlayer](@createAudioEffectPlayer), and [createRealTimeSequentialDataManager](@createRealTimeSequentialDataManager) to take effect.
</Warning>

Call the [enableAGC](@enableAGC) interface to enable automatic gain control. After enabling this function, the SDK can automatically adjust the microphone volume to adapt to near and far sound pickup and maintain stable volume.

```cpp
// Enable AGC
engine->enableAGC(true);
```

### Set ANS (Noise Suppression)

<Warning title="Note">


[enableANS](@enableANS), [enableTransientANS](@enableTransientANS), and [setANSMode](@setANSMode) must be called before [startPublishingStream](@startPublishingStream), [startPlayingStream](@startPlayingStream), [startPreview](@startPreview), [createMediaPlayer](@createMediaPlayer), [createAudioEffectPlayer](@createAudioEffectPlayer), and [createRealTimeSequentialDataManager](@createRealTimeSequentialDataManager) to take effect.
</Warning>

Developers can complete noise suppression related settings according to the following steps:

1. Call the [enableANS](@enableANS) interface to enable noise suppression. After enabling this function, the voice can be clearer.

2. (Optional) Developers can set whether to enable transient noise suppression by calling the [enableTransientANS](@enableTransientANS) interface. Transient noise suppression is used to suppress transient noise such as keyboard typing and table tapping.

3. After enabling noise suppression, developers can set the noise suppression mode by calling the [setANSMode](@setANSMode) interface. The default value is "ZEGO_ANS_MODE_MEDIUM".
    The SDK supports the following three noise suppression modes:

    |Enumeration Value|Description|
    |-|-|
    |ZEGO_ANS_MODE_AGGRESSIVE|Aggressive noise suppression, which may significantly damage audio quality, but has good noise suppression effects.|
    |ZEGO_ANS_MODE_MEDIUM|(Default value) Moderate noise suppression, which may damage some audio quality, but has good noise suppression effects.|
    |ZEGO_ANS_MODE_SOFT|Light noise suppression, which basically does not damage audio quality, but will leave some noise.|

    <Warning title="Note">


    Express SDK supports AI mode noise suppression, providing three modes: lightweight mode, balanced mode, and low-latency mode. It effectively eliminates transient noise such as keyboards, coughing, wind, car horns, etc., while eliminating steady-state noise. For details, please refer to [Scenario-Based AI Noise Suppression](/real-time-video-windows-cpp/audio/scenario-based-ai-noise-reduction).
    </Warning>

4. (Optional) Enable music detection. Please contact ZEGOCLOUD Technical Support to configure and enable the music detection feature.

Taking setting light noise suppression as an example:

```cpp
// Enable ANS
engine->enableANS(true);
// Enable transient noise suppression
engine->enableTransientANS(true);
// Set ANS mode to ZEGO_ANS_MODE_SOFT
engine->setANSMode(ZEGO_ANS_MODE_SOFT);
```

## Related Documentation

- [How to handle audio echo issues?](https://www.zegocloud.com/docs/faq/echo)
- [How to handle audio noise issues?](https://www.zegocloud.com/docs/faq/audio_noise)
- [How to obtain and upload audio Dump files?](https://www.zegocloud.com/docs/faq/How_to_get_audio_dump_upload)

