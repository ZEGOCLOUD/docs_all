---
articleID: 18878
date: "2025-01-20"
---
# Publishing Stream Video Enhancement

- - -

## Feature Overview

ZEGO Express SDK provides multiple video pre-processing enhancement capabilities. Developers can adjust the screen effects on the publishing side according to business needs.

<table>

<tbody><tr>
<th>Feature</th>
<th>Feature Description</th>
<th>Feature Advantages</th>
<th colspan="2">Effect Demo</th>
</tr>
<tr>
<td>Basic AI Effects</td>
<td>According to user and business needs, adjust the degree of whitening, smoothing, sharpening, and rosyness, easily achieve basic AI effects functionality, present users with good skin condition, and create unique natural AI effects.</td>
<td>Covers high-frequency AI effects capabilities.</td>
<td colspan="2"><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/AI_Vision/AI_beauty.gif" /></Frame></td>
</tr>
<tr>
<td>Low Light Enhancement</td>
<td>When ambient light is dark and the brightness of the screen captured by the camera does not meet the needs of seeing faces clearly or performing face recognition and other business needs, enhance the screen brightness.</td>
<td><ul><li>Extremely small performance overhead, covering all device models.</li><li>Supports automatic enhancement mode, automatically identifies low-light environments.</li></ul></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/lowlightenhancement/lowlightenhancement_before.jpg" /></Frame></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/lowlightenhancement/lowlightenhancement_after.jpg" /></Frame></td>
</tr>
<tr>
<td>Color Enhancement</td>
<td>Due to camera characteristics, captured video may have insufficient saturation. Use the color enhancement feature to enhance undersaturated colors while protecting skin tone, making screen colors more realistic and more in line with human visual perception.</td>
<td><ul><li>Protect skin tone, avoid enhancing human skin tone.</li><li>Protect lip color, making lips more natural when using AI effects and wearing makeup.</li></ul></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/Express/color_enhanced_before.jpg" /></Frame></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/Express/color_enhanced_after.jpg" /></Frame></td>
</tr>
</tbody></table>

## Prerequisites

Before using the publishing stream video enhancement feature, ensure that:

- A project has been created in the [ZEGOCLOUD Console](https://console.zego.im), and a valid AppID and AppSign have been obtained. For details, please refer to [Console - Project Information](/console/project-info).
- ZEGO Express SDK has been integrated into the project, and basic audio/video stream publishing and playing functionality has been implemented. For details, please refer to [Quick Start - Integration](/real-time-video-windows-cpp/quick-start/integrating-sdk) and [Quick Start - Implementation](/real-time-video-windows-cpp/quick-start/implementing-video-call).


## Implementation Steps

### Initialize and login to room

For the specific process of initialization and logging in to the room, please refer to "[Create Engine](/real-time-video-windows-cpp/quick-start/implementing-video-call)" and "[Login Room](/real-time-video-windows-cpp/quick-start/implementing-video-call)" in the implementing video call documentation.

### Set publishing stream video enhancement effects

Please select the corresponding feature to configure according to your needs.

<Accordion title="Basic AI Effects" defaultOpen="false">
<Note title="Note">
This feature is the basic AI effects feature of ZEGO Effects SDK built into ZEGO Express SDK, including only four AI effects: whitening, rosyness, smoothing, and sharpening. For more advanced AI effects features, please refer to [Using Real-Time Audio/Video with AI Effects](/real-time-video-ios-oc/best-practice/integration-with-zego-effects-sdk).
</Note>

**Initialize basic AI effects environment**

If you need to use the basic AI effects feature, you must call the [startEffectsEnv](@startEffectsEnv) interface to initialize the AI effects environment before starting preview with [startPreview](@startPreview) and publishing stream with [startPublishingStream](@startPublishingStream).

```cpp
// Create AI effects environment
engine->startEffectsEnv();
```

After initializing the AI effects environment, the SDK will use a fixed video frame data type for transmission internally. If you need to use video custom pre-processing while using the basic AI effects feature, you can only configure the corresponding video frame data type:

Windows platform: Only supports video frame raw data, i.e., the [bufferType](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~CPP_windows~struct~zego-express-zego-custom-video-capture-config&jumpType=route#buffer-type) value of [ZegoCustomVideoCaptureConfig](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~CPP_windows~struct~zego-express-zego-custom-video-capture-config&jumpType=route) is "ZEGO_VIDEO_BUFFER_TYPE_RAW_DATA".

**Enable/disable basic AI effects**

<Note title="Note">
There is no order requirement for calling the [enableEffectsBeauty](@enableEffectsBeauty) interface and the [setEffectsBeautyParam](@setEffectsBeautyParam) interface.
</Note>

After initializing the AI effects environment, you can call the [enableEffectsBeauty](@enableEffectsBeauty) interface to enable or disable AI effects in real-time before or after publishing stream.

```cpp
// Enable/disable AI effects
engine->enableEffectsBeauty(true);
```

**Set basic AI effects parameters**

After initializing the AI effects environment, you can call the [setEffectsBeautyParam](@setEffectsBeautyParam) interface to set AI effects parameters in real-time before or after publishing stream.

- smoothIntensity: Smoothing, perform smoothing while retaining facial details, such as retaining moles on the face.
- whitenIntensity: Whitening, whiten the face by increasing the overall brightness of the screen.
- rosyIntensity: Rosyness, apply warm color processing to the overall screen.
- sharpenIntensity: Sharpening, apply sharpening to the overall screen. When the screen is slightly blurry, you can increase sharpening slightly to make contours clear.

The value range of all four parameters above is 0 ~ 100. The larger the value, the higher the degree of AI effects. The default value is 50.

```cpp
// Create AI effects parameter object
ZegoEffectsBeautyParam beautyParam;

// Whitening, rosyness, smoothing, sharpening
beautyParam.whitenIntensity = 50;
beautyParam.rosyIntensity = 50;
beautyParam.smoothIntensity = 50;
beautyParam.sharpenIntensity = 50;

// Set AI effects parameters
engine->setEffectsBeautyParam(beautyParam);
```

**（Optional）Destroy basic AI effects environment**

When the [enableEffectsBeauty](@enableEffectsBeauty) interface is called and set to "false", the AI effects will be turned off, but the AI effects module will still occupy resources and consume performance. If you want to completely release resources and save performance consumption, you need to call the [stopEffectsEnv](@stopEffectsEnv) interface to destroy the AI effects environment before preview and publishing stream.

<Note title="Note">
When calling [destroyEngine](@destroyEngine) to destroy the engine, the SDK will automatically destroy the AI effects environment.
</Note>

```cpp
// Destroy AI effects environment
engine->stopEffectsEnv();
```
</Accordion>


<Accordion title="Low Light Enhancement" defaultOpen="false">
ZEGO provides two methods of low light enhancement:

<table>

<tbody><tr>
<th>Method</th>
<th>Description</th>
</tr>
<tr>
<td>Enable adaptive frame rate for enhancement</td>
<td>Dynamically reduce the capture frame rate within the set frame rate range to extend the exposure time of each frame, achieving the effect of enhancing the brightness of the captured screen.
<br /> For example: The developer enables and sets the adaptive frame rate range to [10, 25]. When ambient light is sufficient, the capture frame rate is still 25 frames. When ambient light is low, the capture frame rate will be dynamically adjusted between [10, 25] to extend the exposure time of each frame to enhance the brightness of the captured screen.</td>
</tr>
<tr>
<td>Algorithm enhances captured screen brightness</td>
<td>
<ul>
<li>Manual enhancement mode: Determine whether to enable algorithm enhancement based on received parameters.</li>
<li>Automatic enhancement mode: SDK automatically decides whether to enable algorithm enhancement and the degree of enhancement based on the ambient light intensity of the user's environment.</li>
</ul>
</td>
</tr>
</tbody></table>

Both processing methods can be used independently or simultaneously, and both are compatible with AI effects functionality.

**Set low light enhancement mode**

RTC SDK supports different algorithm low light enhancement modes. Call the [setLowlightEnhancement](@setLowlightEnhancement) interface to set the low light enhancement mode [ZegoLowlightEnhancementMode](@-ZegoLowlightEnhancementMode):

<Note title="Note">
- Before using the [setLowlightEnhancement](@setLowlightEnhancement) interface, ensure that the SDK includes the **video internal capture** and **video internal filter** modules.
- If the business uses external capture for video streams, only the specific data type `PIXEL_BUFFER_TYPE_MEM` is supported.
</Note>

|Enumeration Value|Description|
|-|-|
|ZEGO_LOWLIGHT_ENHANCEMENT_MODE_OFF| Disable low light enhancement feature, capture screen brightness remains unchanged.|
|ZEGO_LOWLIGHT_ENHANCEMENT_MODE_ON|Enable low light enhancement feature, capture screen brightness is enhanced.|
|ZEGO_LOWLIGHT_ENHANCEMENT_MODE_AUTO|Automatic low light enhancement feature, capture screen brightness enhancement value dynamically adjusts with ambient brightness.|

Taking enabling automatic low light enhancement feature as an example:

```cpp
engine->setLowlightEnhancement(ZEGO_LOWLIGHT_ENHANCEMENT_MODE_AUTO);
params.mode = ZEGO_LOWLIGHT_ENHANCEMENT_MODE_AUTO;
params.type = ZEGO_EXP_LOWLIGHT_ENHANCEMENT_TYPE_AI

engine->setLowlightEnhancementParams(params);
```

【New: Select low light algorithm example code】

**（Optional）Enable camera adaptive frame rate**

When ambient light is low and the camera capture frame rate is too high, the exposure time of each frame is insufficient, which may cause the captured video screen to be dark. At this time, you can enable camera adaptive frame rate through [enableCameraAdaptiveFPS](@enableCameraAdaptiveFPS). The SDK will match the camera's supported capture frame rate range according to the set frame rate range. Within this range, dynamically adjust the camera capture frame rate according to ambient brightness to improve screen brightness when the set frame rate is too high.

```cpp
int minCamFPS = 15;//Set minimum frame rate
int maxCamFPS = 35;//Set maximum frame rate
engine->enableCameraAdaptiveFPS(true, minCamFPS, maxCamFPS);
```
</Accordion>

<Accordion title="Color Enhancement" defaultOpen="false">
Call the [enableColorEnhancement](@enableColorEnhancement) interface, set the color enhancement parameters [ZegoColorEnhancementParams](@-ZegoColorEnhancementParams) (parameter attributes are as follows in the table), and other parameters to enable the color enhancement feature. **Color enhancement feature is not enabled by default.**

|Color Enhancement Parameter|Description|
|-|-|
| intensity|<p>Intensity of color enhancement, value range [0.0, 1.0], default is 0.0.</p><p>The larger the value, the greater the color enhancement effect.</p>|
| skinToneProtectionLevel |<p>Intensity of skin tone protection, value range [0.0, 1.0], default is 1.0.</p><p>The larger the value, the better the protection effect.</p>|
| lipColorProtectionLevel |<p>Intensity of lip color protection, value range [0.0, 1.0], default is 0.0.</p><p>The larger the value, the better the protection effect.</p>|

```cpp
ZegoColorEnhancementParams p;
p.intensity = 1;//Value range: [0,1], the larger the value, the greater the color enhancement intensity. Default value: 0.
p.skinToneProtectionLevel = 1;//Value range: [0,1], the larger the value, the greater the skin tone protection. Default value: 1.
p.lipColorProtectionLevel = 1;//Value range: [0,1], the larger the value, the greater the lip color protection. Default value: 0.
engine->enableColorEnhancement(true, p, ZEGO_PUBLISH_CHANNEL_MAIN);//Enable color enhancement
```
</Accordion>

### Start preview

Call the [startPreview](@startPreview) interface to enable preview. You can set different video enhancement features and experience the effects in real-time.

```cpp
ZegoCanvas previewCanvas(preview);
engine->startPreview(&previewCanvas);
```

### Start publishing stream

When the preview effect meets expectations, you can call the [startPublishingStream](@startPublishingStream) interface to start publishing stream. The publishing stream screen effect will be consistent with the preview effect.

```cpp
engine->startPublishingStream("STREAM_ID");
```

The above implements the video enhancement feature before publishing stream.
