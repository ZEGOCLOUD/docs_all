---
articleID: 16924
date: "2024-10-11"
---
# Using Token Authentication

---

## Feature Introduction

Authentication refers to verifying whether users have permission to access the system to avoid security risk issues caused by lack of permission control or improper operation. ZEGO authenticates users through Token (including basic authentication Token and privilege authentication Token).


|Authentication Method|Description|Application Scenario|
|-|-|-|
|[Basic Authentication Token](/real-time-video-cocos-creator/communication/using-token-authentication)|Developers must bring the Token parameter when logging into the room to verify the legitimacy of the user.|Basic authentication Token is the basic capability of Token, used for simple permission verification scenarios in business. In most cases, generating this Token is sufficient. |
|[Privilege Authentication Token](/real-time-video-cocos-creator/communication/using-token-authentication)|To further improve security, room ID and stream ID permission bits are opened, which can verify the login room ID and stream ID.|General usage scenarios for room ID and stream ID permission bits are as follows:<ul><li>Rooms have the distinction between ordinary rooms and member rooms, and it is necessary to control non-member users from logging into member rooms.</li><li>In voice chat rooms or show live streaming, it is necessary to control the consistency between streaming users and users on the mic to prevent the "ghost mic" phenomenon, that is, hearing the voice of users not on the mic in the room.</li><li>In speaking games such as Werewolf, it is necessary to prevent hackers from using other user IDs to log into the same room after cracking the application, obtaining information about the game progress to cheat, affecting the gaming experience of normal users.</li></ul>|


## Prerequisites

<Warning title="Note">
- Only ZEGO Express SDK version 2.17.0 and above supports using Token authentication as described in this document.
- If you have integrated ZEGO Express SDK version before 2.17.0 (using AppSign authentication) and now want to upgrade to version 2.17.0 and use Token authentication, you can learn more about AppSign authentication and Token authentication through the [How to upgrade from AppSign authentication to Token authentication](https://doc-zh.zego.im/faq/token_upgrade) document.
</Warning>


## Process Overview


When using Token authentication, developers need to generate Token first, and then log into the room with Token. The ZEGO server verifies users with Token.

Taking using Token to determine whether users can log into the room as an example to introduce the usage process, as shown in the following figure:


<Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/QuickStart/token_uml.png" /></Frame>

1. The developer client initiates a request to apply for Token.
2. Generate Token on the developer's server and return it to the developer client.
3. The developer client carries the applied Token and userID, roomID information to log into the corresponding room.
4. ZEGO SDK will automatically send Token to the ZEGO server for verification.
5. The ZEGO server will return the verification result to the ZEGO SDK.
6. The ZEGO SDK then directly returns the verification result to the developer client, and clients without permission will fail to log in.


## Generate Token and Use

This section will detail how developers generate Token through the server, how to use Token, and how to handle Token expiration.

### 1 Get AppID and ServerSecret

Generating Token requires the AppID, the unique identifier of the developer project, and the ServerSecret key. Please refer to "Project Information" in [Console - Project Management](/console/project-info) to obtain them.

After the developer obtains the AppID and ServerSecret information of the project, they can generate Token on their own server according to actual business needs. The developer client sends a request to apply for Token to the developer server, and the developer server generates Token and returns it to the corresponding client.


### 2 Generate Token on Server

import GenerateTemporaryToken from '/snippets/common/zh/token/generate-temporary-token.mdx'

<GenerateTemporaryToken />

ZEGO provides an open source zego_server_assistant plugin on GitHub/Gitee. Please use the "token04" version in the plugin to generate Token. The plugin supports Go, C++, Java, Objective-C, Python, PHP, .NET, Node.js languages:

<table>

<tbody><tr>
<th rowspan="2">Language</th>
<th rowspan="2">Supported Version</th>
<th rowspan="2">Key Function</th>
<th rowspan="2">Plugin Download Address</th>
<th colspan="2">Usage Example</th>
</tr>
<tr>
<th>Basic Authentication Token</th>
<th>Privilege Authentication Token</th>
</tr>
<tr>
<td>Go</td>
<td>Go 1.14.15 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/go/src/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/go/src/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-base.go">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-base.go">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-for-rtcroom.go">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/go/sample/token04/sample-for-rtcroom.go">Gitee</a></li></ul></td>
</tr>
<tr>
<td>C++</td>
<td>C++ 11 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/c++/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/c%2B%2B/token04/sample/demo/main.cc">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Java</td>
<td>Java 1.8 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/java/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/java/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleBase.java">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleBase.java">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleForRtcRoom.java">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/java/token04/src/im/zego/serverassistant/sample/Token04SampleForRtcRoom.java">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Python</td>
<td>Python 3.6.8 or above</td>
<td>generate_token04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/python/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/python/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/python/token04/test/base_sample.py">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/python/token04/test/base_sample.py">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/python/token04/test/rtcroom_sample.py">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/python/token04/test/rtcroom_sample.py">Gitee</a></li></ul></td>
</tr>
<tr>
<td>PHP</td>
<td>PHP 5.6 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/php/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/php/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant_php/blob/main/test/test.php">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/php/token04/test/test.php">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant_php/blob/main/test/testForRtcRoom.php">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/php/token04/test/testForRtcRoom.php">Gitee</a></li></ul></td>
</tr>
<tr>
<td>.NET</td>
<td>.NET Framework 3.5 or above</td>
<td>GenerateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/.net/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/.net/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/feature/token04/token/.net/token04/demo/WindowsFormsApp1/Form1.cs">Gitee</a></li></ul></td>
</tr>
<tr>
<td>Node.js</td>
<td>Node.js 8 or above</td>
<td>generateToken04</td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/nodejs/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/nodejs/token04">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-base.js">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-base.js">Gitee</a></li></ul></td>
<td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-rtc-room.js">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/blob/release/github/token/nodejs/token04/sample/sample-rtc-room.js">Gitee</a></li></ul></td>
</tr>
</tbody></table>

Taking Go language as an example, developers can refer to the following steps to use zego_server_assistant to generate Token:

1. Use the command `git clone https://github.com/zegoim/zego_server_assistant` to get the dependency package.
2. In your code, introduce the plugin through `import "github.com/zegoim/zego_server_assistant/token/go/src/token04"`.
3. Call the GenerateToken04 method provided by the plugin to generate Token.


<a id="tab_item1"></a>
<Tabs>
<Tab title="Generate Basic Authentication Token">
When generating a basic authentication Token, pass an empty string for the "payload" field. The specific example code is as follows:

```go
package main
import (
    "fmt"
    "github.com/zegoim/zego_server_assistant/token/go/src/token04"
)
/*
Basic authentication token generation example code
*/
func main() {
    var appId uint32 = 1    // Digital ID assigned by Zego, unique identifier for each developer
    userId := "demo"   // User ID
    serverSecret := "fa94dd0f974cf2e293728a526b028271"  // Key for AES encryption when getting token
    var effectiveTimeInSeconds int64 = 3600    // Effective duration of token, unit: seconds
    var payload string = ""   // Token business authentication extension, leave empty for basic authentication token
    //Generate token
    token, err := token04.GenerateToken04(appId, userId, serverSecret, effectiveTimeInSeconds, payload)
    if err != nil {
	fmt.Println(err)
	return
    }
    fmt.Println(token)
}
```
</Tab>
<Tab title="Generate Privilege Authentication Token">
To further improve security, privilege authentication Token opens up two permission bits for room ID and stream ID, which can verify the login room ID and stream ID. At this time, the "payload" field needs to be generated according to rules. The permission bit verification rules are as follows:

- Only verify login permission: Verify permission when logging in, do not verify permission when publishing.
- Only verify publish permission: Verify permission when publishing, do not verify permission when logging in.
- Verify both login and publish permissions: Verify permissions when both logging in and publishing.

<Warning title="Note">
When generating a privilege authentication Token, you must pass in "RoomId".
</Warning>

```go
package main
import (
    "encoding/json"
    "fmt"
    "github.com/zegoim/zego_server_assistant/token/go/src/token04"
)
/*
Privilege authentication token generation example code
*/
//Token business extension: Privilege authentication attributes
type RtcRoomPayLoad struct {
    RoomId       string      `json:"room_id"`        //Room id (required); used for strong verification of the room id of the interface
    Privilege    map[int]int `json:"privilege"`      //Permission bit switch list; used for strong verification of operation permissions of the interface
    StreamIdList []string    `json:"stream_id_list"` //Stream list; used for strong verification of the stream id of the interface; allowed to be empty, if empty, stream id verification is not performed
}
func main() {
    var appId uint32 = 1                               // Digital ID assigned by Zego, unique identifier for each developer
    roomId := "demo"                                   // Room ID
    userId := "demo"                                   // User ID
    serverSecret := "fa94dd0f974cf2e293728a526b028271" // Key for AES encryption when getting token
    var effectiveTimeInSeconds int64 = 3600            // Effective duration of token, unit: seconds

    //Please refer to github.com/zegoim/zego_server_assistant/token/go/src/token04/token04.go definition
    ////Permission bit definition
    //const (
    //	PrivilegeKeyLogin   = 1 // Login permission bit authentication
    //	PrivilegeKeyPublish = 2 // Publish permission bit authentication
    //)
    ////Permission switch definition
    //const (
    //	PrivilegeEnable     = 1 // Has permission
    //	PrivilegeDisable    = 0 // No permission
    //)
    //Business permission authentication configuration, can configure multiple permission bits
    privilege := make(map[int]int)
    privilege[token04.PrivilegeKeyLogin] = token04.PrivilegeEnable    // Has room login permission
    privilege[token04.PrivilegeKeyPublish] = token04.PrivilegeDisable // No publish permission
    //Token business extension configuration
    payloadData := &RtcRoomPayLoad{
	RoomId:       roomId,
	Privilege:    privilege,
	StreamIdList: nil,
    }
    payload, err := json.Marshal(payloadData)
    if err != nil {
	fmt.Println(err)
	return
}
    //Generate token
    token, err := token04.GenerateToken04(appId, userId, serverSecret, effectiveTimeInSeconds, string(payload))
    if err != nil {
	fmt.Println(err)
	return
}
    fmt.Println(token)
}
```
</Tab>
</Tabs>

<Warning title="Note">

When running the Java source code for generating Token, if the "java.security.InvalidKeyException:illegal Key Size" exception prompt appears, please refer to [Related FAQ Document](https://doc-zh.zego.im/faq/java_illegal_key_size_solution?product=ExpressVideo&platform=all) to solve it.
</Warning>


### 3 Use Token


Users carry the obtained Token and user, roomID information to log into the corresponding room.

<Warning title="Note">

The userID used when calling the [loginRoom](@loginRoom) interface to log into the room must be consistent with the userID used when "4.2 Generate Token on Server".
</Warning>

```ts
let roomConfig = new ZegoRoomConfig()
roomConfig.token = 'xxxxxxxx' // Request from developer server to obtain

// Login room
this.engine.loginRoom('your_room_id', new ZegoUser('user_id'), roomConfig)
```

If developers need to modify the user's publishing permission after the user logs into the room, they can also call the [renewToken](@renewToken) interface to update the permission. After updating, it will affect the next publishing permission. The previously successful publishing will not be affected.

```ts
let token = 'xxxxxxxx' // Re-request from developer server to obtain Token
this.engine.renewToken('your_room_id', token)
```

### 4 Handling Token Expiration

<Warning title="Note">

Token expiration may cause issues such as publishing and playing exceptions. Please strictly follow the instructions below to handle expired Tokens in a timely manner.
</Warning>


30 seconds before Token expires, the SDK will send a notification through the [onRoomTokenWillExpire](@onRoomTokenWillExpire) callback; after Token expires, when logging into the room again, you will receive the `1002078` (Token expired) error code through `onDebugError` or `onRoomStateChanged`.

After receiving the Token expiration callback or Token expiration error code, developers need to obtain a new valid Token from their own server and call the [renewToken](@renewToken) interface provided by the SDK to update the Token.

If you have integrated **ZEGO Express SDK version 2.17.0** or above, after Token expires, if you do not call the [renewToken](@renewToken) interface to update Token, when the permission expires:
  - Logged in users will not be kicked out of the room.
  - Currently successful publishing and playing will not be affected. However, after stopping publishing, you cannot publish again unless you update the Token.


<Note title="Note">
ZEGO also provides another Token expiration handling method. You can contact ZEGO Technical Support to configure:
  - Logged in users will be kicked out of the room, and can only log into the room again after updating Token.
  - Currently successful publishing will be stopped.
</Note>


```ts
onRoomTokenWillExpire(roomID: string, remainTimeInSecond: number): void {
  let token = 'xxxxxxxx' // Re-request from developer server to obtain Token
  this.engine.renewToken('your_room_id', token)
}
```

## Other

<Accordion title="Client-side Token Generation and Use (Not Recommended)" defaultOpen="false">
If you cannot distribute Token through the server during development, you can first use client-side code to generate Token, and then complete the integration after the server development is completed.

<Warning title="Note">

- When the App goes online, do not generate Token on the client side, otherwise your ServerSecret will be at risk of exposure.
- To ensure security, it is strongly recommended to use the server to generate Token, otherwise there is a risk of ServerSecret being stolen.
</Warning>


Reference information for each language of zego_server_assistant plugin used to generate Token on the client side:

<table>

  <tbody><tr>
    <th>Language</th>
    <th>Supported Version</th>
    <th>Key Function</th>
    <th>Specific Address</th>
  </tr>
  <tr>
    <td>C++</td>
    <td>C++ 11 or above</td>
    <td>GenerateToken04</td>
    <td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/blob/release/github/token/c%2B%2B/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/c++/token04">Gitee</a></li></ul></td>
  </tr>
  <tr>
    <td>Java</td>
    <td>Java 1.8 or above</td>
    <td>generateToken04</td>
    <td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/java/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/java/token04">Gitee</a></li></ul></td>
  </tr>
  <tr>
    <td>Objective-C</td>
    <td>-</td>
    <td>GenerateToken04</td>
    <td><ul><li><a target="_blank" href="https://github.com/zegoim/zego_server_assistant/tree/release/github/token/oc/token04">GitHub</a></li><li><a target="_blank" href="https://gitee.com/zegodev_admin/zego_server_assistant/tree/release/github/token/oc/token04">Gitee</a></li><ul></ul></ul></td>
  </tr>
</tbody></table>

To use client-side to generate Token, please refer to [Using Token](#3-use-token).

If Token expires, please refer to [Handling Token Expiration](#4-handling-token-expiration) for handling.
</Accordion>

## API Reference

| Method | Description |
|-------|--------|
| [loginRoom](@loginRoom) | Login room |
| [renewToken](@renewToken) | Renew Token |
| [onRoomTokenWillExpire](@onRoomTokenWillExpire) | Token expiration callback |

## Related Documentation

[How to prevent ghost mic or room bombing in audio/video interaction?](https://doc-zh.zego.im/faq/bombing)
