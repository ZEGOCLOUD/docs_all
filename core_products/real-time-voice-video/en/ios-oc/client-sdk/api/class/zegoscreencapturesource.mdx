---
docType: API
---

# ZegoScreenCaptureSource

## ZegoScreenCaptureSource

*Declared in `ZegoExpressDefines.h`*

### 方法
<ParamField
  name="setEventHandler:"
  prototype="- (void)setEventHandler:(nullable id<[ZegoScreenCaptureSourceEventHandler](../../api-reference/class#zegoscreencapturesourceeventhandler)>) handler;"
  desc="设置屏幕采集源回调"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| handler | nullable id\<[ZegoScreenCaptureSourceEventHandler](../../api-reference/class#zegoscreencapturesourceeventhandler)\> | 屏幕采集源回调。 |

**详情**

设置屏幕采集源回调，用于监听采集数据的回调。

<Note title="">
- **调用时机**：创建 [ZegoScreenCaptureSource] 实例后。
</Note>

<Warning title="">
- **支持版本**：3.1.0 及以上。
- **使用限制**：无。
- **注意事项**：调用此函数将覆盖上一次调用此函数设置的回调。
</Warning>
</ParamField>
<ParamField
  name="updateCaptureSource:sourceType:"
  prototype="- (void)updateCaptureSource:(unsigned int) sourceId sourceType:([ZegoScreenCaptureSourceType](../../api-reference/enum#zegoscreencapturesourcetype)) sourceType;"
  desc="更新屏幕采集源"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| sourceId | unsigned int | 指定的屏幕 ID 或窗口 ID。 |
| sourceType | [ZegoScreenCaptureSourceType](../../api-reference/enum#zegoscreencapturesourcetype) | 指定的屏幕源类型。 |

**详情**

根据提供的源的 ID 和源的类型更新屏幕采集源对象。

<Note title="">
- **业务场景**：需要对屏幕或窗口有录制和分享等业务时使用。
- **调用时机**：在创建屏幕采集实例 [createScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.1.0 及以上。
- **使用限制**：只适用于 Windows/macOS
</Warning>
</ParamField>
<ParamField
  name="startCapture"
  prototype="- (void)startCapture;"
  desc="开始屏幕采集。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
开始屏幕采集。

<Note title="">
- **调用时机**：在创建屏幕采集实例 [createScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.1.0 及以上。
</Warning>
</ParamField>
<ParamField
  name="stopCapture"
  prototype="- (void)stopCapture;"
  desc="停止屏幕采集。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
停止屏幕采集。

<Warning title="">
- **支持版本**：3.1.0 及以上。
</Warning>
</ParamField>
<ParamField
  name="getCaptureSourceRect"
  prototype="- (CGRect)getCaptureSourceRect;"
  desc="获取屏幕采集源的矩形。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
获取屏幕采集源的矩形。

<Warning title="">
- **支持版本**：3.6.0 及以上
- **使用限制**：开始采集 [startScreenCapture] 之后调用，只适用于 Windows/macOS 系统。
</Warning>

采集资源的矩形信息
</ParamField>
<ParamField
  name="updateCaptureRegion:"
  prototype="- (void)updateCaptureRegion:(CGRect) rect;"
  desc="更新屏幕采集的区域。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| rect | CGRect | 待采集区域相对于整个屏幕或窗口的位置。 |

**详情**

更新屏幕采集的区域。

<Note title="">
- **调用时机**：在创建屏幕采集实例 [createScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.1.0 及以上。
- **使用限制**：只适用于 Windows/macOS 系统
</Warning>
</ParamField>
<ParamField
  name="updatePublishRegion:"
  prototype="- (void)updatePublishRegion:(CGRect) rect;"
  desc="更新屏幕采集的推流区域。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| rect | CGRect | 待推流区域相对于采集画面左上角的位置，实际采集画面尺寸可以通过 [onAvailableFrame] 获取 |

**详情**

更新屏幕采集的推流区域。

<Note title="">
- **调用时机**：更新屏幕采集源 [updateScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.8.0 及以上。
- **使用限制**：每次更新屏幕采集源 [updateScreenCaptureSource] 时会清空区域，需要重新设置，只适用于 Windows/macOS 系统。
- **注意事项**：设置的区域不能超过 [onAvailableFrame] 返回的尺寸，否则会设置失败并推流原始画面。推流区域失效会通过 [onExceptionOccurred] 通知。
</Warning>
</ParamField>
<ParamField
  name="setExcludeWindowList:"
  prototype="- (void)setExcludeWindowList:(NSArray<NSNumber *> *) list;"
  desc="设置过滤的窗口列表。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| list | NSArray\<NSNumber *\> * | 过滤窗口的 ID 列表。 |

**详情**

指定窗口列表，在采集屏幕时将这些窗口过滤，不在画面中显示。

<Note title="">
- **调用时机**：在创建屏幕采集实例 [createScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.1.0 及以上。
- **使用限制**：只适用于 Windows/macOS
</Warning>
</ParamField>
<ParamField
  name="enableWindowActivate:"
  prototype="- (void)enableWindowActivate:(BOOL) active;"
  desc="是否激活窗口提升至前台显示。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| active | BOOL | 是否激活窗口。true 为激活窗口，false 不激活窗口，默认 true。 |

**详情**

在采集目标为窗口的情况下，初次采集时，设置是否激活窗口提升至前台显示。

<Note title="">
- **调用时机**：在创建屏幕采集实例 [createScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.1.0 及以上。
- **使用限制**：只适用于 Windows/macOS
</Warning>
</ParamField>
<ParamField
  name="enableCursorVisible:"
  prototype="- (void)enableCursorVisible:(BOOL) visible;"
  desc="设置是否显示光标"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| visible | BOOL | 是否显示光标。true 为显示光标，false 不显示光标，默认 true。 |

**详情**

设置是否显示光标。

<Note title="">
- **调用时机**：在创建屏幕采集实例 [createScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.1.0 及以上。
- **使用限制**：只适用于 Windows/macOS
</Warning>
</ParamField>
<ParamField
  name="enableHightLight:config:"
  prototype="- (void)enableHightLight:(BOOL) enable config:([ZegoLayerBorderConfig](../../api-reference/class#zegolayerborderconfig) *) config;"
  desc="设置是否高亮采集区域"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| enable | BOOL | 是否高亮采集区域。true 为高亮，false 不高亮，默认 false。 |
| config | [ZegoLayerBorderConfig](../../api-reference/class#zegolayerborderconfig) * | 高亮采集区域边框配置。 |

**详情**

设置是否高亮采集区域。

<Note title="">
- **调用时机**：在创建屏幕采集实例 [createScreenCaptureSource] 之后。
</Note>

<Warning title="">
- **支持版本**：3.21.0 及以上。
- **使用限制**：只适用于 Windows/macOS
</Warning>
</ParamField>
<ParamField
  name="enableAudioCapture:config:"
  prototype="- (void)enableAudioCapture:(BOOL) enable config:([ZegoScreenCaptureAudioConfig](../../api-reference/class#zegoscreencaptureaudioconfig) *) config;"
  desc="设置是否采集声音"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
**参数**

| 名称 | 类型 | 描述 |
| --- | --- | --- |
| enable | BOOL | 是否采集声音。true 为采集，false 不采集，默认 false。 |
| config | [ZegoScreenCaptureAudioConfig](../../api-reference/class#zegoscreencaptureaudioconfig) * | 音频采集参数。 |

**详情**

设置是否采集声音。

<Note title="">
- **调用时机**：任意时刻，开始屏幕采集后生效。[setAudioSource] 设置采集源为 ZegoAudioSourceTypeScreenCapture，并且屏幕采集推流通道相同。
</Note>

<Warning title="">
- **支持版本**：3.23.0 及以上。
- **使用限制**：只适用于 macOS 10.15 及以上版本和 Windows 8 及以上版本
</Warning>
</ParamField>
<ParamField
  name="getIndex"
  prototype="- (NSNumber *)getIndex;"
  desc="获取屏幕采集源索引。"
  parent_file="Declared in \`ZegoExpressDefines.h\`"
  parent_name="ZegoScreenCaptureSource"
  parent_type="class">
屏幕采集源索引。
</ParamField>
