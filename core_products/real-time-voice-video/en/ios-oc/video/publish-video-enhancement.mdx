---
articleID: 18875
date: "2025-01-20"
---
# Publishing Stream Video Enhancement

- - -

## Feature Introduction

ZEGO Express SDK provides various video pre-processing enhancement capabilities. Developers can adjust the picture effects at the publishing end according to business needs.

<table>

<tbody><tr>
<th>Feature</th>
<th>Feature Description</th>
<th>Feature Advantages</th>
<th colspan="2">Effect Display</th>
</tr>
<tr>
<td>Basic AI Effects</td>
<td>Adjust the levels of whitening, smoothing, sharpening, and rosyness according to user and business needs, easily implementing basic AI effects, presenting good skin condition to users and creating unique and natural AI effect results.</td>
<td>Covers high-frequency AI effect capabilities.</td>
<td colspan="2"><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/AI_Vision/AI_beauty.gif" /></Frame></td>
</tr>
<tr>
<td>Low Light Enhancement</td>
<td>When ambient light is dark and the brightness of the image captured by the camera does not meet the requirements for seeing faces clearly or cannot perform business needs such as face recognition, enhance the image brightness.</td>
<td><ul><li>Lightweight, covers all device models.</li><li>Supports auto mode, intelligently enables or disables the algorithm based on the lighting conditions of the image.</li><li>Supports traditional algorithms and AI-level algorithms, intelligently selects algorithm types based on device performance.</li></ul></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/lowlightenhancement/lowlightenhancement_before.jpg" /></Frame></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/lowlightenhancement/lowlightenhancement_after.jpg" /></Frame></td>
</tr>
<tr>
<td>Video Noise Reduction</td>
<td>Poor camera capture results, low ambient light brightness, and other situations may cause obvious noise in the image. The video noise reduction feature can reduce image noise.</td>
<td><ul><li>Determines whether to enable based on image noise conditions, avoiding unnecessary image damage.</li><li>Adjustable noise reduction intensity.</li></ul></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/lowlightenhancement/Video_noise_reduction.png" /></Frame></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/lowlightenhancement/Video_noise_reduction_1.png" /></Frame></td>
</tr>
<tr>
<td>Color Enhancement</td>
<td>Due to camera characteristics, the captured video may have insufficient saturation. Using the color enhancement feature, enhance undersaturated colors while protecting skin tones, making image colors more realistic and more in line with human visual perception.</td>
<td><ul><li>Protects skin tone, avoiding enhancement of human skin tone.</li><li>Protects lip color, making lip color more natural when using AI effects and wearing makeup.</li></ul></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/Express/color_enhanced_before.jpg" /></Frame></td>
<td><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/Express/color_enhanced_after.jpg" /></Frame></td>
</tr>
</tbody></table>







## Prerequisites

Before using the publishing stream video enhancement feature, please ensure:

- You have created a project in the [ZEGOCLOUD Console](https://console.zego.im) and applied for a valid AppID and AppSign. For details, please refer to [Console - Project Information](/console/project-info).
- You have integrated the ZEGO Express SDK in the project and implemented basic audio and video publishing and playing functions. For details, please refer to [Quick Start - Integration](/real-time-video-ios-oc/quick-start/integrating-sdk) and [Quick Start - Implementation Flow](/real-time-video-ios-oc/quick-start/implementing-video-call).


## Usage Steps

### 1 Initialize and login room

For the specific process of initializing and logging in to the room, please refer to "[Create Engine](/real-time-video-ios-oc/quick-start/implementing-video-call)" and "[Login Room](/real-time-video-ios-oc/quick-start/implementing-video-call)" in the implementation video call documentation.

### 2 Set publishing stream video enhancement effects

Please configure the corresponding features according to your needs.

<Accordion title="Basic AI Effects" defaultOpen="false">
<Note title="Note">

This feature is the basic AI effects feature of ZEGO Effects SDK built into the ZEGO Express SDK, which only includes four types of AI effects: whitening, rosyness, smoothing, and sharpening. If you need to use more advanced AI effects features, please refer to [Integration of Real-time Audio and Video with AI Effects](/real-time-video-ios-oc/best-practice/integration-with-zego-effects-sdk).
</Note>

#### Initialize basic AI effects environment

If you need to use the basic AI effects feature, you must call the [startEffectsEnv](@startEffectsEnv) interface before [startPreview](@startPreview) starts preview and [startPublishingStream](@startPublishingStream) starts publishing stream to initialize the AI effects environment.

```objc
// Create AI effects environment
[[ZegoExpressEngine sharedInstance] startEffectsEnv];
```

After initializing the AI effects environment, the SDK internally uses a fixed video frame data type for transmission. If you need to use custom video preprocessing while using the basic AI effects feature, you can only configure the corresponding video frame data type:

iOS and macOS platforms: Only support CVPixelBuffer type data, that is, the [bufferType](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~objectivec_ios~enum~ZegoVideoBufferType) of [ZegoCustomVideoCaptureConfig](https://doc-zh.zego.im/article/api?doc=Express_Video_SDK_API~objective-c_ios~class~ZegoCustomVideoCaptureConfig) takes the value "ZegoVideoBufferTypeCVPixelBuffer".

#### Enable basic AI effects

<Note title="Note">

There is no order requirement for calling the [enableEffectsBeauty](@enableEffectsBeauty) interface and the [setEffectsBeautyParam](@setEffectsBeautyParam) interface.
</Note>

After initializing the AI effects environment, you can call the [enableEffectsBeauty](@enableEffectsBeauty) interface before or after publishing stream to enable or disable AI effects in real time.

```objc
// Toggle AI effects
[[ZegoExpressEngine sharedInstance] enableEffectsBeauty:true];
```

#### Set basic AI effects parameters

After initializing the AI effects environment, you can call the [setEffectsBeautyParam](@setEffectsBeautyParam) interface before or after publishing stream to set AI effects parameters in real time.

- smoothIntensity: Smoothing, perform smoothing while retaining facial details, such as retaining moles on the face.
- whitenIntensity: Whitening, increase the overall brightness of the picture to whiten the face.
- rosyIntensity: Rosyness, perform warm color processing on the overall picture.
- sharpenIntensity: Sharpening, perform sharpening processing on the overall picture. When the picture is slightly blurry, you can slightly increase sharpening to make the outline clear.

The value range of the above four parameters is 0 to 100. The larger the value, the higher the degree of AI effects. The default value is 50.

```objc
// Create AI effects parameter object
ZegoEffectsBeautyParam *beautyParam = [[ZegoEffectsBeautyParam alloc] init];

// Whitening, rosyness, smoothing, sharpening
beautyParam.whitenIntensity = 50;
beautyParam.rosyIntensity = 50;
beautyParam.smoothIntensity = 50;
beautyParam.sharpenIntensity = 50;

// Set AI effects parameters
[[ZegoExpressEngine sharedInstance] setEffectsBeautyParam:beautyParam];
```

#### (Optional) Destroy basic AI effects environment

When calling the [enableEffectsBeauty](@enableEffectsBeauty) interface and setting it to "false", the AI effects will be turned off, but the AI effects module will still occupy resources and consume performance. If you want to completely release resources and save performance consumption, you need to call the [stopEffectsEnv](@stopEffectsEnv) interface before preview and publishing stream to destroy the AI effects environment.

<Note title="Note">

When calling [destroyEngine](@destroyEngine) to destroy the engine, the SDK will automatically destroy the AI effects environment.
</Note>

```objc
// Destroy AI effects environment
[[ZegoExpressEngine sharedInstance] stopEffectsEnv];
```
</Accordion>


<Accordion title="Low Light Enhancement" defaultOpen="false">
ZEGO provides two ways of low light enhancement:

| Method | Description |
|---|---|
| Enable adaptive frame rate for enhancement | Dynamically reduce the capture frame rate within the set frame rate range to extend the exposure time of each frame, achieving the effect of enhancing the brightness of the captured picture.<br />For example: The developer enables and sets the adaptive frame rate range to [10, 25]. When the ambient light is sufficient, the capture frame rate is still 25 frames. When the ambient light brightness is low, the capture frame rate will be dynamically adjusted between [10, 25] to extend the exposure time of each frame to enhance the brightness of the captured picture. |
| Algorithm enhances the brightness of the captured picture | <ul><li>Manual control: The developer controls the algorithm switch independently.</li><li>Smart control: Intelligently enable or disable the algorithm based on the lighting conditions of the picture.</li></ul> |

The two processing methods can be used independently or simultaneously, and both are compatible with AI effects features.

#### Set low light enhancement switch

RTC SDK supports different algorithm low light enhancement modes. Call the [setLowlightEnhancement](@setLowlightEnhancement) interface to set the low light enhancement mode [ZegoLowlightEnhancementMode](@-ZegoLowlightEnhancementMode):

<Note title="Note">
- Before using the [setLowlightEnhancement](@setLowlightEnhancement) interface, ensure that the SDK includes the **video internal capture** and **video internal filter** modules.
- If the business uses external capture video streams, only specific data types `CVPixelBuffer` and `PIXEL_BUFFER_TYPE_MEM` are supported.
</Note>

|Enumeration|Description|
|-|-|
|ZegoLowlightEnhancementModeOff| Turn off low light enhancement feature.|
|ZegoLowlightEnhancementModeOn|Turn on low light enhancement feature, controlled by the developer.|
|ZegoLowlightEnhancementModeAuto|Smart control of low light enhancement feature, intelligently enable or disable the feature based on picture lighting conditions.|

The low light enhancement type [ZegoExpLowlightEnhancementType](@-ZegoExpLowlightEnhancementType) includes the following types:

|Enumeration|Description|
|-|-|
| ZegoExpLowlightEnhancementTypeNormal | Conventional low light enhancement.|
| ZegoExpLowlightEnhancementTypeAI | AI low light enhancement. If you need to use this feature, please contact ZEGO technical support.|

Taking enabling automatic low light enhancement feature as an example:

```objc
ZegoExpLowlightEnhancementParams *params = [[ZegoExpLowlightEnhancementParams alloc] init];
params.mode = ZegoLowlightEnhancementModeAuto;
params.type = ZegoExpLowlightEnhancementTypeAI;
[[ZegoExpressEngine sharedEngine] setLowlightEnhancementParams:params channel:ZegoPublishChannelMain];
```


#### (Optional) Enable camera adaptive frame rate

When the ambient light brightness is low and the camera capture frame rate is too high, the exposure time of each frame is insufficient, which may cause the captured video picture to be dark. At this time, you can enable camera adaptive frame rate through [enableCameraAdaptiveFPS](@enableCameraAdaptiveFPS). The SDK will match the capture frame rate range supported by the camera according to the set frame rate range. Within this range, dynamically adjust the camera capture frame rate according to the ambient brightness to improve the picture brightness when the set frame rate is too high.

```objc
//Set minimum frame rate
int minCamFPS = 15;
//Set maximum frame rate
int maxCamFPS = 35;
[[ZegoExpressEngine sharedEngine] enableCameraAdaptiveFPS:YES minFPS:minCamFPS maxFPS:maxCamFPS channel:ZegoPublishChannelMain];
```
</Accordion>

<Accordion title="Video Noise Reduction" defaultOpen="false">
Call the [setVideoDenoiseParams](@setVideoDenoiseParams) interface to set video noise reduction parameters [ZegoVideoDenoiseParams](@-ZegoVideoDenoiseParams), including: video noise reduction mode [ZegoVideoDenoiseMode](@-ZegoVideoDenoiseMode) and video noise reduction strength [ZegoVideoDenoiseStrength](@-ZegoVideoDenoiseStrength).

<Warning title="Warning">
- Before using the [setVideoDenoiseParams](@setVideoDenoiseParams) interface, ensure that the SDK includes the **video internal capture** and **video internal filter** modules.
- If the business uses external capture video streams, only specific data types `CVPixelBuffer` and `PIXEL_BUFFER_TYPE_MEM` are supported.
- Video noise reduction feature is not enabled by default, that is, the default value of [ZegoVideoDenoiseMode](@-ZegoVideoDenoiseMode) is `ZegoVideoDenoiseMode.off`.
</Warning>

Taking automatic noise reduction as an example:

```objc
ZegoVideoDenoiseParams *p = [[ZegoVideoDenoiseParams alloc] init];
p.mode = ZegoVideoDenoiseModeAuto;
p.strength = ZegoVideoDenoiseStrengthLight;
[[ZegoExpressEngine sharedEngine] setVideoDenoiseParams:p channel:ZegoPublishChannelMain];
```
</Accordion>

<Accordion title="Color Enhancement" defaultOpen="false">
Call the [enableColorEnhancement](@enableColorEnhancement) interface, set color enhancement parameters [ZegoColorEnhancementParams](@-ZegoColorEnhancementParams) (parameter properties are as shown in the table below), and other parameters to enable the color enhancement feature. **Color enhancement feature is not enabled by default.**

|Color Enhancement Parameter|Description|
|-|-|
| intensity|<p>The intensity of color enhancement, value range [0.0, 1.0], default is 0.0.</p><p>The larger the value, the greater the color enhancement effect.</p>|
| skinToneProtectionLevel |<p>The intensity of skin tone protection, value range [0.0, 1.0], default is 1.0.</p><p>The larger the value, the better the protection effect.</p>|
| lipColorProtectionLevel |<p>The intensity of lip color protection, value range [0.0, 1.0], default is 0.0.</p><p>The larger the value, the better the protection effect.</p>|

```objc
ZegoColorEnhancementParams *p = [[ZegoColorEnhancementParams alloc]init];
p.intensity = 1f;//Value range: [0,1], the larger the value, the greater the color enhancement intensity. Default value: 0.
p.skinToneProtectionLevel = 1f;//Value range: [0,1], the larger the value, the greater the skin tone protection degree. Default value: 1.
p.lipColorProtectionLevel = 1f;//Value range: [0,1], the larger the value, the greater the lip color protection degree. Default value: 0.
[[ZegoExpressEngine sharedEngine]enableColorEnhancement:YES params:p channel:ZegoPublishChannelMain];//Enable color enhancement
```
</Accordion>

### 3 Start preview

After calling the [startPreview](@startPreview) interface to start preview, you can set different video enhancement features and experience the effects in real time.

```objc
ZegoCanvas *previewCanvas = [ZegoCanvas canvasWithView:preview];
[[ZegoExpressEngine sharedEngine] startPreview:previewCanvas];
```

### 4 Start publishing stream

When the preview effect meets expectations, you can call the [startPublishingStream](@startPublishingStream) interface to start publishing stream. The published stream picture effect will be consistent with the preview effect.

```objc
[[ZegoExpressEngine sharedEngine] startPublishingStream:@"STREAM_ID"];
```

The above completes the video enhancement feature before publishing stream.
