---

date: "2022-11-16"
ce-comparison:
  - "如何:how"
  - "解决:resolve"
  - "macOS:macOS"
  - "权限:permission"
  - "问题:problem"
---
import { Title } from './title';
import ArticleMetadata from '../../zh/faq/ArticleMetadata';

<Title>How to resolve macOS permission issues?</Title>

<ArticleMetadata language="en" product="Screen sharing" platform="macOS" />


---

### How to check if the computer has enabled screen capture permission and accessibility for the application?

Please open the "System Preferences" on your macOS computer, find the "Security & Privacy" option, switch to the "Privacy" tab, and confirm whether the following permissions are enabled:
{/* TODO translate
<Frame width="512" height="auto" caption=""><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/macOS/ScreenSharing/CommonProblems/screenSharing_Problems_macOS_2.png" /></Frame></Frame>
<Frame width="512" height="auto" caption=""><Frame width="512" height="auto" caption=""><img src="https://doc-media.zego.im/sdk-doc/Pics/macOS/ScreenSharing/CommonProblems/screenSharing_Problems_macOS_1.png" /></Frame></Frame>
*/}

### Why is it still unable to capture images or report errors after enabling permissions?

The status seen in the "Settings" on the macOS computer is not the real status of the application. It is recommended to **use code to determine whether permissions are enabled** (please refer to "How to determine system permissions?" below).

If permissions have been enabled, please close them first and then open them again to retry.



### How to jump to the system settings permission dialog?

Please refer to this URL to set "System Related URLs": [MacOS System Preference Links](https://www.mbsplugins.net/archive/2020-04-05/MacOS_System_Preference_Links/monkeybreadsoftware_blog_archive).

### How to determine system permissions?

- Accessibility permission

    You can confirm the permission by calling the following SDK internal interface.

    ```objc
    SCREENCAPTURE_API bool zego_windowthumbnail_window_checkStatus(ZegoWindowHandle handle);
    ```
- Screen recording permission

    After macOS 10.15 version, this permission needs to be enabled. The SDK does not have a wrapper for this permission function, and users need to implement it themselves. Please refer to the following code:

    ```objc
    bool ZegoSDKEngineMacUtils::checkScreenCapturePermission()
    {
        if (QSysInfo::macVersion() < 14)
        {
            return true;
        }
        if (@available(macOS 10.15, *))
        {
            CFArrayRef windowList = CGWindowListCopyWindowInfo(kCGWindowListOptionOnScreenOnly, kCGNullWindowID);
            NSUInteger numberOfWindows = CFArrayGetCount(windowList);
            NSUInteger numberOfWindowsWithInfoGet = 0;
            for (int idx = 0; idx < numberOfWindows; idx++)
            {
                NSDictionary *windowInfo = (NSDictionary *)CFArrayGetValueAtIndex(windowList, idx);
                NSString *windowName = windowInfo[(id)kCGWindowName];
                NSNumber* sharingType = windowInfo[(id)kCGWindowSharingState];
                if (windowName || kCGWindowSharingNone != sharingType.intValue)
                {
                    numberOfWindowsWithInfoGet++;
                } else {
                    NSNumber* pid = windowInfo[(id)kCGWindowOwnerPID];
                    NSString* appName = windowInfo[(id)kCGWindowOwnerName];
                    // NSLog(@"windowInfo get Fail pid:%lu appName:%@", pid.integerValue, appName);
                }
            }
            CFRelease(windowList);
            if (numberOfWindows == numberOfWindowsWithInfoGet) {
                return true;
            } else {
                return false;
            }
        }
        return true;
    }
    ```


