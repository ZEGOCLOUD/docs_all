<Warning title="警告">服务端 API 版块于4月16日至5月15日升级维护，期间暂停信息更新，如有任何疑问，请联系 ZEGO 技术支持。</Warning>

# 查询录制任务列表

- - -

## 1 描述

开始录制后，开发者可以通过调用本接口，查询正在录制或已结束录制的任务列表。

## 2 接口原型

- 请求方法：POST
- 请求地址：`https://cloudrecord-api.zego.im/?Action=DescribeTasks`
- 传输协议：HTTPS
- 调用频率限制：10 次/秒

## 3 请求参数

以下请求参数列表仅列出了接口请求参数和部分公共参数，完整公共参数列表请参考 [调用方式](./Making%20API%20Requests.mdx#21-公共请求参数) 中的 “2.1 公共请求参数”。

<table>
  
  <tbody>
  <tr>
    <th>参数</th>
    <th>类型</th>
    <th>是否必选</th>
    <th>描述</th>
  </tr>
  <tr>
    <td>Status</td>
    <td>Int</td>
    <td>是</td>
    <td><ul><li>2：表示正在录制的任务。</li><li>3：表示已结束录制的任务。</li></ul></td>
  </tr>
  <tr>
    <td>RoomId</td>
    <td>String</td>
    <td>否</td>
    <td>用于指定要查询录制任务的房间号。不填写时查询 AppId 下所有房间的录制任务。</td>
  </tr>
  <tr>
    <td>PageOffset</td>
    <td>Int</td>
    <td>否</td>
    <td>分页查询时的页码 ，从 1 开始。不填写或者填写为 0 时，默认为 1。</td>
  </tr>
  <tr>
    <td>PageSize</td>
    <td>Int</td>
    <td>否</td>
    <td>分页查询时每页的记录条数，该值需小于等于 50，并且大于 0。不填写时默认为 50。</td>
  </tr>
  <tr>
    <td>StartTime</td>
    <td>Int64</td>
    <td>是</td>
    <td>查询的开始时间，为Unix 时间戳，单位：ms。开始时间不能早于当前时间的 3 天之前。</td>
  </tr>
  <tr>
    <td>EndTime</td>
    <td>Int64</td>
    <td>是</td>
    <td>查询的结束时间，为Unix 时间戳，单位：ms。EndTime 必须大于 StartTime，且查询时间跨度不超过 3 天。接口仅返回录制开始时间在查询时间范围内的记录。</td>
  </tr>
</tbody></table>


## 4 请求示例
以下是 DescribeTasks 接口的请求示例。
- 请求 URL  
```
https://cloudrecord-api.zego.im/?Action=DescribeTasks
&AppId=1234567890
&SignatureNonce=15215528852396
&Timestamp=1234567890
&Signature=7a2c0f11145fb760d607a07b54825013
&SignatureVersion=2.0
```
- 请求消息体  
```json
{
    "Status":2,
    "RoomId":"1230",
    "StartTime": 1628474401000,
    "EndTime": 1628475402000,
    "PageOffset": 1,
    "PageSize": 50
}
```

## 5 响应参数

<table>
  
  <tbody><tr>
    <th>参数</th>
    <th>类型</th>
    <th>描述</th>
  </tr>
  <tr>
    <td>Code</td>
    <td>Int64</td>
    <td>错误码。</td>
  </tr>
  <tr>
    <td>Message</td>
    <td>String</td>
    <td>错误描述。</td>
  </tr>
    <tr>
    <td>RequestId</td>
    <td>String</td>
    <td>请求 ID。</td>
  </tr>
  <tr>
    <td>Data</td>
    <td>Object</td>
    <td>响应对象。<br />详见 <a href="#Data">Data 属性列表</a>。</td>
  </tr>
</tbody></table>

<p id="Data">Data 属性如下：</p>

<table>
  
  <tbody><tr>
    <th>参数</th>
    <th>类型</th>
    <th>描述</th>
  </tr>
  <tr>
    <td>PageOffset</td>
    <td>Int</td>
    <td>分页查询时的页码。</td>
  </tr>
  <tr>
    <td>PageSize</td>
    <td>Int</td>
    <td>分页查询时每页的记录条数。</td>
  </tr>
  <tr>
    <td>TotalCount</td>
    <td>Int</td>
    <td>查询结果总数。</td>
  </tr>
  <tr>
    <td>TaskList</td>
    <td>JSON Array</td>
    <td>详见 <a href="#TaskList">TaskList 属性列表</a>。</td>
  </tr>
</tbody></table>

<p id="TaskList">TaskList 属性如下：</p>

<table>
  
  <tbody><tr>
    <th>参数名</th>
    <th>类型</th>
    <th>说明</th>
  </tr>
  <tr>
    <td>RecordBeginTimestamp</td>
    <td>Int64</td>
    <td>开始录制的时间戳。</td>
  </tr>
  <tr>
    <td>TaskId</td>
    <td>String</td>
    <td>录制任务 ID。</td>
  </tr>
  <tr>
    <td>RoomId</td>
    <td>String</td>
    <td>录制的目标房间 ID。</td>
  </tr>
  <tr>
    <td>Status</td>
    <td>Int</td>
    <td>录制状态。<ul><li>1：录制任务初始化</li><li>2：录制任务进行中</li><li>3：录制任务已结束</li><li>4：录制任务异常结束</li><li>5：录制任务暂停中</li></ul></td>
  </tr>
</tbody></table>

## 6 响应示例

以下是 DescribeTasks 接口的响应示例。

```json
{
    "Code": 0,
    "Message": "succeed",
    "RequestId": "abcd123",
    "Data": {
        "PageOffset": 1,
        "PageSize": 50,
        "TotalCount": 3,
        "TaskidList": [
            {
                "RecordBeginTimestamp": 1628565227899,
                "TaskId": "YRHu6-E4IyvEAAAD",
                "RoomId": "1000",
                "Status": 2
            },
            {
                "RecordBeginTimestamp": 1628565226303,
                "TaskId": "YRHu6uE4IyvEAAAC",
                "RoomId": "1000",
                "Status": 2
            },
            {
                "RecordBeginTimestamp": 1628565222498,
                "TaskId": "YRHu5uE4IyvEAAAB",
                "RoomId": "1000",
                "Status": 2
            }
        ]
    }
}
```
