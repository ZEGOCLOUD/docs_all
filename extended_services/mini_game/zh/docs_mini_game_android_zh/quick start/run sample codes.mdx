# 跑通示例源码

---

ZEGO 提供了服务端示例源码（Node.js）和客户端示例源码（Android），通过同时运行这两份示例源码，您可以快速构建应用，完整地体验已开通权限的小游戏效果；您也可以通过阅读示例源码，了解实现小游戏的基础实践。

本文分为两部分：

1. [跑通服务端示例源码（Node.js）](#跑通服务端示例源码nodejs)
2. [跑通客户端示例源码（Android）](#跑通客户端示例源码android)

<Warning title="注意">

- 以上源码用于演示产品功能，仅供开发者接入时参考，ZEGO 不负责源码的后续维护。
- 以上示例源码未经严格测试，若开发者计划将源码用于生产环境，请确保发布前进行充分测试，避免发生潜在问题造成损失。
</Warning>

## 跑通服务端示例源码（Node.js）

<Warning title="注意">

为保障数据安全，本服务端示例源码不得用于上线。对于擅自将本服务端源码用于生产环境而造成的一切风险和损失，ZEGO 不负任何责任。
</Warning>

### 准备环境

在运行客户端示例源码（Node.js）前，请确保开发环境满足以下要求：

- 已安装 Node.js。
- Windows 或 macOS 计算机已连接到 Internet。

### 前提条件

- 已在 [ZEGO 控制台](https://console.zego.im) 创建项目，并获取该项目的 AppID 和 ServerSecret，详情请参考 [控制台 - 项目信息](https://doc-zh.zego.im/article/12107)。
- 已联系 ZEGO 商务人员开通小游戏服务。
- 已获取服务端示例源码，详情请参考 [SDK 下载](../download.mdx)。

### 示例源码目录结构

下面目录结构为服务端示例源码的文件结构，本节所涉及的文件路径均为相对于此目录的路径。

```
ZegoMiniGameServerDemo
├── index.js        # 主文件
├── package.json    # 配置文件
└── utils
  ├── config.js    # 填写在 ZEGO 控制台创建的项目的 AppID 和 ServerSecret
  ├── gameToken.js # 服务端生成 Token 
  └── getToken04.js 
```

### 运行示例源码

<Steps>
<Step title="解压服务端源码压缩包 “ZegoMiniGameServerDemo.zip”，获取 “ZegoMiniGameServerDemo”文件夹。">
{}
</Step>
<Step title="修改 “ZegoMiniGameServerDemo/utils/config.js” 文件，在下图红框标识区域填写 “AppID”。">
<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/MiniGames/server_demo_appid.jpeg" /></Frame>
</Step>
<Step title="在同文件中，填写 “ServerSecret“。">
<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/MiniGames/ServerSecret.jpeg" /></Frame>
</Step>
<Step title="进入 “ZegoMiniGameServerDemo”文件夹，在终端执行以下代码，以启动小游戏服务端。">
```bash
# 安装依赖
npm i 
node index.js
```
</Step>
<Step title="执行代码后，即可获得服务端地址，可用作客户端示例源码的后台服务地址。">
服务端示例源码运行后结果如图所示：
<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/MiniGames/server_sourcecodes_address.jpeg" /></Frame>
</Step>
</Steps>


## 跑通客户端示例源码（Android）

### 准备环境

在运行示例源码前，请确保开发环境满足以下要求：

- Android Studio  2021.2.1 或以上版本 (下面简称 AS)。
- Android SDK 29、Android SDK Build-Tools 29.0.0、Android SDK Platform-Tools 29.x.x 或以上版本。
- Android 5.0 或以上版本，且支持音视频的 Android 设备或模拟器（推荐使用真机）。
- Android 设备已经连接到 Internet。

### 前提条件


- 已在 [ZEGO 控制台](https://console.zego.im) 创建项目，获取项目的 AppID，详情请参考 [控制台 - 项目信息](https://doc-zh.zego.im/article/12107)。
- 已联系 ZEGO 商务人员开通小游戏服务并指定希望体验的小游戏。
- 已跑通服务端示例源码，详情请参考上文 [跑通服务端示例源码（Node.js）](#跑通服务端示例源码nodejs)。
- 已获取客户端示例源码，详情请参考 [SDK 下载](../download.mdx)。


### 示例源码目录结构

下面目录结构为 Android 端示例源码的文件结构，下文所涉及的文件路径均为相对于此目录的路径。

```tree
.
├── app
│  ├── build.gradle
│  ├── proguard-rules.pro
│  └── src
│      └── main
│          ├── AndroidManifest.xml
│          ├── java
│          │  └── im
│          │      └── zego
│          │          └── minigameenginedemo
│          │              ├── ...
│          │              ├── KeyCenter.java // 填写 AppID 和后台地址
│          │              └── ...
│          │              └── ...
│          └── ...
├── build.gradle
├── gradle
├── gradle.properties
├── gradlew
├── gradlew.bat
└── settings.gradle
```

### 运行示例源码

<Steps>
<Step title="解压 Android 客户端示例源码压缩包，获取 “ZegoMiniGameEngineDemoSrc-Android” 文件夹。">
{}
</Step>
<Step title="在开发电脑中找到 Android Studio 软件图标。">
<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoEnjoy/online_KTV/SampleCodes/AS_icon.png" /></Frame>
</Step>
<Step title="打开 “Android Studio”，单击 “Open”。">
<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoEnjoy/online_KTV/SampleCodes/AS_Welcome_Interface.png" /></Frame>
</Step>
<Step title="选择已解压的源码文件夹。">
<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/MiniGames/open.jpeg" /></Frame>
<a name="host_ip"></a>
</Step>
<Step title="修改 “app/src/main/java/im/zego/minigameenginedemo/KeyCenter.java” 文件，填写 SDK 初始化所需的 “AppID”，以及服务端地址。">

    <Warning title="注意">
      **服务端地址**请使用本文 [前提条件](#前提条件) 已获取的 AppID 正确填写，格式为 AppID + L，如：1234567890L，否则示例源码无法正常运行。 
    </Warning>    

    <Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/MiniGames/Demo_info_reqiured_android.jpeg" /></Frame>

</Step>
<Step title="选择一台 Android 真机设备链接到开发电脑，当该设备成功开启“开发者模式”和“USB 调试功能”后，可以看到 Android Studio 界面已检测到该设备，如下图所示：">
  <Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoEnjoy/LiveShow/android_device_detected.png" /></Frame>   

  此时说明 Android Studio 软件已成功连接到 Android 设备，可以将源码运行到该设备上了。
</Step>
<Step title="单击 Android Studio 软件上的 “build and run” 按钮，编译并运行源码，即可体验小游戏。">
<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoEnjoy/LiveShow/android_build_and_run.png" /></Frame>
</Step>
</Steps>